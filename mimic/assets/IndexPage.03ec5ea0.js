import{u as Tu,r as ee,O as qg,w as kl,o as Cu,k as Gg,h as Ol,c as Eo,P as Pl,_ as Yg,v as Hr,Q as Rl,x as Xg,R as Qg,S as Jg,z as Zg,C as tp}from"./index.d327350d.js";/*!
 * Chart.js v3.9.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */function Jt(){}const ep=function(){let e=0;return function(){return e++}}();function H(e){return e===null||typeof e=="undefined"}function J(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function V(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}const rt=e=>(typeof e=="number"||e instanceof Number)&&isFinite(+e);function $t(e,t){return rt(e)?e:t}function L(e,t){return typeof e=="undefined"?t:e}const np=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:e/t,Au=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Q(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function q(e,t,n,i){let s,r,o;if(J(e))if(r=e.length,i)for(s=r-1;s>=0;s--)t.call(n,e[s],s);else for(s=0;s<r;s++)t.call(n,e[s],s);else if(V(e))for(o=Object.keys(e),r=o.length,s=0;s<r;s++)t.call(n,e[o[s]],o[s])}function Ts(e,t){let n,i,s,r;if(!e||!t||e.length!==t.length)return!1;for(n=0,i=e.length;n<i;++n)if(s=e[n],r=t[n],s.datasetIndex!==r.datasetIndex||s.index!==r.index)return!1;return!0}function Cs(e){if(J(e))return e.map(Cs);if(V(e)){const t=Object.create(null),n=Object.keys(e),i=n.length;let s=0;for(;s<i;++s)t[n[s]]=Cs(e[n[s]]);return t}return e}function Du(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function ip(e,t,n,i){if(!Du(e))return;const s=t[e],r=n[e];V(s)&&V(r)?di(s,r,i):t[e]=Cs(r)}function di(e,t,n){const i=J(t)?t:[t],s=i.length;if(!V(e))return e;n=n||{};const r=n.merger||ip;for(let o=0;o<s;++o){if(t=i[o],!V(t))continue;const a=Object.keys(t);for(let l=0,c=a.length;l<c;++l)r(a[l],e,t,n)}return e}function ti(e,t){return di(e,t,{merger:sp})}function sp(e,t,n){if(!Du(e))return;const i=t[e],s=n[e];V(i)&&V(s)?ti(i,s):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=Cs(s))}const Ll={"":e=>e,x:e=>e.x,y:e=>e.y};function me(e,t){return(Ll[t]||(Ll[t]=rp(t)))(e)}function rp(e){const t=op(e);return n=>{for(const i of t){if(i==="")break;n=n&&n[i]}return n}}function op(e){const t=e.split("."),n=[];let i="";for(const s of t)i+=s,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}function ma(e){return e.charAt(0).toUpperCase()+e.slice(1)}const zt=e=>typeof e!="undefined",ye=e=>typeof e=="function",Nl=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function ap(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const et=Math.PI,Y=2*et,lp=Y+et,As=Number.POSITIVE_INFINITY,cp=et/180,it=et/2,$n=et/4,Fl=et*2/3,jt=Math.log10,Yt=Math.sign;function Bl(e){const t=Math.round(e);e=ei(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(jt(e))),i=e/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function hp(e){const t=[],n=Math.sqrt(e);let i;for(i=1;i<n;i++)e%i===0&&(t.push(i),t.push(e/i));return n===(n|0)&&t.push(n),t.sort((s,r)=>s-r).pop(),t}function yn(e){return!isNaN(parseFloat(e))&&isFinite(e)}function ei(e,t,n){return Math.abs(e-t)<n}function up(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function Mu(e,t,n){let i,s,r;for(i=0,s=e.length;i<s;i++)r=e[i][n],isNaN(r)||(t.min=Math.min(t.min,r),t.max=Math.max(t.max,r))}function Ut(e){return e*(et/180)}function ya(e){return e*(180/et)}function Vl(e){if(!rt(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function Iu(e,t){const n=t.x-e.x,i=t.y-e.y,s=Math.sqrt(n*n+i*i);let r=Math.atan2(i,n);return r<-.5*et&&(r+=Y),{angle:r,distance:s}}function To(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function dp(e,t){return(e-t+lp)%Y-et}function Ft(e){return(e%Y+Y)%Y}function fi(e,t,n,i){const s=Ft(e),r=Ft(t),o=Ft(n),a=Ft(r-s),l=Ft(o-s),c=Ft(s-r),h=Ft(s-o);return s===r||s===o||i&&r===o||a>l&&c<h}function pt(e,t,n){return Math.max(t,Math.min(n,e))}function fp(e){return pt(e,-32768,32767)}function ie(e,t,n,i=1e-6){return e>=Math.min(t,n)-i&&e<=Math.max(t,n)+i}function ba(e,t,n){n=n||(o=>e[o]<t);let i=e.length-1,s=0,r;for(;i-s>1;)r=s+i>>1,n(r)?s=r:i=r;return{lo:s,hi:i}}const se=(e,t,n,i)=>ba(e,n,i?s=>e[s][t]<=n:s=>e[s][t]<n),gp=(e,t,n)=>ba(e,n,i=>e[i][t]>=n);function pp(e,t,n){let i=0,s=e.length;for(;i<s&&e[i]<t;)i++;for(;s>i&&e[s-1]>n;)s--;return i>0||s<e.length?e.slice(i,s):e}const ku=["push","pop","shift","splice","unshift"];function mp(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),ku.forEach(n=>{const i="_onData"+ma(n),s=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...r){const o=s.apply(this,r);return e._chartjs.listeners.forEach(a=>{typeof a[i]=="function"&&a[i](...r)}),o}})})}function $l(e,t){const n=e._chartjs;if(!n)return;const i=n.listeners,s=i.indexOf(t);s!==-1&&i.splice(s,1),!(i.length>0)&&(ku.forEach(r=>{delete e[r]}),delete e._chartjs)}function Ou(e){const t=new Set;let n,i;for(n=0,i=e.length;n<i;++n)t.add(e[n]);return t.size===i?e:Array.from(t)}const Pu=function(){return typeof window=="undefined"?function(e){return e()}:window.requestAnimationFrame}();function Ru(e,t,n){const i=n||(o=>Array.prototype.slice.call(o));let s=!1,r=[];return function(...o){r=i(o),s||(s=!0,Pu.call(window,()=>{s=!1,e.apply(t,r)}))}}function yp(e,t){let n;return function(...i){return t?(clearTimeout(n),n=setTimeout(e,t,i)):e.apply(this,i),t}}const va=e=>e==="start"?"left":e==="end"?"right":"center",Et=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,bp=(e,t,n,i)=>e===(i?"left":"right")?n:e==="center"?(t+n)/2:t;function Lu(e,t,n){const i=t.length;let s=0,r=i;if(e._sorted){const{iScale:o,_parsed:a}=e,l=o.axis,{min:c,max:h,minDefined:u,maxDefined:d}=o.getUserBounds();u&&(s=pt(Math.min(se(a,o.axis,c).lo,n?i:se(t,l,o.getPixelForValue(c)).lo),0,i-1)),d?r=pt(Math.max(se(a,o.axis,h,!0).hi+1,n?0:se(t,l,o.getPixelForValue(h),!0).hi+1),s,i)-s:r=i-s}return{start:s,count:r}}function Nu(e){const{xScale:t,yScale:n,_scaleRanges:i}=e,s={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!i)return e._scaleRanges=s,!0;const r=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,s),r}const Zi=e=>e===0||e===1,jl=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*Y/n)),zl=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*Y/n)+1,ni={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*it)+1,easeOutSine:e=>Math.sin(e*it),easeInOutSine:e=>-.5*(Math.cos(et*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>Zi(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Zi(e)?e:jl(e,.075,.3),easeOutElastic:e=>Zi(e)?e:zl(e,.075,.3),easeInOutElastic(e){return Zi(e)?e:e<.5?.5*jl(e*2,.1125,.45):.5+.5*zl(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-ni.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?ni.easeInBounce(e*2)*.5:ni.easeOutBounce(e*2-1)*.5+.5};/*!
 * @kurkle/color v0.2.1
 * https://github.com/kurkle/color#readme
 * (c) 2022 Jukka Kurkela
 * Released under the MIT License
 */function Oi(e){return e+.5|0}const de=(e,t,n)=>Math.max(Math.min(e,n),t);function Yn(e){return de(Oi(e*2.55),0,255)}function ge(e){return de(Oi(e*255),0,255)}function ne(e){return de(Oi(e/2.55)/100,0,1)}function Ul(e){return de(Oi(e*100),0,100)}const Vt={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Co=[..."0123456789ABCDEF"],vp=e=>Co[e&15],_p=e=>Co[(e&240)>>4]+Co[e&15],ts=e=>(e&240)>>4===(e&15),xp=e=>ts(e.r)&&ts(e.g)&&ts(e.b)&&ts(e.a);function wp(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&Vt[e[1]]*17,g:255&Vt[e[2]]*17,b:255&Vt[e[3]]*17,a:t===5?Vt[e[4]]*17:255}:(t===7||t===9)&&(n={r:Vt[e[1]]<<4|Vt[e[2]],g:Vt[e[3]]<<4|Vt[e[4]],b:Vt[e[5]]<<4|Vt[e[6]],a:t===9?Vt[e[7]]<<4|Vt[e[8]]:255})),n}const Sp=(e,t)=>e<255?t(e):"";function Ep(e){var t=xp(e)?vp:_p;return e?"#"+t(e.r)+t(e.g)+t(e.b)+Sp(e.a,t):void 0}const Tp=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Fu(e,t,n){const i=t*Math.min(n,1-n),s=(r,o=(r+e/30)%12)=>n-i*Math.max(Math.min(o-3,9-o,1),-1);return[s(0),s(8),s(4)]}function Cp(e,t,n){const i=(s,r=(s+e/60)%6)=>n-n*t*Math.max(Math.min(r,4-r,1),0);return[i(5),i(3),i(1)]}function Ap(e,t,n){const i=Fu(e,1,.5);let s;for(t+n>1&&(s=1/(t+n),t*=s,n*=s),s=0;s<3;s++)i[s]*=1-t-n,i[s]+=t;return i}function Dp(e,t,n,i,s){return e===s?(t-n)/i+(t<n?6:0):t===s?(n-e)/i+2:(e-t)/i+4}function _a(e){const n=e.r/255,i=e.g/255,s=e.b/255,r=Math.max(n,i,s),o=Math.min(n,i,s),a=(r+o)/2;let l,c,h;return r!==o&&(h=r-o,c=a>.5?h/(2-r-o):h/(r+o),l=Dp(n,i,s,h,r),l=l*60+.5),[l|0,c||0,a]}function xa(e,t,n,i){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,i)).map(ge)}function wa(e,t,n){return xa(Fu,e,t,n)}function Mp(e,t,n){return xa(Ap,e,t,n)}function Ip(e,t,n){return xa(Cp,e,t,n)}function Bu(e){return(e%360+360)%360}function kp(e){const t=Tp.exec(e);let n=255,i;if(!t)return;t[5]!==i&&(n=t[6]?Yn(+t[5]):ge(+t[5]));const s=Bu(+t[2]),r=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?i=Mp(s,r,o):t[1]==="hsv"?i=Ip(s,r,o):i=wa(s,r,o),{r:i[0],g:i[1],b:i[2],a:n}}function Op(e,t){var n=_a(e);n[0]=Bu(n[0]+t),n=wa(n),e.r=n[0],e.g=n[1],e.b=n[2]}function Pp(e){if(!e)return;const t=_a(e),n=t[0],i=Ul(t[1]),s=Ul(t[2]);return e.a<255?`hsla(${n}, ${i}%, ${s}%, ${ne(e.a)})`:`hsl(${n}, ${i}%, ${s}%)`}const Hl={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Wl={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Rp(){const e={},t=Object.keys(Wl),n=Object.keys(Hl);let i,s,r,o,a;for(i=0;i<t.length;i++){for(o=a=t[i],s=0;s<n.length;s++)r=n[s],a=a.replace(r,Hl[r]);r=parseInt(Wl[o],16),e[a]=[r>>16&255,r>>8&255,r&255]}return e}let es;function Lp(e){es||(es=Rp(),es.transparent=[0,0,0,0]);const t=es[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const Np=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Fp(e){const t=Np.exec(e);let n=255,i,s,r;if(!!t){if(t[7]!==i){const o=+t[7];n=t[8]?Yn(o):de(o*255,0,255)}return i=+t[1],s=+t[3],r=+t[5],i=255&(t[2]?Yn(i):de(i,0,255)),s=255&(t[4]?Yn(s):de(s,0,255)),r=255&(t[6]?Yn(r):de(r,0,255)),{r:i,g:s,b:r,a:n}}}function Bp(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${ne(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const Wr=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,an=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function Vp(e,t,n){const i=an(ne(e.r)),s=an(ne(e.g)),r=an(ne(e.b));return{r:ge(Wr(i+n*(an(ne(t.r))-i))),g:ge(Wr(s+n*(an(ne(t.g))-s))),b:ge(Wr(r+n*(an(ne(t.b))-r))),a:e.a+n*(t.a-e.a)}}function ns(e,t,n){if(e){let i=_a(e);i[t]=Math.max(0,Math.min(i[t]+i[t]*n,t===0?360:1)),i=wa(i),e.r=i[0],e.g=i[1],e.b=i[2]}}function Vu(e,t){return e&&Object.assign(t||{},e)}function Kl(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=ge(e[3]))):(t=Vu(e,{r:0,g:0,b:0,a:1}),t.a=ge(t.a)),t}function $p(e){return e.charAt(0)==="r"?Fp(e):kp(e)}class Ds{constructor(t){if(t instanceof Ds)return t;const n=typeof t;let i;n==="object"?i=Kl(t):n==="string"&&(i=wp(t)||Lp(t)||$p(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=Vu(this._rgb);return t&&(t.a=ne(t.a)),t}set rgb(t){this._rgb=Kl(t)}rgbString(){return this._valid?Bp(this._rgb):void 0}hexString(){return this._valid?Ep(this._rgb):void 0}hslString(){return this._valid?Pp(this._rgb):void 0}mix(t,n){if(t){const i=this.rgb,s=t.rgb;let r;const o=n===r?.5:n,a=2*o-1,l=i.a-s.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;r=1-c,i.r=255&c*i.r+r*s.r+.5,i.g=255&c*i.g+r*s.g+.5,i.b=255&c*i.b+r*s.b+.5,i.a=o*i.a+(1-o)*s.a,this.rgb=i}return this}interpolate(t,n){return t&&(this._rgb=Vp(this._rgb,t._rgb,n)),this}clone(){return new Ds(this.rgb)}alpha(t){return this._rgb.a=ge(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=Oi(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return ns(this._rgb,2,t),this}darken(t){return ns(this._rgb,2,-t),this}saturate(t){return ns(this._rgb,1,t),this}desaturate(t){return ns(this._rgb,1,-t),this}rotate(t){return Op(this._rgb,t),this}}function $u(e){return new Ds(e)}function ju(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function ql(e){return ju(e)?e:$u(e)}function Kr(e){return ju(e)?e:$u(e).saturate(.5).darken(.1).hexString()}const Ue=Object.create(null),Ao=Object.create(null);function ii(e,t){if(!t)return e;const n=t.split(".");for(let i=0,s=n.length;i<s;++i){const r=n[i];e=e[r]||(e[r]=Object.create(null))}return e}function qr(e,t,n){return typeof t=="string"?di(ii(e,t),n):di(ii(e,""),t)}class jp{constructor(t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>Kr(i.backgroundColor),this.hoverBorderColor=(n,i)=>Kr(i.borderColor),this.hoverColor=(n,i)=>Kr(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t)}set(t,n){return qr(this,t,n)}get(t){return ii(this,t)}describe(t,n){return qr(Ao,t,n)}override(t,n){return qr(Ue,t,n)}route(t,n,i,s){const r=ii(this,t),o=ii(this,i),a="_"+n;Object.defineProperties(r,{[a]:{value:r[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],c=o[s];return V(l)?Object.assign({},c,l):L(l,c)},set(l){this[a]=l}}})}}var $=new jp({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});function zp(e){return!e||H(e.size)||H(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function Ms(e,t,n,i,s){let r=t[s];return r||(r=t[s]=e.measureText(s).width,n.push(s)),r>i&&(i=r),i}function Up(e,t,n,i){i=i||{};let s=i.data=i.data||{},r=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(s=i.data={},r=i.garbageCollect=[],i.font=t),e.save(),e.font=t;let o=0;const a=n.length;let l,c,h,u,d;for(l=0;l<a;l++)if(u=n[l],u!=null&&J(u)!==!0)o=Ms(e,s,r,o,u);else if(J(u))for(c=0,h=u.length;c<h;c++)d=u[c],d!=null&&!J(d)&&(o=Ms(e,s,r,o,d));e.restore();const f=r.length/2;if(f>n.length){for(l=0;l<f;l++)delete s[r[l]];r.splice(0,f)}return o}function De(e,t,n){const i=e.currentDevicePixelRatio,s=n!==0?Math.max(n/2,.5):0;return Math.round((t-s)*i)/i+s}function Gl(e,t){t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore()}function Do(e,t,n,i){zu(e,t,n,i,null)}function zu(e,t,n,i,s){let r,o,a,l,c,h;const u=t.pointStyle,d=t.rotation,f=t.radius;let g=(d||0)*cp;if(u&&typeof u=="object"&&(r=u.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){e.save(),e.translate(n,i),e.rotate(g),e.drawImage(u,-u.width/2,-u.height/2,u.width,u.height),e.restore();return}if(!(isNaN(f)||f<=0)){switch(e.beginPath(),u){default:s?e.ellipse(n,i,s/2,f,0,0,Y):e.arc(n,i,f,0,Y),e.closePath();break;case"triangle":e.moveTo(n+Math.sin(g)*f,i-Math.cos(g)*f),g+=Fl,e.lineTo(n+Math.sin(g)*f,i-Math.cos(g)*f),g+=Fl,e.lineTo(n+Math.sin(g)*f,i-Math.cos(g)*f),e.closePath();break;case"rectRounded":c=f*.516,l=f-c,o=Math.cos(g+$n)*l,a=Math.sin(g+$n)*l,e.arc(n-o,i-a,c,g-et,g-it),e.arc(n+a,i-o,c,g-it,g),e.arc(n+o,i+a,c,g,g+it),e.arc(n-a,i+o,c,g+it,g+et),e.closePath();break;case"rect":if(!d){l=Math.SQRT1_2*f,h=s?s/2:l,e.rect(n-h,i-l,2*h,2*l);break}g+=$n;case"rectRot":o=Math.cos(g)*f,a=Math.sin(g)*f,e.moveTo(n-o,i-a),e.lineTo(n+a,i-o),e.lineTo(n+o,i+a),e.lineTo(n-a,i+o),e.closePath();break;case"crossRot":g+=$n;case"cross":o=Math.cos(g)*f,a=Math.sin(g)*f,e.moveTo(n-o,i-a),e.lineTo(n+o,i+a),e.moveTo(n+a,i-o),e.lineTo(n-a,i+o);break;case"star":o=Math.cos(g)*f,a=Math.sin(g)*f,e.moveTo(n-o,i-a),e.lineTo(n+o,i+a),e.moveTo(n+a,i-o),e.lineTo(n-a,i+o),g+=$n,o=Math.cos(g)*f,a=Math.sin(g)*f,e.moveTo(n-o,i-a),e.lineTo(n+o,i+a),e.moveTo(n+a,i-o),e.lineTo(n-a,i+o);break;case"line":o=s?s/2:Math.cos(g)*f,a=Math.sin(g)*f,e.moveTo(n-o,i-a),e.lineTo(n+o,i+a);break;case"dash":e.moveTo(n,i),e.lineTo(n+Math.cos(g)*f,i+Math.sin(g)*f);break}e.fill(),t.borderWidth>0&&e.stroke()}}function gi(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function Js(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Zs(e){e.restore()}function Hp(e,t,n,i,s){if(!t)return e.lineTo(n.x,n.y);if(s==="middle"){const r=(t.x+n.x)/2;e.lineTo(r,t.y),e.lineTo(r,n.y)}else s==="after"!=!!i?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function Wp(e,t,n,i){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function He(e,t,n,i,s,r={}){const o=J(t)?t:[t],a=r.strokeWidth>0&&r.strokeColor!=="";let l,c;for(e.save(),e.font=s.string,Kp(e,r),l=0;l<o.length;++l)c=o[l],a&&(r.strokeColor&&(e.strokeStyle=r.strokeColor),H(r.strokeWidth)||(e.lineWidth=r.strokeWidth),e.strokeText(c,n,i,r.maxWidth)),e.fillText(c,n,i,r.maxWidth),qp(e,n,i,c,r),i+=s.lineHeight;e.restore()}function Kp(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),H(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function qp(e,t,n,i,s){if(s.strikethrough||s.underline){const r=e.measureText(i),o=t-r.actualBoundingBoxLeft,a=t+r.actualBoundingBoxRight,l=n-r.actualBoundingBoxAscent,c=n+r.actualBoundingBoxDescent,h=s.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=s.decorationWidth||2,e.moveTo(o,h),e.lineTo(a,h),e.stroke()}}function pi(e,t){const{x:n,y:i,w:s,h:r,radius:o}=t;e.arc(n+o.topLeft,i+o.topLeft,o.topLeft,-it,et,!0),e.lineTo(n,i+r-o.bottomLeft),e.arc(n+o.bottomLeft,i+r-o.bottomLeft,o.bottomLeft,et,it,!0),e.lineTo(n+s-o.bottomRight,i+r),e.arc(n+s-o.bottomRight,i+r-o.bottomRight,o.bottomRight,it,0,!0),e.lineTo(n+s,i+o.topRight),e.arc(n+s-o.topRight,i+o.topRight,o.topRight,0,-it,!0),e.lineTo(n+o.topLeft,i)}const Gp=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),Yp=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function Xp(e,t){const n=(""+e).match(Gp);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const Qp=e=>+e||0;function Sa(e,t){const n={},i=V(t),s=i?Object.keys(t):t,r=V(e)?i?o=>L(e[o],e[t[o]]):o=>e[o]:()=>e;for(const o of s)n[o]=Qp(r(o));return n}function Uu(e){return Sa(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Fe(e){return Sa(e,["topLeft","topRight","bottomLeft","bottomRight"])}function At(e){const t=Uu(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function dt(e,t){e=e||{},t=t||$.font;let n=L(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let i=L(e.style,t.style);i&&!(""+i).match(Yp)&&(console.warn('Invalid font style specified: "'+i+'"'),i="");const s={family:L(e.family,t.family),lineHeight:Xp(L(e.lineHeight,t.lineHeight),n),size:n,style:i,weight:L(e.weight,t.weight),string:""};return s.string=zp(s),s}function Xn(e,t,n,i){let s=!0,r,o,a;for(r=0,o=e.length;r<o;++r)if(a=e[r],a!==void 0&&(t!==void 0&&typeof a=="function"&&(a=a(t),s=!1),n!==void 0&&J(a)&&(a=a[n%a.length],s=!1),a!==void 0))return i&&!s&&(i.cacheable=!1),a}function Jp(e,t,n){const{min:i,max:s}=e,r=Au(t,(s-i)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(i,-Math.abs(r)),max:o(s,r)}}function we(e,t){return Object.assign(Object.create(e),t)}function Ea(e,t=[""],n=e,i,s=()=>e[0]){zt(i)||(i=qu("_fallback",e));const r={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:n,_fallback:i,_getTarget:s,override:o=>Ea([o,...e],t,n,i)};return new Proxy(r,{deleteProperty(o,a){return delete o[a],delete o._keys,delete e[0][a],!0},get(o,a){return Wu(o,a,()=>om(a,t,e,o))},getOwnPropertyDescriptor(o,a){return Reflect.getOwnPropertyDescriptor(o._scopes[0],a)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(o,a){return Xl(o).includes(a)},ownKeys(o){return Xl(o)},set(o,a,l){const c=o._storage||(o._storage=s());return o[a]=c[a]=l,delete o._keys,!0}})}function bn(e,t,n,i){const s={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:Hu(e,i),setContext:r=>bn(e,r,n,i),override:r=>bn(e.override(r),t,n,i)};return new Proxy(s,{deleteProperty(r,o){return delete r[o],delete e[o],!0},get(r,o,a){return Wu(r,o,()=>tm(r,o,a))},getOwnPropertyDescriptor(r,o){return r._descriptors.allKeys?Reflect.has(e,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,o)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(r,o){return Reflect.has(e,o)},ownKeys(){return Reflect.ownKeys(e)},set(r,o,a){return e[o]=a,delete r[o],!0}})}function Hu(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:i=t.indexable,_allKeys:s=t.allKeys}=e;return{allKeys:s,scriptable:n,indexable:i,isScriptable:ye(n)?n:()=>n,isIndexable:ye(i)?i:()=>i}}const Zp=(e,t)=>e?e+ma(t):t,Ta=(e,t)=>V(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function Wu(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t))return e[t];const i=n();return e[t]=i,i}function tm(e,t,n){const{_proxy:i,_context:s,_subProxy:r,_descriptors:o}=e;let a=i[t];return ye(a)&&o.isScriptable(t)&&(a=em(t,a,e,n)),J(a)&&a.length&&(a=nm(t,a,e,o.isIndexable)),Ta(t,a)&&(a=bn(a,s,r&&r[t],o)),a}function em(e,t,n,i){const{_proxy:s,_context:r,_subProxy:o,_stack:a}=n;if(a.has(e))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+e);return a.add(e),t=t(r,o||i),a.delete(e),Ta(e,t)&&(t=Ca(s._scopes,s,e,t)),t}function nm(e,t,n,i){const{_proxy:s,_context:r,_subProxy:o,_descriptors:a}=n;if(zt(r.index)&&i(e))t=t[r.index%t.length];else if(V(t[0])){const l=t,c=s._scopes.filter(h=>h!==l);t=[];for(const h of l){const u=Ca(c,s,e,h);t.push(bn(u,r,o&&o[e],a))}}return t}function Ku(e,t,n){return ye(e)?e(t,n):e}const im=(e,t)=>e===!0?t:typeof e=="string"?me(t,e):void 0;function sm(e,t,n,i,s){for(const r of t){const o=im(n,r);if(o){e.add(o);const a=Ku(o._fallback,n,s);if(zt(a)&&a!==n&&a!==i)return a}else if(o===!1&&zt(i)&&n!==i)return null}return!1}function Ca(e,t,n,i){const s=t._rootScopes,r=Ku(t._fallback,n,i),o=[...e,...s],a=new Set;a.add(i);let l=Yl(a,o,n,r||n,i);return l===null||zt(r)&&r!==n&&(l=Yl(a,o,r,l,i),l===null)?!1:Ea(Array.from(a),[""],s,r,()=>rm(t,n,i))}function Yl(e,t,n,i,s){for(;n;)n=sm(e,t,n,i,s);return n}function rm(e,t,n){const i=e._getTarget();t in i||(i[t]={});const s=i[t];return J(s)&&V(n)?n:s}function om(e,t,n,i){let s;for(const r of t)if(s=qu(Zp(r,e),n),zt(s))return Ta(e,s)?Ca(n,i,e,s):s}function qu(e,t){for(const n of t){if(!n)continue;const i=n[e];if(zt(i))return i}}function Xl(e){let t=e._keys;return t||(t=e._keys=am(e._scopes)),t}function am(e){const t=new Set;for(const n of e)for(const i of Object.keys(n).filter(s=>!s.startsWith("_")))t.add(i);return Array.from(t)}function Gu(e,t,n,i){const{iScale:s}=e,{key:r="r"}=this._parsing,o=new Array(i);let a,l,c,h;for(a=0,l=i;a<l;++a)c=a+n,h=t[c],o[a]={r:s.parse(me(h,r),c)};return o}const lm=Number.EPSILON||1e-14,vn=(e,t)=>t<e.length&&!e[t].skip&&e[t],Yu=e=>e==="x"?"y":"x";function cm(e,t,n,i){const s=e.skip?t:e,r=t,o=n.skip?t:n,a=To(r,s),l=To(o,r);let c=a/(a+l),h=l/(a+l);c=isNaN(c)?0:c,h=isNaN(h)?0:h;const u=i*c,d=i*h;return{previous:{x:r.x-u*(o.x-s.x),y:r.y-u*(o.y-s.y)},next:{x:r.x+d*(o.x-s.x),y:r.y+d*(o.y-s.y)}}}function hm(e,t,n){const i=e.length;let s,r,o,a,l,c=vn(e,0);for(let h=0;h<i-1;++h)if(l=c,c=vn(e,h+1),!(!l||!c)){if(ei(t[h],0,lm)){n[h]=n[h+1]=0;continue}s=n[h]/t[h],r=n[h+1]/t[h],a=Math.pow(s,2)+Math.pow(r,2),!(a<=9)&&(o=3/Math.sqrt(a),n[h]=s*o*t[h],n[h+1]=r*o*t[h])}}function um(e,t,n="x"){const i=Yu(n),s=e.length;let r,o,a,l=vn(e,0);for(let c=0;c<s;++c){if(o=a,a=l,l=vn(e,c+1),!a)continue;const h=a[n],u=a[i];o&&(r=(h-o[n])/3,a[`cp1${n}`]=h-r,a[`cp1${i}`]=u-r*t[c]),l&&(r=(l[n]-h)/3,a[`cp2${n}`]=h+r,a[`cp2${i}`]=u+r*t[c])}}function dm(e,t="x"){const n=Yu(t),i=e.length,s=Array(i).fill(0),r=Array(i);let o,a,l,c=vn(e,0);for(o=0;o<i;++o)if(a=l,l=c,c=vn(e,o+1),!!l){if(c){const h=c[t]-l[t];s[o]=h!==0?(c[n]-l[n])/h:0}r[o]=a?c?Yt(s[o-1])!==Yt(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}hm(e,s,r),um(e,r,t)}function is(e,t,n){return Math.max(Math.min(e,n),t)}function fm(e,t){let n,i,s,r,o,a=gi(e[0],t);for(n=0,i=e.length;n<i;++n)o=r,r=a,a=n<i-1&&gi(e[n+1],t),r&&(s=e[n],o&&(s.cp1x=is(s.cp1x,t.left,t.right),s.cp1y=is(s.cp1y,t.top,t.bottom)),a&&(s.cp2x=is(s.cp2x,t.left,t.right),s.cp2y=is(s.cp2y,t.top,t.bottom)))}function gm(e,t,n,i,s){let r,o,a,l;if(t.spanGaps&&(e=e.filter(c=>!c.skip)),t.cubicInterpolationMode==="monotone")dm(e,s);else{let c=i?e[e.length-1]:e[0];for(r=0,o=e.length;r<o;++r)a=e[r],l=cm(c,a,e[Math.min(r+1,o-(i?0:1))%o],t.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}t.capBezierPoints&&fm(e,n)}function Xu(){return typeof window!="undefined"&&typeof document!="undefined"}function Aa(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function Is(e,t,n){let i;return typeof e=="string"?(i=parseInt(e,10),e.indexOf("%")!==-1&&(i=i/100*t.parentNode[n])):i=e,i}const tr=e=>window.getComputedStyle(e,null);function pm(e,t){return tr(e).getPropertyValue(t)}const mm=["top","right","bottom","left"];function Be(e,t,n){const i={};n=n?"-"+n:"";for(let s=0;s<4;s++){const r=mm[s];i[r]=parseFloat(e[t+"-"+r+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const ym=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function bm(e,t){const n=e.touches,i=n&&n.length?n[0]:e,{offsetX:s,offsetY:r}=i;let o=!1,a,l;if(ym(s,r,e.target))a=s,l=r;else{const c=t.getBoundingClientRect();a=i.clientX-c.left,l=i.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function Ie(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:i}=t,s=tr(n),r=s.boxSizing==="border-box",o=Be(s,"padding"),a=Be(s,"border","width"),{x:l,y:c,box:h}=bm(e,n),u=o.left+(h&&a.left),d=o.top+(h&&a.top);let{width:f,height:g}=t;return r&&(f-=o.width+a.width,g-=o.height+a.height),{x:Math.round((l-u)/f*n.width/i),y:Math.round((c-d)/g*n.height/i)}}function vm(e,t,n){let i,s;if(t===void 0||n===void 0){const r=Aa(e);if(!r)t=e.clientWidth,n=e.clientHeight;else{const o=r.getBoundingClientRect(),a=tr(r),l=Be(a,"border","width"),c=Be(a,"padding");t=o.width-c.width-l.width,n=o.height-c.height-l.height,i=Is(a.maxWidth,r,"clientWidth"),s=Is(a.maxHeight,r,"clientHeight")}}return{width:t,height:n,maxWidth:i||As,maxHeight:s||As}}const Gr=e=>Math.round(e*10)/10;function _m(e,t,n,i){const s=tr(e),r=Be(s,"margin"),o=Is(s.maxWidth,e,"clientWidth")||As,a=Is(s.maxHeight,e,"clientHeight")||As,l=vm(e,t,n);let{width:c,height:h}=l;if(s.boxSizing==="content-box"){const u=Be(s,"border","width"),d=Be(s,"padding");c-=d.width+u.width,h-=d.height+u.height}return c=Math.max(0,c-r.width),h=Math.max(0,i?Math.floor(c/i):h-r.height),c=Gr(Math.min(c,o,l.maxWidth)),h=Gr(Math.min(h,a,l.maxHeight)),c&&!h&&(h=Gr(c/2)),{width:c,height:h}}function Ql(e,t,n){const i=t||1,s=Math.floor(e.height*i),r=Math.floor(e.width*i);e.height=s/i,e.width=r/i;const o=e.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${e.height}px`,o.style.width=`${e.width}px`),e.currentDevicePixelRatio!==i||o.height!==s||o.width!==r?(e.currentDevicePixelRatio=i,o.height=s,o.width=r,e.ctx.setTransform(i,0,0,i,0,0),!0):!1}const xm=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch{}return e}();function Jl(e,t){const n=pm(e,t),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function ke(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function wm(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:i==="middle"?n<.5?e.y:t.y:i==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function Sm(e,t,n,i){const s={x:e.cp2x,y:e.cp2y},r={x:t.cp1x,y:t.cp1y},o=ke(e,s,n),a=ke(s,r,n),l=ke(r,t,n),c=ke(o,a,n),h=ke(a,l,n);return ke(c,h,n)}const Zl=new Map;function Em(e,t){t=t||{};const n=e+JSON.stringify(t);let i=Zl.get(n);return i||(i=new Intl.NumberFormat(e,t),Zl.set(n,i)),i}function Pi(e,t,n){return Em(t,n).format(e)}const Tm=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,i){return n-i},leftForLtr(n,i){return n-i}}},Cm=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function dn(e,t,n){return e?Tm(t,n):Cm()}function Qu(e,t){let n,i;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=i)}function Ju(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function Zu(e){return e==="angle"?{between:fi,compare:dp,normalize:Ft}:{between:ie,compare:(t,n)=>t-n,normalize:t=>t}}function tc({start:e,end:t,count:n,loop:i,style:s}){return{start:e%n,end:t%n,loop:i&&(t-e+1)%n===0,style:s}}function Am(e,t,n){const{property:i,start:s,end:r}=n,{between:o,normalize:a}=Zu(i),l=t.length;let{start:c,end:h,loop:u}=e,d,f;if(u){for(c+=l,h+=l,d=0,f=l;d<f&&o(a(t[c%l][i]),s,r);++d)c--,h--;c%=l,h%=l}return h<c&&(h+=l),{start:c,end:h,loop:u,style:e.style}}function td(e,t,n){if(!n)return[e];const{property:i,start:s,end:r}=n,o=t.length,{compare:a,between:l,normalize:c}=Zu(i),{start:h,end:u,loop:d,style:f}=Am(e,t,n),g=[];let p=!1,m=null,y,b,_;const x=()=>l(s,_,y)&&a(s,_)!==0,v=()=>a(r,y)===0||l(r,_,y),E=()=>p||x(),S=()=>!p||v();for(let D=h,A=h;D<=u;++D)b=t[D%o],!b.skip&&(y=c(b[i]),y!==_&&(p=l(y,s,r),m===null&&E()&&(m=a(y,s)===0?D:A),m!==null&&S()&&(g.push(tc({start:m,end:D,loop:d,count:o,style:f})),m=null),A=D,_=y));return m!==null&&g.push(tc({start:m,end:u,loop:d,count:o,style:f})),g}function ed(e,t){const n=[],i=e.segments;for(let s=0;s<i.length;s++){const r=td(i[s],e.points,t);r.length&&n.push(...r)}return n}function Dm(e,t,n,i){let s=0,r=t-1;if(n&&!i)for(;s<t&&!e[s].skip;)s++;for(;s<t&&e[s].skip;)s++;for(s%=t,n&&(r+=s);r>s&&e[r%t].skip;)r--;return r%=t,{start:s,end:r}}function Mm(e,t,n,i){const s=e.length,r=[];let o=t,a=e[t],l;for(l=t+1;l<=n;++l){const c=e[l%s];c.skip||c.stop?a.skip||(i=!1,r.push({start:t%s,end:(l-1)%s,loop:i}),t=o=c.stop?l:null):(o=l,a.skip&&(t=l)),a=c}return o!==null&&r.push({start:t%s,end:o%s,loop:i}),r}function Im(e,t){const n=e.points,i=e.options.spanGaps,s=n.length;if(!s)return[];const r=!!e._loop,{start:o,end:a}=Dm(n,s,r,i);if(i===!0)return ec(e,[{start:o,end:a,loop:r}],n,t);const l=a<o?a+s:a,c=!!e._fullLoop&&o===0&&a===s-1;return ec(e,Mm(n,o,l,c),n,t)}function ec(e,t,n,i){return!i||!i.setContext||!n?t:km(e,t,n,i)}function km(e,t,n,i){const s=e._chart.getContext(),r=nc(e.options),{_datasetIndex:o,options:{spanGaps:a}}=e,l=n.length,c=[];let h=r,u=t[0].start,d=u;function f(g,p,m,y){const b=a?-1:1;if(g!==p){for(g+=l;n[g%l].skip;)g-=b;for(;n[p%l].skip;)p+=b;g%l!==p%l&&(c.push({start:g%l,end:p%l,loop:m,style:y}),h=y,u=p%l)}}for(const g of t){u=a?u:g.start;let p=n[u%l],m;for(d=u+1;d<=g.end;d++){const y=n[d%l];m=nc(i.setContext(we(s,{type:"segment",p0:p,p1:y,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:o}))),Om(m,h)&&f(u,d-1,g.loop,h),p=y,h=m}u<d-1&&f(u,d-1,g.loop,h)}return c}function nc(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Om(e,t){return t&&JSON.stringify(e)!==JSON.stringify(t)}/*!
 * Chart.js v3.9.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */class Pm{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,i,s){const r=n.listeners[s],o=n.duration;r.forEach(a=>a({chart:t,initial:n.initial,numSteps:o,currentStep:Math.min(i-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Pu.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((i,s)=>{if(!i.running||!i.items.length)return;const r=i.items;let o=r.length-1,a=!1,l;for(;o>=0;--o)l=r[o],l._active?(l._total>i.duration&&(i.duration=l._total),l.tick(t),a=!0):(r[o]=r[r.length-1],r.pop());a&&(s.draw(),this._notify(s,i,t,"progress")),r.length||(i.running=!1,this._notify(s,i,t,"complete"),i.initial=!1),n+=r.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let i=n.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,i)),i}listen(t,n,i){this._getAnims(t).listeners[n].push(i)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);!n||(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((i,s)=>Math.max(i,s._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const i=n.items;let s=i.length-1;for(;s>=0;--s)i[s].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Zt=new Pm;const ic="transparent",Rm={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const i=ql(e||ic),s=i.valid&&ql(t||ic);return s&&s.valid?s.mix(i,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class Lm{constructor(t,n,i,s){const r=n[i];s=Xn([t.to,s,r,t.from]);const o=Xn([t.from,r,s]);this._active=!0,this._fn=t.fn||Rm[t.type||typeof o],this._easing=ni[t.easing]||ni.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=i,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(t,n,i){if(this._active){this._notify(!1);const s=this._target[this._prop],r=i-this._start,o=this._duration-r;this._start=i,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=Xn([t.to,n,s,t.from]),this._from=Xn([t.from,s,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,i=this._duration,s=this._prop,r=this._from,o=this._loop,a=this._to;let l;if(this._active=r!==a&&(o||n<i),!this._active){this._target[s]=a,this._notify(!0);return}if(n<0){this._target[s]=r;return}l=n/i%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[s]=this._fn(r,a,l)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,i)=>{t.push({res:n,rej:i})})}_notify(t){const n=t?"res":"rej",i=this._promises||[];for(let s=0;s<i.length;s++)i[s][n]()}}const Nm=["x","y","borderWidth","radius","tension"],Fm=["color","borderColor","backgroundColor"];$.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const Bm=Object.keys($.animation);$.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"});$.set("animations",{colors:{type:"color",properties:Fm},numbers:{type:"number",properties:Nm}});$.describe("animations",{_fallback:"animation"});$.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}});class nd{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!V(t))return;const n=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const s=t[i];if(!V(s))return;const r={};for(const o of Bm)r[o]=s[o];(J(s.properties)&&s.properties||[i]).forEach(o=>{(o===i||!n.has(o))&&n.set(o,r)})})}_animateOptions(t,n){const i=n.options,s=$m(t,i);if(!s)return[];const r=this._createAnimations(s,i);return i.$shared&&Vm(t.options.$animations,i).then(()=>{t.options=i},()=>{}),r}_createAnimations(t,n){const i=this._properties,s=[],r=t.$animations||(t.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){s.push(...this._animateOptions(t,n));continue}const h=n[c];let u=r[c];const d=i.get(c);if(u)if(d&&u.active()){u.update(d,h,a);continue}else u.cancel();if(!d||!d.duration){t[c]=h;continue}r[c]=u=new Lm(d,t,c,h),s.push(u)}return s}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const i=this._createAnimations(t,n);if(i.length)return Zt.add(this._chart,i),!0}}function Vm(e,t){const n=[],i=Object.keys(t);for(let s=0;s<i.length;s++){const r=e[i[s]];r&&r.active()&&n.push(r.wait())}return Promise.all(n)}function $m(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function sc(e,t){const n=e&&e.options||{},i=n.reverse,s=n.min===void 0?t:0,r=n.max===void 0?t:0;return{start:i?r:s,end:i?s:r}}function jm(e,t,n){if(n===!1)return!1;const i=sc(e,n),s=sc(t,n);return{top:s.end,right:i.end,bottom:s.start,left:i.start}}function zm(e){let t,n,i,s;return V(e)?(t=e.top,n=e.right,i=e.bottom,s=e.left):t=n=i=s=e,{top:t,right:n,bottom:i,left:s,disabled:e===!1}}function id(e,t){const n=[],i=e._getSortedDatasetMetas(t);let s,r;for(s=0,r=i.length;s<r;++s)n.push(i[s].index);return n}function rc(e,t,n,i={}){const s=e.keys,r=i.mode==="single";let o,a,l,c;if(t!==null){for(o=0,a=s.length;o<a;++o){if(l=+s[o],l===n){if(i.all)continue;break}c=e.values[l],rt(c)&&(r||t===0||Yt(t)===Yt(c))&&(t+=c)}return t}}function Um(e){const t=Object.keys(e),n=new Array(t.length);let i,s,r;for(i=0,s=t.length;i<s;++i)r=t[i],n[i]={x:r,y:e[r]};return n}function oc(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function Hm(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function Wm(e){const{min:t,max:n,minDefined:i,maxDefined:s}=e.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:s?n:Number.POSITIVE_INFINITY}}function Km(e,t,n){const i=e[t]||(e[t]={});return i[n]||(i[n]={})}function ac(e,t,n,i){for(const s of t.getMatchingVisibleMetas(i).reverse()){const r=e[s.index];if(n&&r>0||!n&&r<0)return s.index}return null}function lc(e,t){const{chart:n,_cachedMeta:i}=e,s=n._stacks||(n._stacks={}),{iScale:r,vScale:o,index:a}=i,l=r.axis,c=o.axis,h=Hm(r,o,i),u=t.length;let d;for(let f=0;f<u;++f){const g=t[f],{[l]:p,[c]:m}=g,y=g._stacks||(g._stacks={});d=y[c]=Km(s,h,p),d[a]=m,d._top=ac(d,o,!0,i.type),d._bottom=ac(d,o,!1,i.type)}}function Yr(e,t){const n=e.scales;return Object.keys(n).filter(i=>n[i].axis===t).shift()}function qm(e,t){return we(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function Gm(e,t,n){return we(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function jn(e,t){const n=e.controller.index,i=e.vScale&&e.vScale.axis;if(!!i){t=t||e._parsed;for(const s of t){const r=s._stacks;if(!r||r[i]===void 0||r[i][n]===void 0)return;delete r[i][n]}}}const Xr=e=>e==="reset"||e==="none",cc=(e,t)=>t?e:Object.assign({},e),Ym=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:id(n,!0),values:null};class Ht{constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=oc(t.vScale,t),this.addElements()}updateIndex(t){this.index!==t&&jn(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,i=this.getDataset(),s=(u,d,f,g)=>u==="x"?d:u==="r"?g:f,r=n.xAxisID=L(i.xAxisID,Yr(t,"x")),o=n.yAxisID=L(i.yAxisID,Yr(t,"y")),a=n.rAxisID=L(i.rAxisID,Yr(t,"r")),l=n.indexAxis,c=n.iAxisID=s(l,r,o,a),h=n.vAxisID=s(l,o,r,a);n.xScale=this.getScaleForId(r),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(c),n.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&$l(this._data,this),t._stacked&&jn(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),i=this._data;if(V(n))this._data=Um(n);else if(i!==n){if(i){$l(i,this);const s=this._cachedMeta;jn(s),s._parsed=[]}n&&Object.isExtensible(n)&&mp(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,i=this.getDataset();let s=!1;this._dataCheck();const r=n._stacked;n._stacked=oc(n.vScale,n),n.stack!==i.stack&&(s=!0,jn(n),n.stack=i.stack),this._resyncElements(t),(s||r!==n._stacked)&&lc(this,n._parsed)}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:i,_data:s}=this,{iScale:r,_stacked:o}=i,a=r.axis;let l=t===0&&n===s.length?!0:i._sorted,c=t>0&&i._parsed[t-1],h,u,d;if(this._parsing===!1)i._parsed=s,i._sorted=!0,d=s;else{J(s[t])?d=this.parseArrayData(i,s,t,n):V(s[t])?d=this.parseObjectData(i,s,t,n):d=this.parsePrimitiveData(i,s,t,n);const f=()=>u[a]===null||c&&u[a]<c[a];for(h=0;h<n;++h)i._parsed[h+t]=u=d[h],l&&(f()&&(l=!1),c=u);i._sorted=l}o&&lc(this,d)}parsePrimitiveData(t,n,i,s){const{iScale:r,vScale:o}=t,a=r.axis,l=o.axis,c=r.getLabels(),h=r===o,u=new Array(s);let d,f,g;for(d=0,f=s;d<f;++d)g=d+i,u[d]={[a]:h||r.parse(c[g],g),[l]:o.parse(n[g],g)};return u}parseArrayData(t,n,i,s){const{xScale:r,yScale:o}=t,a=new Array(s);let l,c,h,u;for(l=0,c=s;l<c;++l)h=l+i,u=n[h],a[l]={x:r.parse(u[0],h),y:o.parse(u[1],h)};return a}parseObjectData(t,n,i,s){const{xScale:r,yScale:o}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(s);let h,u,d,f;for(h=0,u=s;h<u;++h)d=h+i,f=n[d],c[h]={x:r.parse(me(f,a),d),y:o.parse(me(f,l),d)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,i){const s=this.chart,r=this._cachedMeta,o=n[t.axis],a={keys:id(s,!0),values:n._stacks[t.axis]};return rc(a,o,r.index,{mode:i})}updateRangeFromParsed(t,n,i,s){const r=i[n.axis];let o=r===null?NaN:r;const a=s&&i._stacks[n.axis];s&&a&&(s.values=a,o=rc(s,r,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,n){const i=this._cachedMeta,s=i._parsed,r=i._sorted&&t===i.iScale,o=s.length,a=this._getOtherScale(t),l=Ym(n,i,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:u}=Wm(a);let d,f;function g(){f=s[d];const p=f[a.axis];return!rt(f[t.axis])||h>p||u<p}for(d=0;d<o&&!(!g()&&(this.updateRangeFromParsed(c,t,f,l),r));++d);if(r){for(d=o-1;d>=0;--d)if(!g()){this.updateRangeFromParsed(c,t,f,l);break}}return c}getAllParsedValues(t){const n=this._cachedMeta._parsed,i=[];let s,r,o;for(s=0,r=n.length;s<r;++s)o=n[s][t.axis],rt(o)&&i.push(o);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,i=n.iScale,s=n.vScale,r=this.getParsed(t);return{label:i?""+i.getLabelForValue(r[i.axis]):"",value:s?""+s.getLabelForValue(r[s.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=zm(L(this.options.clip,jm(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,i=this._cachedMeta,s=i.data||[],r=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||s.length-a,c=this.options.drawActiveElementsOnTop;let h;for(i.dataset&&i.dataset.draw(t,r,a,l),h=a;h<a+l;++h){const u=s[h];u.hidden||(u.active&&c?o.push(u):u.draw(t,r))}for(h=0;h<o.length;++h)o[h].draw(t,r)}getStyle(t,n){const i=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,n,i){const s=this.getDataset();let r;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];r=o.$context||(o.$context=Gm(this.getContext(),t,o)),r.parsed=this.getParsed(t),r.raw=s.data[t],r.index=r.dataIndex=t}else r=this.$context||(this.$context=qm(this.chart.getContext(),this.index)),r.dataset=s,r.index=r.datasetIndex=this.index;return r.active=!!n,r.mode=i,r}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",i){const s=n==="active",r=this._cachedDataOpts,o=t+"-"+n,a=r[o],l=this.enableOptionSharing&&zt(i);if(a)return cc(a,l);const c=this.chart.config,h=c.datasetElementScopeKeys(this._type,t),u=s?[`${t}Hover`,"hover",t,""]:[t,""],d=c.getOptionScopes(this.getDataset(),h),f=Object.keys($.elements[t]),g=()=>this.getContext(i,s),p=c.resolveNamedOptions(d,f,g,u);return p.$shared&&(p.$shared=l,r[o]=Object.freeze(cc(p,l))),p}_resolveAnimations(t,n,i){const s=this.chart,r=this._cachedDataOpts,o=`animation-${n}`,a=r[o];if(a)return a;let l;if(s.options.animation!==!1){const h=this.chart.config,u=h.datasetAnimationScopeKeys(this._type,n),d=h.getOptionScopes(this.getDataset(),u);l=h.createResolver(d,this.getContext(t,i,n))}const c=new nd(s,l&&l.animations);return l&&l._cacheable&&(r[o]=Object.freeze(c)),c}getSharedOptions(t){if(!!t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||Xr(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const i=this.resolveDataElementOptions(t,n),s=this._sharedOptions,r=this.getSharedOptions(i),o=this.includeOptions(n,r)||r!==s;return this.updateSharedOptions(r,n,i),{sharedOptions:r,includeOptions:o}}updateElement(t,n,i,s){Xr(s)?Object.assign(t,i):this._resolveAnimations(n,s).update(t,i)}updateSharedOptions(t,n,i){t&&!Xr(n)&&this._resolveAnimations(void 0,n).update(t,i)}_setStyle(t,n,i,s){t.active=s;const r=this.getStyle(n,s);this._resolveAnimations(n,i,s).update(t,{options:!s&&this.getSharedOptions(r)||r})}removeHoverStyle(t,n,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,n,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,i=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const s=i.length,r=n.length,o=Math.min(r,s);o&&this.parse(0,o),r>s?this._insertElements(s,r-s,t):r<s&&this._removeElements(r,s-r)}_insertElements(t,n,i=!0){const s=this._cachedMeta,r=s.data,o=t+n;let a;const l=c=>{for(c.length+=n,a=c.length-1;a>=o;a--)c[a]=c[a-n]};for(l(r),a=t;a<o;++a)r[a]=new this.dataElementType;this._parsing&&l(s._parsed),this.parse(t,n),i&&this.updateElements(r,t,n,"reset")}updateElements(t,n,i,s){}_removeElements(t,n){const i=this._cachedMeta;if(this._parsing){const s=i._parsed.splice(t,n);i._stacked&&jn(i,s)}i.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,i,s]=t;this[n](i,s)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Ht.defaults={};Ht.prototype.datasetElementType=null;Ht.prototype.dataElementType=null;function Xm(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let i=[];for(let s=0,r=n.length;s<r;s++)i=i.concat(n[s].controller.getAllParsedValues(e));e._cache.$bar=Ou(i.sort((s,r)=>s-r))}return e._cache.$bar}function Qm(e){const t=e.iScale,n=Xm(t,e.type);let i=t._length,s,r,o,a;const l=()=>{o===32767||o===-32768||(zt(a)&&(i=Math.min(i,Math.abs(o-a)||i)),a=o)};for(s=0,r=n.length;s<r;++s)o=t.getPixelForValue(n[s]),l();for(a=void 0,s=0,r=t.ticks.length;s<r;++s)o=t.getPixelForTick(s),l();return i}function Jm(e,t,n,i){const s=n.barThickness;let r,o;return H(s)?(r=t.min*n.categoryPercentage,o=n.barPercentage):(r=s*i,o=1),{chunk:r/i,ratio:o,start:t.pixels[e]-r/2}}function Zm(e,t,n,i){const s=t.pixels,r=s[e];let o=e>0?s[e-1]:null,a=e<s.length-1?s[e+1]:null;const l=n.categoryPercentage;o===null&&(o=r-(a===null?t.end-t.start:a-r)),a===null&&(a=r+r-o);const c=r-(r-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/i,ratio:n.barPercentage,start:c}}function ty(e,t,n,i){const s=n.parse(e[0],i),r=n.parse(e[1],i),o=Math.min(s,r),a=Math.max(s,r);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),t[n.axis]=c,t._custom={barStart:l,barEnd:c,start:s,end:r,min:o,max:a}}function sd(e,t,n,i){return J(e)?ty(e,t,n,i):t[n.axis]=n.parse(e,i),t}function hc(e,t,n,i){const s=e.iScale,r=e.vScale,o=s.getLabels(),a=s===r,l=[];let c,h,u,d;for(c=n,h=n+i;c<h;++c)d=t[c],u={},u[s.axis]=a||s.parse(o[c],c),l.push(sd(d,u,r,c));return l}function Qr(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function ey(e,t,n){return e!==0?Yt(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function ny(e){let t,n,i,s,r;return e.horizontal?(t=e.base>e.x,n="left",i="right"):(t=e.base<e.y,n="bottom",i="top"),t?(s="end",r="start"):(s="start",r="end"),{start:n,end:i,reverse:t,top:s,bottom:r}}function iy(e,t,n,i){let s=t.borderSkipped;const r={};if(!s){e.borderSkipped=r;return}if(s===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:h}=ny(e);s==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===i?s=c:(n._bottom||0)===i?s=h:(r[uc(h,o,a,l)]=!0,s=c)),r[uc(s,o,a,l)]=!0,e.borderSkipped=r}function uc(e,t,n,i){return i?(e=sy(e,t,n),e=dc(e,n,t)):e=dc(e,t,n),e}function sy(e,t,n){return e===t?n:e===n?t:e}function dc(e,t,n){return e==="start"?t:e==="end"?n:e}function ry(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}class er extends Ht{parsePrimitiveData(t,n,i,s){return hc(t,n,i,s)}parseArrayData(t,n,i,s){return hc(t,n,i,s)}parseObjectData(t,n,i,s){const{iScale:r,vScale:o}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=r.axis==="x"?a:l,h=o.axis==="x"?a:l,u=[];let d,f,g,p;for(d=i,f=i+s;d<f;++d)p=n[d],g={},g[r.axis]=r.parse(me(p,c),d),u.push(sd(me(p,h),g,o,d));return u}updateRangeFromParsed(t,n,i,s){super.updateRangeFromParsed(t,n,i,s);const r=i._custom;r&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const n=this._cachedMeta,{iScale:i,vScale:s}=n,r=this.getParsed(t),o=r._custom,a=Qr(o)?"["+o.start+", "+o.end+"]":""+s.getLabelForValue(r[s.axis]);return{label:""+i.getLabelForValue(r[i.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,i,s){const r=s==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),h=this._getRuler(),{sharedOptions:u,includeOptions:d}=this._getSharedOptions(n,s);for(let f=n;f<n+i;f++){const g=this.getParsed(f),p=r||H(g[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(f),m=this._calculateBarIndexPixels(f,h),y=(g._stacks||{})[a.axis],b={horizontal:c,base:p.base,enableBorderRadius:!y||Qr(g._custom)||o===y._top||o===y._bottom,x:c?p.head:m.center,y:c?m.center:p.head,height:c?m.size:Math.abs(p.size),width:c?Math.abs(p.size):m.size};d&&(b.options=u||this.resolveDataElementOptions(f,t[f].active?"active":s));const _=b.options||t[f].options;iy(b,_,y,o),ry(b,_,h.ratio),this.updateElement(t[f],f,b,s)}}_getStacks(t,n){const{iScale:i}=this._cachedMeta,s=i.getMatchingVisibleMetas(this._type).filter(l=>l.controller.options.grouped),r=i.options.stacked,o=[],a=l=>{const c=l.controller.getParsed(n),h=c&&c[l.vScale.axis];if(H(h)||isNaN(h))return!0};for(const l of s)if(!(n!==void 0&&a(l))&&((r===!1||o.indexOf(l.stack)===-1||r===void 0&&l.stack===void 0)&&o.push(l.stack),l.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,n,i){const s=this._getStacks(t,i),r=n!==void 0?s.indexOf(n):-1;return r===-1?s.length-1:r}_getRuler(){const t=this.options,n=this._cachedMeta,i=n.iScale,s=[];let r,o;for(r=0,o=n.data.length;r<o;++r)s.push(i.getPixelForValue(this.getParsed(r)[i.axis],r));const a=t.barThickness;return{min:a||Qm(n),pixels:s,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:n,_stacked:i},options:{base:s,minBarLength:r}}=this,o=s||0,a=this.getParsed(t),l=a._custom,c=Qr(l);let h=a[n.axis],u=0,d=i?this.applyStack(n,a,i):h,f,g;d!==h&&(u=d-h,d=h),c&&(h=l.barStart,d=l.barEnd-l.barStart,h!==0&&Yt(h)!==Yt(l.barEnd)&&(u=0),u+=h);const p=!H(s)&&!c?s:u;let m=n.getPixelForValue(p);if(this.chart.getDataVisibility(t)?f=n.getPixelForValue(u+d):f=m,g=f-m,Math.abs(g)<r){g=ey(g,n,o)*r,h===o&&(m-=g/2);const y=n.getPixelForDecimal(0),b=n.getPixelForDecimal(1),_=Math.min(y,b),x=Math.max(y,b);m=Math.max(Math.min(m,x),_),f=m+g}if(m===n.getPixelForValue(o)){const y=Yt(g)*n.getLineWidthForValue(o)/2;m+=y,g-=y}return{size:g,base:m,head:f,center:f+g/2}}_calculateBarIndexPixels(t,n){const i=n.scale,s=this.options,r=s.skipNull,o=L(s.maxBarThickness,1/0);let a,l;if(n.grouped){const c=r?this._getStackCount(t):n.stackCount,h=s.barThickness==="flex"?Zm(t,n,s,c):Jm(t,n,s,c),u=this._getStackIndex(this.index,this._cachedMeta.stack,r?t:void 0);a=h.start+h.chunk*u+h.chunk/2,l=Math.min(o,h.chunk*h.ratio)}else a=i.getPixelForValue(this.getParsed(t)[i.axis],t),l=Math.min(o,n.min*n.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const t=this._cachedMeta,n=t.vScale,i=t.data,s=i.length;let r=0;for(;r<s;++r)this.getParsed(r)[n.axis]!==null&&i[r].draw(this._ctx)}}er.id="bar";er.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};er.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class nr extends Ht{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,n,i,s){const r=super.parsePrimitiveData(t,n,i,s);for(let o=0;o<r.length;o++)r[o]._custom=this.resolveDataElementOptions(o+i).radius;return r}parseArrayData(t,n,i,s){const r=super.parseArrayData(t,n,i,s);for(let o=0;o<r.length;o++){const a=n[i+o];r[o]._custom=L(a[2],this.resolveDataElementOptions(o+i).radius)}return r}parseObjectData(t,n,i,s){const r=super.parseObjectData(t,n,i,s);for(let o=0;o<r.length;o++){const a=n[i+o];r[o]._custom=L(a&&a.r&&+a.r,this.resolveDataElementOptions(o+i).radius)}return r}getMaxOverflow(){const t=this._cachedMeta.data;let n=0;for(let i=t.length-1;i>=0;--i)n=Math.max(n,t[i].size(this.resolveDataElementOptions(i))/2);return n>0&&n}getLabelAndValue(t){const n=this._cachedMeta,{xScale:i,yScale:s}=n,r=this.getParsed(t),o=i.getLabelForValue(r.x),a=s.getLabelForValue(r.y),l=r._custom;return{label:n.label,value:"("+o+", "+a+(l?", "+l:"")+")"}}update(t){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,t)}updateElements(t,n,i,s){const r=s==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(n,s),h=o.axis,u=a.axis;for(let d=n;d<n+i;d++){const f=t[d],g=!r&&this.getParsed(d),p={},m=p[h]=r?o.getPixelForDecimal(.5):o.getPixelForValue(g[h]),y=p[u]=r?a.getBasePixel():a.getPixelForValue(g[u]);p.skip=isNaN(m)||isNaN(y),c&&(p.options=l||this.resolveDataElementOptions(d,f.active?"active":s),r&&(p.options.radius=0)),this.updateElement(f,d,p,s)}}resolveDataElementOptions(t,n){const i=this.getParsed(t);let s=super.resolveDataElementOptions(t,n);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const r=s.radius;return n!=="active"&&(s.radius=0),s.radius+=L(i&&i._custom,r),s}}nr.id="bubble";nr.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};nr.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title(){return""}}}}};function oy(e,t,n){let i=1,s=1,r=0,o=0;if(t<Y){const a=e,l=a+t,c=Math.cos(a),h=Math.sin(a),u=Math.cos(l),d=Math.sin(l),f=(_,x,v)=>fi(_,a,l,!0)?1:Math.max(x,x*n,v,v*n),g=(_,x,v)=>fi(_,a,l,!0)?-1:Math.min(x,x*n,v,v*n),p=f(0,c,u),m=f(it,h,d),y=g(et,c,u),b=g(et+it,h,d);i=(p-y)/2,s=(m-b)/2,r=-(p+y)/2,o=-(m+b)/2}return{ratioX:i,ratioY:s,offsetX:r,offsetY:o}}class In extends Ht{constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){const i=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=i;else{let r=l=>+i[l];if(V(i[t])){const{key:l="value"}=this._parsing;r=c=>+me(i[c],l)}let o,a;for(o=t,a=t+n;o<a;++o)s._parsed[o]=r(o)}}_getRotation(){return Ut(this.options.rotation-90)}_getCircumference(){return Ut(this.options.circumference)}_getRotationExtents(){let t=Y,n=-Y;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)){const s=this.chart.getDatasetMeta(i).controller,r=s._getRotation(),o=s._getCircumference();t=Math.min(t,r),n=Math.max(n,r+o)}return{rotation:t,circumference:n-t}}update(t){const n=this.chart,{chartArea:i}=n,s=this._cachedMeta,r=s.data,o=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,a=Math.max((Math.min(i.width,i.height)-o)/2,0),l=Math.min(np(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:h,rotation:u}=this._getRotationExtents(),{ratioX:d,ratioY:f,offsetX:g,offsetY:p}=oy(u,h,l),m=(i.width-o)/d,y=(i.height-o)/f,b=Math.max(Math.min(m,y)/2,0),_=Au(this.options.radius,b),x=Math.max(_*l,0),v=(_-x)/this._getVisibleDatasetWeightTotal();this.offsetX=g*_,this.offsetY=p*_,s.total=this.calculateTotal(),this.outerRadius=_-v*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-v*c,0),this.updateElements(r,0,r.length,t)}_circumference(t,n){const i=this.options,s=this._cachedMeta,r=this._getCircumference();return n&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||s._parsed[t]===null||s.data[t].hidden?0:this.calculateCircumference(s._parsed[t]*r/Y)}updateElements(t,n,i,s){const r=s==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,h=(a.left+a.right)/2,u=(a.top+a.bottom)/2,d=r&&c.animateScale,f=d?0:this.innerRadius,g=d?0:this.outerRadius,{sharedOptions:p,includeOptions:m}=this._getSharedOptions(n,s);let y=this._getRotation(),b;for(b=0;b<n;++b)y+=this._circumference(b,r);for(b=n;b<n+i;++b){const _=this._circumference(b,r),x=t[b],v={x:h+this.offsetX,y:u+this.offsetY,startAngle:y,endAngle:y+_,circumference:_,outerRadius:g,innerRadius:f};m&&(v.options=p||this.resolveDataElementOptions(b,x.active?"active":s)),y+=_,this.updateElement(x,b,v,s)}}calculateTotal(){const t=this._cachedMeta,n=t.data;let i=0,s;for(s=0;s<n.length;s++){const r=t._parsed[s];r!==null&&!isNaN(r)&&this.chart.getDataVisibility(s)&&!n[s].hidden&&(i+=Math.abs(r))}return i}calculateCircumference(t){const n=this._cachedMeta.total;return n>0&&!isNaN(t)?Y*(Math.abs(t)/n):0}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart,s=i.data.labels||[],r=Pi(n._parsed[t],i.options.locale);return{label:s[t]||"",value:r}}getMaxBorderWidth(t){let n=0;const i=this.chart;let s,r,o,a,l;if(!t){for(s=0,r=i.data.datasets.length;s<r;++s)if(i.isDatasetVisible(s)){o=i.getDatasetMeta(s),t=o.data,a=o.controller;break}}if(!t)return 0;for(s=0,r=t.length;s<r;++s)l=a.resolveDataElementOptions(s),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let i=0,s=t.length;i<s;++i){const r=this.resolveDataElementOptions(i);n=Math.max(n,r.offset||0,r.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(n+=this._getRingWeight(i));return n}_getRingWeight(t){return Math.max(L(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}In.id="doughnut";In.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};In.descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"};In.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n}}=e.legend.options;return t.labels.map((i,s)=>{const o=e.getDatasetMeta(0).controller.getStyle(s);return{text:i,fillStyle:o.backgroundColor,strokeStyle:o.borderColor,lineWidth:o.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(s),index:s}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}},tooltip:{callbacks:{title(){return""},label(e){let t=e.label;const n=": "+e.formattedValue;return J(t)?(t=t.slice(),t[0]+=n):t+=n,t}}}}};class ir extends Ht{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:i,data:s=[],_dataset:r}=n,o=this.chart._animationsDisabled;let{start:a,count:l}=Lu(n,s,o);this._drawStart=a,this._drawCount=l,Nu(n)&&(a=0,l=s.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!r._decimated,i.points=s;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(i,void 0,{animated:!o,options:c},t),this.updateElements(s,a,l,t)}updateElements(t,n,i,s){const r=s==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:h,includeOptions:u}=this._getSharedOptions(n,s),d=o.axis,f=a.axis,{spanGaps:g,segment:p}=this.options,m=yn(g)?g:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||r||s==="none";let b=n>0&&this.getParsed(n-1);for(let _=n;_<n+i;++_){const x=t[_],v=this.getParsed(_),E=y?x:{},S=H(v[f]),D=E[d]=o.getPixelForValue(v[d],_),A=E[f]=r||S?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,v,l):v[f],_);E.skip=isNaN(D)||isNaN(A)||S,E.stop=_>0&&Math.abs(v[d]-b[d])>m,p&&(E.parsed=v,E.raw=c.data[_]),u&&(E.options=h||this.resolveDataElementOptions(_,x.active?"active":s)),y||this.updateElement(x,_,E,s),b=v}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,i=n.options&&n.options.borderWidth||0,s=t.data||[];if(!s.length)return i;const r=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(i,r,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}ir.id="line";ir.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};ir.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};class sr extends Ht{constructor(t,n){super(t,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart,s=i.data.labels||[],r=Pi(n._parsed[t].r,i.options.locale);return{label:s[t]||"",value:r}}parseObjectData(t,n,i,s){return Gu.bind(this)(t,n,i,s)}update(t){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,t)}getMinMax(){const t=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((i,s)=>{const r=this.getParsed(s).r;!isNaN(r)&&this.chart.getDataVisibility(s)&&(r<n.min&&(n.min=r),r>n.max&&(n.max=r))}),n}_updateRadius(){const t=this.chart,n=t.chartArea,i=t.options,s=Math.min(n.right-n.left,n.bottom-n.top),r=Math.max(s/2,0),o=Math.max(i.cutoutPercentage?r/100*i.cutoutPercentage:1,0),a=(r-o)/t.getVisibleDatasetCount();this.outerRadius=r-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(t,n,i,s){const r=s==="reset",o=this.chart,l=o.options.animation,c=this._cachedMeta.rScale,h=c.xCenter,u=c.yCenter,d=c.getIndexAngle(0)-.5*et;let f=d,g;const p=360/this.countVisibleElements();for(g=0;g<n;++g)f+=this._computeAngle(g,s,p);for(g=n;g<n+i;g++){const m=t[g];let y=f,b=f+this._computeAngle(g,s,p),_=o.getDataVisibility(g)?c.getDistanceFromCenterForValue(this.getParsed(g).r):0;f=b,r&&(l.animateScale&&(_=0),l.animateRotate&&(y=b=d));const x={x:h,y:u,innerRadius:0,outerRadius:_,startAngle:y,endAngle:b,options:this.resolveDataElementOptions(g,m.active?"active":s)};this.updateElement(m,g,x,s)}}countVisibleElements(){const t=this._cachedMeta;let n=0;return t.data.forEach((i,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&n++}),n}_computeAngle(t,n,i){return this.chart.getDataVisibility(t)?Ut(this.resolveDataElementOptions(t,n).angle||i):0}}sr.id="polarArea";sr.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};sr.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n}}=e.legend.options;return t.labels.map((i,s)=>{const o=e.getDatasetMeta(0).controller.getStyle(s);return{text:i,fillStyle:o.backgroundColor,strokeStyle:o.borderColor,lineWidth:o.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(s),index:s}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}},tooltip:{callbacks:{title(){return""},label(e){return e.chart.data.labels[e.dataIndex]+": "+e.formattedValue}}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class Da extends In{}Da.id="pie";Da.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class rr extends Ht{getLabelAndValue(t){const n=this._cachedMeta.vScale,i=this.getParsed(t);return{label:n.getLabels()[t],value:""+n.getLabelForValue(i[n.axis])}}parseObjectData(t,n,i,s){return Gu.bind(this)(t,n,i,s)}update(t){const n=this._cachedMeta,i=n.dataset,s=n.data||[],r=n.iScale.getLabels();if(i.points=s,t!=="resize"){const o=this.resolveDatasetElementOptions(t);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:r.length===s.length,options:o};this.updateElement(i,void 0,a,t)}this.updateElements(s,0,s.length,t)}updateElements(t,n,i,s){const r=this._cachedMeta.rScale,o=s==="reset";for(let a=n;a<n+i;a++){const l=t[a],c=this.resolveDataElementOptions(a,l.active?"active":s),h=r.getPointPositionForValue(a,this.getParsed(a).r),u=o?r.xCenter:h.x,d=o?r.yCenter:h.y,f={x:u,y:d,angle:h.angle,skip:isNaN(u)||isNaN(d),options:c};this.updateElement(l,a,f,s)}}}rr.id="radar";rr.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};rr.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class Wt{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(t){const{x:n,y:i}=this.getProps(["x","y"],t);return{x:n,y:i}}hasValue(){return yn(this.x)&&yn(this.y)}getProps(t,n){const i=this.$animations;if(!n||!i)return this;const s={};return t.forEach(r=>{s[r]=i[r]&&i[r].active()?i[r]._to:this[r]}),s}}Wt.defaults={};Wt.defaultRoutes=void 0;const rd={values(e){return J(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const i=this.chart.options.locale;let s,r=e;if(n.length>1){const c=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(c<1e-4||c>1e15)&&(s="scientific"),r=ay(e,n)}const o=jt(Math.abs(r)),a=Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:s,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),Pi(e,i,l)},logarithmic(e,t,n){if(e===0)return"0";const i=e/Math.pow(10,Math.floor(jt(e)));return i===1||i===2||i===5?rd.numeric.call(this,e,t,n):""}};function ay(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var or={formatters:rd};$.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:or.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}});$.route("scale.ticks","color","","color");$.route("scale.grid","color","","borderColor");$.route("scale.grid","borderColor","","borderColor");$.route("scale.title","color","","color");$.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"});$.describe("scales",{_fallback:"scale"});$.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"});function ly(e,t){const n=e.options.ticks,i=n.maxTicksLimit||cy(e),s=n.major.enabled?uy(t):[],r=s.length,o=s[0],a=s[r-1],l=[];if(r>i)return dy(t,l,s,r/i),l;const c=hy(s,t,i);if(r>0){let h,u;const d=r>1?Math.round((a-o)/(r-1)):null;for(ss(t,l,c,H(d)?0:o-d,o),h=0,u=r-1;h<u;h++)ss(t,l,c,s[h],s[h+1]);return ss(t,l,c,a,H(d)?t.length:a+d),l}return ss(t,l,c),l}function cy(e){const t=e.options.offset,n=e._tickSize(),i=e._length/n+(t?0:1),s=e._maxLength/n;return Math.floor(Math.min(i,s))}function hy(e,t,n){const i=fy(e),s=t.length/n;if(!i)return Math.max(s,1);const r=hp(i);for(let o=0,a=r.length-1;o<a;o++){const l=r[o];if(l>s)return l}return Math.max(s,1)}function uy(e){const t=[];let n,i;for(n=0,i=e.length;n<i;n++)e[n].major&&t.push(n);return t}function dy(e,t,n,i){let s=0,r=n[0],o;for(i=Math.ceil(i),o=0;o<e.length;o++)o===r&&(t.push(e[o]),s++,r=n[s*i])}function ss(e,t,n,i,s){const r=L(i,0),o=Math.min(L(s,e.length),e.length);let a=0,l,c,h;for(n=Math.ceil(n),s&&(l=s-i,n=l/Math.floor(l/n)),h=r;h<0;)a++,h=Math.round(r+a*n);for(c=Math.max(r,0);c<o;c++)c===h&&(t.push(e[c]),a++,h=Math.round(r+a*n))}function fy(e){const t=e.length;let n,i;if(t<2)return!1;for(i=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==i)return!1;return i}const gy=e=>e==="left"?"right":e==="right"?"left":e,fc=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n;function gc(e,t){const n=[],i=e.length/t,s=e.length;let r=0;for(;r<s;r+=i)n.push(e[Math.floor(r)]);return n}function py(e,t,n){const i=e.ticks.length,s=Math.min(t,i-1),r=e._startPixel,o=e._endPixel,a=1e-6;let l=e.getPixelForTick(s),c;if(!(n&&(i===1?c=Math.max(l-r,o-l):t===0?c=(e.getPixelForTick(1)-l)/2:c=(l-e.getPixelForTick(s-1))/2,l+=s<t?c:-c,l<r-a||l>o+a)))return l}function my(e,t){q(e,n=>{const i=n.gc,s=i.length/2;let r;if(s>t){for(r=0;r<s;++r)delete n.data[i[r]];i.splice(0,s)}})}function zn(e){return e.drawTicks?e.tickLength:0}function pc(e,t){if(!e.display)return 0;const n=dt(e.font,t),i=At(e.padding);return(J(e.text)?e.text.length:1)*n.lineHeight+i.height}function yy(e,t){return we(e,{scale:t,type:"scale"})}function by(e,t,n){return we(e,{tick:n,index:t,type:"tick"})}function vy(e,t,n){let i=va(e);return(n&&t!=="right"||!n&&t==="right")&&(i=gy(i)),i}function _y(e,t,n,i){const{top:s,left:r,bottom:o,right:a,chart:l}=e,{chartArea:c,scales:h}=l;let u=0,d,f,g;const p=o-s,m=a-r;if(e.isHorizontal()){if(f=Et(i,r,a),V(n)){const y=Object.keys(n)[0],b=n[y];g=h[y].getPixelForValue(b)+p-t}else n==="center"?g=(c.bottom+c.top)/2+p-t:g=fc(e,n,t);d=a-r}else{if(V(n)){const y=Object.keys(n)[0],b=n[y];f=h[y].getPixelForValue(b)-m+t}else n==="center"?f=(c.left+c.right)/2-m+t:f=fc(e,n,t);g=Et(i,o,s),u=n==="left"?-it:it}return{titleX:f,titleY:g,maxWidth:d,rotation:u}}class Ze extends Wt{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:i,_suggestedMax:s}=this;return t=$t(t,Number.POSITIVE_INFINITY),n=$t(n,Number.NEGATIVE_INFINITY),i=$t(i,Number.POSITIVE_INFINITY),s=$t(s,Number.NEGATIVE_INFINITY),{min:$t(t,i),max:$t(n,s),minDefined:rt(t),maxDefined:rt(n)}}getMinMax(t){let{min:n,max:i,minDefined:s,maxDefined:r}=this.getUserBounds(),o;if(s&&r)return{min:n,max:i};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,t),s||(n=Math.min(n,o.min)),r||(i=Math.max(i,o.max));return n=r&&n>i?i:n,i=s&&n>i?n:i,{min:$t(n,$t(i,n)),max:$t(i,$t(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Q(this.options.beforeUpdate,[this])}update(t,n,i){const{beginAtZero:s,grace:r,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Jp(this,r,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?gc(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=ly(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,i;this.isHorizontal()?(n=this.left,i=this.right):(n=this.top,i=this.bottom,t=!t),this._startPixel=n,this._endPixel=i,this._reversePixels=t,this._length=i-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Q(this.options.afterUpdate,[this])}beforeSetDimensions(){Q(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Q(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Q(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Q(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let i,s,r;for(i=0,s=t.length;i<s;i++)r=t[i],r.label=Q(n.callback,[r.value,i,t],this)}afterTickToLabelConversion(){Q(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Q(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,i=this.ticks.length,s=n.minRotation||0,r=n.maxRotation;let o=s,a,l,c;if(!this._isVisible()||!n.display||s>=r||i<=1||!this.isHorizontal()){this.labelRotation=s;return}const h=this._getLabelSizes(),u=h.widest.width,d=h.highest.height,f=pt(this.chart.width-u,0,this.maxWidth);a=t.offset?this.maxWidth/i:f/(i-1),u+6>a&&(a=f/(i-(t.offset?.5:1)),l=this.maxHeight-zn(t.grid)-n.padding-pc(t.title,this.chart.options.font),c=Math.sqrt(u*u+d*d),o=ya(Math.min(Math.asin(pt((h.highest.height+6)/a,-1,1)),Math.asin(pt(l/c,-1,1))-Math.asin(pt(d/c,-1,1)))),o=Math.max(s,Math.min(r,o))),this.labelRotation=o}afterCalculateLabelRotation(){Q(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Q(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:i,title:s,grid:r}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=pc(s,n.options.font);if(a?(t.width=this.maxWidth,t.height=zn(r)+l):(t.height=this.maxHeight,t.width=zn(r)+l),i.display&&this.ticks.length){const{first:c,last:h,widest:u,highest:d}=this._getLabelSizes(),f=i.padding*2,g=Ut(this.labelRotation),p=Math.cos(g),m=Math.sin(g);if(a){const y=i.mirror?0:m*u.width+p*d.height;t.height=Math.min(this.maxHeight,t.height+y+f)}else{const y=i.mirror?0:p*u.width+m*d.height;t.width=Math.min(this.maxWidth,t.width+y+f)}this._calculatePadding(c,h,m,p)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,i,s){const{ticks:{align:r,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,u=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,f=0;l?c?(d=s*t.width,f=i*n.height):(d=i*t.height,f=s*n.width):r==="start"?f=n.width:r==="end"?d=t.width:r!=="inner"&&(d=t.width/2,f=n.width/2),this.paddingLeft=Math.max((d-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((f-u+o)*this.width/(this.width-u),0)}else{let h=n.height/2,u=t.height/2;r==="start"?(h=0,u=t.height):r==="end"&&(h=n.height,u=0),this.paddingTop=h+o,this.paddingBottom=u+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Q(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,i;for(n=0,i=t.length;n<i;n++)H(t[n].label)&&(t.splice(n,1),i--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let i=this.ticks;n<i.length&&(i=gc(i,n)),this._labelSizes=t=this._computeLabelSizes(i,i.length)}return t}_computeLabelSizes(t,n){const{ctx:i,_longestTextCache:s}=this,r=[],o=[];let a=0,l=0,c,h,u,d,f,g,p,m,y,b,_;for(c=0;c<n;++c){if(d=t[c].label,f=this._resolveTickFontOptions(c),i.font=g=f.string,p=s[g]=s[g]||{data:{},gc:[]},m=f.lineHeight,y=b=0,!H(d)&&!J(d))y=Ms(i,p.data,p.gc,y,d),b=m;else if(J(d))for(h=0,u=d.length;h<u;++h)_=d[h],!H(_)&&!J(_)&&(y=Ms(i,p.data,p.gc,y,_),b+=m);r.push(y),o.push(b),a=Math.max(y,a),l=Math.max(b,l)}my(s,n);const x=r.indexOf(a),v=o.indexOf(l),E=S=>({width:r[S]||0,height:o[S]||0});return{first:E(0),last:E(n-1),widest:E(x),highest:E(v),widths:r,heights:o}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return fp(this._alignToPixels?De(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const i=n[t];return i.$context||(i.$context=by(this.getContext(),t,i))}return this.$context||(this.$context=yy(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=Ut(this.labelRotation),i=Math.abs(Math.cos(n)),s=Math.abs(Math.sin(n)),r=this._getLabelSizes(),o=t.autoSkipPadding||0,a=r?r.widest.width+o:0,l=r?r.highest.height+o:0;return this.isHorizontal()?l*i>a*s?a/i:l/s:l*s<a*i?l/i:a/s}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,i=this.chart,s=this.options,{grid:r,position:o}=s,a=r.offset,l=this.isHorizontal(),h=this.ticks.length+(a?1:0),u=zn(r),d=[],f=r.setContext(this.getContext()),g=f.drawBorder?f.borderWidth:0,p=g/2,m=function(P){return De(i,P,g)};let y,b,_,x,v,E,S,D,A,R,j,B;if(o==="top")y=m(this.bottom),E=this.bottom-u,D=y-p,R=m(t.top)+p,B=t.bottom;else if(o==="bottom")y=m(this.top),R=t.top,B=m(t.bottom)-p,E=y+p,D=this.top+u;else if(o==="left")y=m(this.right),v=this.right-u,S=y-p,A=m(t.left)+p,j=t.right;else if(o==="right")y=m(this.left),A=t.left,j=m(t.right)-p,v=y+p,S=this.left+u;else if(n==="x"){if(o==="center")y=m((t.top+t.bottom)/2+.5);else if(V(o)){const P=Object.keys(o)[0],at=o[P];y=m(this.chart.scales[P].getPixelForValue(at))}R=t.top,B=t.bottom,E=y+p,D=E+u}else if(n==="y"){if(o==="center")y=m((t.left+t.right)/2);else if(V(o)){const P=Object.keys(o)[0],at=o[P];y=m(this.chart.scales[P].getPixelForValue(at))}v=y-p,S=v-u,A=t.left,j=t.right}const ot=L(s.ticks.maxTicksLimit,h),Dt=Math.max(1,Math.ceil(h/ot));for(b=0;b<h;b+=Dt){const P=r.setContext(this.getContext(b)),at=P.lineWidth,st=P.color,Ae=P.borderDash||[],$r=P.borderDashOffset,rn=P.tickWidth,Ji=P.tickColor,on=P.tickBorderDash||[],Vn=P.tickBorderDashOffset;_=py(this,b,a),_!==void 0&&(x=De(i,_,at),l?v=S=A=j=x:E=D=R=B=x,d.push({tx1:v,ty1:E,tx2:S,ty2:D,x1:A,y1:R,x2:j,y2:B,width:at,color:st,borderDash:Ae,borderDashOffset:$r,tickWidth:rn,tickColor:Ji,tickBorderDash:on,tickBorderDashOffset:Vn}))}return this._ticksLength=h,this._borderValue=y,d}_computeLabelItems(t){const n=this.axis,i=this.options,{position:s,ticks:r}=i,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:h,mirror:u}=r,d=zn(i.grid),f=d+h,g=u?-h:f,p=-Ut(this.labelRotation),m=[];let y,b,_,x,v,E,S,D,A,R,j,B,ot="middle";if(s==="top")E=this.bottom-g,S=this._getXAxisLabelAlignment();else if(s==="bottom")E=this.top+g,S=this._getXAxisLabelAlignment();else if(s==="left"){const P=this._getYAxisLabelAlignment(d);S=P.textAlign,v=P.x}else if(s==="right"){const P=this._getYAxisLabelAlignment(d);S=P.textAlign,v=P.x}else if(n==="x"){if(s==="center")E=(t.top+t.bottom)/2+f;else if(V(s)){const P=Object.keys(s)[0],at=s[P];E=this.chart.scales[P].getPixelForValue(at)+f}S=this._getXAxisLabelAlignment()}else if(n==="y"){if(s==="center")v=(t.left+t.right)/2-f;else if(V(s)){const P=Object.keys(s)[0],at=s[P];v=this.chart.scales[P].getPixelForValue(at)}S=this._getYAxisLabelAlignment(d).textAlign}n==="y"&&(l==="start"?ot="top":l==="end"&&(ot="bottom"));const Dt=this._getLabelSizes();for(y=0,b=a.length;y<b;++y){_=a[y],x=_.label;const P=r.setContext(this.getContext(y));D=this.getPixelForTick(y)+r.labelOffset,A=this._resolveTickFontOptions(y),R=A.lineHeight,j=J(x)?x.length:1;const at=j/2,st=P.color,Ae=P.textStrokeColor,$r=P.textStrokeWidth;let rn=S;o?(v=D,S==="inner"&&(y===b-1?rn=this.options.reverse?"left":"right":y===0?rn=this.options.reverse?"right":"left":rn="center"),s==="top"?c==="near"||p!==0?B=-j*R+R/2:c==="center"?B=-Dt.highest.height/2-at*R+R:B=-Dt.highest.height+R/2:c==="near"||p!==0?B=R/2:c==="center"?B=Dt.highest.height/2-at*R:B=Dt.highest.height-j*R,u&&(B*=-1)):(E=D,B=(1-j)*R/2);let Ji;if(P.showLabelBackdrop){const on=At(P.backdropPadding),Vn=Dt.heights[y],jr=Dt.widths[y];let zr=E+B-on.top,Ur=v-on.left;switch(ot){case"middle":zr-=Vn/2;break;case"bottom":zr-=Vn;break}switch(S){case"center":Ur-=jr/2;break;case"right":Ur-=jr;break}Ji={left:Ur,top:zr,width:jr+on.width,height:Vn+on.height,color:P.backdropColor}}m.push({rotation:p,label:x,font:A,color:st,strokeColor:Ae,strokeWidth:$r,textOffset:B,textAlign:rn,textBaseline:ot,translation:[v,E],backdrop:Ji})}return m}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-Ut(this.labelRotation))return t==="top"?"left":"right";let s="center";return n.align==="start"?s="left":n.align==="end"?s="right":n.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:i,mirror:s,padding:r}}=this.options,o=this._getLabelSizes(),a=t+r,l=o.widest.width;let c,h;return n==="left"?s?(h=this.right+r,i==="near"?c="left":i==="center"?(c="center",h+=l/2):(c="right",h+=l)):(h=this.right-a,i==="near"?c="right":i==="center"?(c="center",h-=l/2):(c="left",h=this.left)):n==="right"?s?(h=this.left+r,i==="near"?c="right":i==="center"?(c="center",h-=l/2):(c="left",h-=l)):(h=this.left+a,i==="near"?c="left":i==="center"?(c="center",h+=l/2):(c="right",h=this.right)):c="right",{textAlign:c,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:i,top:s,width:r,height:o}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(i,s,r,o),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const s=this.ticks.findIndex(r=>r.value===t);return s>=0?n.setContext(this.getContext(s)).lineWidth:0}drawGrid(t){const n=this.options.grid,i=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,o;const a=(l,c,h)=>{!h.width||!h.color||(i.save(),i.lineWidth=h.width,i.strokeStyle=h.color,i.setLineDash(h.borderDash||[]),i.lineDashOffset=h.borderDashOffset,i.beginPath(),i.moveTo(l.x,l.y),i.lineTo(c.x,c.y),i.stroke(),i.restore())};if(n.display)for(r=0,o=s.length;r<o;++r){const l=s[r];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{grid:i}}=this,s=i.setContext(this.getContext()),r=i.drawBorder?s.borderWidth:0;if(!r)return;const o=i.setContext(this.getContext(0)).lineWidth,a=this._borderValue;let l,c,h,u;this.isHorizontal()?(l=De(t,this.left,r)-r/2,c=De(t,this.right,o)+o/2,h=u=a):(h=De(t,this.top,r)-r/2,u=De(t,this.bottom,o)+o/2,l=c=a),n.save(),n.lineWidth=s.borderWidth,n.strokeStyle=s.borderColor,n.beginPath(),n.moveTo(l,h),n.lineTo(c,u),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const i=this.ctx,s=this._computeLabelArea();s&&Js(i,s);const r=this._labelItems||(this._labelItems=this._computeLabelItems(t));let o,a;for(o=0,a=r.length;o<a;++o){const l=r[o],c=l.font,h=l.label;l.backdrop&&(i.fillStyle=l.backdrop.color,i.fillRect(l.backdrop.left,l.backdrop.top,l.backdrop.width,l.backdrop.height));let u=l.textOffset;He(i,h,0,u,c,l)}s&&Zs(i)}drawTitle(){const{ctx:t,options:{position:n,title:i,reverse:s}}=this;if(!i.display)return;const r=dt(i.font),o=At(i.padding),a=i.align;let l=r.lineHeight/2;n==="bottom"||n==="center"||V(n)?(l+=o.bottom,J(i.text)&&(l+=r.lineHeight*(i.text.length-1))):l+=o.top;const{titleX:c,titleY:h,maxWidth:u,rotation:d}=_y(this,l,n,a);He(t,i.text,0,0,r,{color:i.color,maxWidth:u,rotation:d,textAlign:vy(a,n,s),textBaseline:"middle",translation:[c,h]})}draw(t){!this._isVisible()||(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,i=L(t.grid&&t.grid.z,-1);return!this._isVisible()||this.draw!==Ze.prototype.draw?[{z:n,draw:s=>{this.draw(s)}}]:[{z:i,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i+1,draw:()=>{this.drawBorder()}},{z:n,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",s=[];let r,o;for(r=0,o=n.length;r<o;++r){const a=n[r];a[i]===this.id&&(!t||a.type===t)&&s.push(a)}return s}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return dt(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class rs{constructor(t,n,i){this.type=t,this.scope=n,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let i;Sy(n)&&(i=this.register(n));const s=this.items,r=t.id,o=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in s||(s[r]=t,xy(t,o,i),this.override&&$.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const n=this.items,i=t.id,s=this.scope;i in n&&delete n[i],s&&i in $[s]&&(delete $[s][i],this.override&&delete Ue[i])}}function xy(e,t,n){const i=di(Object.create(null),[n?$.get(n):{},$.get(t),e.defaults]);$.set(t,i),e.defaultRoutes&&wy(t,e.defaultRoutes),e.descriptors&&$.describe(t,e.descriptors)}function wy(e,t){Object.keys(t).forEach(n=>{const i=n.split("."),s=i.pop(),r=[e].concat(i).join("."),o=t[n].split("."),a=o.pop(),l=o.join(".");$.route(r,s,l,a)})}function Sy(e){return"id"in e&&"defaults"in e}class Ey{constructor(){this.controllers=new rs(Ht,"datasets",!0),this.elements=new rs(Wt,"elements"),this.plugins=new rs(Object,"plugins"),this.scales=new rs(Ze,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,i){[...n].forEach(s=>{const r=i||this._getRegistryForType(s);i||r.isForType(s)||r===this.plugins&&s.id?this._exec(t,r,s):q(s,o=>{const a=i||this._getRegistryForType(o);this._exec(t,a,o)})})}_exec(t,n,i){const s=ma(t);Q(i["before"+s],[],i),n[t](i),Q(i["after"+s],[],i)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const i=this._typedRegistries[n];if(i.isForType(t))return i}return this.plugins}_get(t,n,i){const s=n.get(t);if(s===void 0)throw new Error('"'+t+'" is not a registered '+i+".");return s}}var Gt=new Ey;class ar extends Ht{update(t){const n=this._cachedMeta,{data:i=[]}=n,s=this.chart._animationsDisabled;let{start:r,count:o}=Lu(n,i,s);if(this._drawStart=r,this._drawCount=o,Nu(n)&&(r=0,o=i.length),this.options.showLine){const{dataset:a,_dataset:l}=n;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=i;const c=this.resolveDatasetElementOptions(t);c.segment=this.options.segment,this.updateElement(a,void 0,{animated:!s,options:c},t)}this.updateElements(i,r,o,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=Gt.getElement("line")),super.addElements()}updateElements(t,n,i,s){const r=s==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,h=this.resolveDataElementOptions(n,s),u=this.getSharedOptions(h),d=this.includeOptions(s,u),f=o.axis,g=a.axis,{spanGaps:p,segment:m}=this.options,y=yn(p)?p:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||r||s==="none";let _=n>0&&this.getParsed(n-1);for(let x=n;x<n+i;++x){const v=t[x],E=this.getParsed(x),S=b?v:{},D=H(E[g]),A=S[f]=o.getPixelForValue(E[f],x),R=S[g]=r||D?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,E,l):E[g],x);S.skip=isNaN(A)||isNaN(R)||D,S.stop=x>0&&Math.abs(E[f]-_[f])>y,m&&(S.parsed=E,S.raw=c.data[x]),d&&(S.options=u||this.resolveDataElementOptions(x,v.active?"active":s)),b||this.updateElement(v,x,S,s),_=E}this.updateSharedOptions(u,s,h)}getMaxOverflow(){const t=this._cachedMeta,n=t.data||[];if(!this.options.showLine){let a=0;for(let l=n.length-1;l>=0;--l)a=Math.max(a,n[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const i=t.dataset,s=i.options&&i.options.borderWidth||0;if(!n.length)return s;const r=n[0].size(this.resolveDataElementOptions(0)),o=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(s,r,o)/2}}ar.id="scatter";ar.defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};ar.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title(){return""},label(e){return"("+e.label+", "+e.formattedValue+")"}}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var Ty=Object.freeze({__proto__:null,BarController:er,BubbleController:nr,DoughnutController:In,LineController:ir,PolarAreaController:sr,PieController:Da,RadarController:rr,ScatterController:ar});function Me(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Mo{constructor(t){this.options=t||{}}init(t){}formats(){return Me()}parse(t,n){return Me()}format(t,n){return Me()}add(t,n,i){return Me()}diff(t,n,i){return Me()}startOf(t,n,i){return Me()}endOf(t,n){return Me()}}Mo.override=function(e){Object.assign(Mo.prototype,e)};var Cy={_date:Mo};function Ay(e,t,n,i){const{controller:s,data:r,_sorted:o}=e,a=s._cachedMeta.iScale;if(a&&t===a.axis&&t!=="r"&&o&&r.length){const l=a._reversePixels?gp:se;if(i){if(s._sharedOptions){const c=r[0],h=typeof c.getRange=="function"&&c.getRange(t);if(h){const u=l(r,t,n-h),d=l(r,t,n+h);return{lo:u.lo,hi:d.hi}}}}else return l(r,t,n)}return{lo:0,hi:r.length-1}}function Ri(e,t,n,i,s){const r=e.getSortedVisibleDatasetMetas(),o=n[t];for(let a=0,l=r.length;a<l;++a){const{index:c,data:h}=r[a],{lo:u,hi:d}=Ay(r[a],t,o,s);for(let f=u;f<=d;++f){const g=h[f];g.skip||i(g,c,f)}}}function Dy(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(i,s){const r=t?Math.abs(i.x-s.x):0,o=n?Math.abs(i.y-s.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))}}function Jr(e,t,n,i,s){const r=[];return!s&&!e.isPointInArea(t)||Ri(e,n,t,function(a,l,c){!s&&!gi(a,e.chartArea,0)||a.inRange(t.x,t.y,i)&&r.push({element:a,datasetIndex:l,index:c})},!0),r}function My(e,t,n,i){let s=[];function r(o,a,l){const{startAngle:c,endAngle:h}=o.getProps(["startAngle","endAngle"],i),{angle:u}=Iu(o,{x:t.x,y:t.y});fi(u,c,h)&&s.push({element:o,datasetIndex:a,index:l})}return Ri(e,n,t,r),s}function Iy(e,t,n,i,s,r){let o=[];const a=Dy(n);let l=Number.POSITIVE_INFINITY;function c(h,u,d){const f=h.inRange(t.x,t.y,s);if(i&&!f)return;const g=h.getCenterPoint(s);if(!(!!r||e.isPointInArea(g))&&!f)return;const m=a(t,g);m<l?(o=[{element:h,datasetIndex:u,index:d}],l=m):m===l&&o.push({element:h,datasetIndex:u,index:d})}return Ri(e,n,t,c),o}function Zr(e,t,n,i,s,r){return!r&&!e.isPointInArea(t)?[]:n==="r"&&!i?My(e,t,n,s):Iy(e,t,n,i,s,r)}function mc(e,t,n,i,s){const r=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return Ri(e,n,t,(l,c,h)=>{l[o](t[n],s)&&(r.push({element:l,datasetIndex:c,index:h}),a=a||l.inRange(t.x,t.y,s))}),i&&!a?[]:r}var ky={evaluateInteractionItems:Ri,modes:{index(e,t,n,i){const s=Ie(t,e),r=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?Jr(e,s,r,i,o):Zr(e,s,r,!1,i,o),l=[];return a.length?(e.getSortedVisibleDatasetMetas().forEach(c=>{const h=a[0].index,u=c.data[h];u&&!u.skip&&l.push({element:u,datasetIndex:c.index,index:h})}),l):[]},dataset(e,t,n,i){const s=Ie(t,e),r=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?Jr(e,s,r,i,o):Zr(e,s,r,!1,i,o);if(a.length>0){const l=a[0].datasetIndex,c=e.getDatasetMeta(l).data;a=[];for(let h=0;h<c.length;++h)a.push({element:c[h],datasetIndex:l,index:h})}return a},point(e,t,n,i){const s=Ie(t,e),r=n.axis||"xy",o=n.includeInvisible||!1;return Jr(e,s,r,i,o)},nearest(e,t,n,i){const s=Ie(t,e),r=n.axis||"xy",o=n.includeInvisible||!1;return Zr(e,s,r,n.intersect,i,o)},x(e,t,n,i){const s=Ie(t,e);return mc(e,s,"x",n.intersect,i)},y(e,t,n,i){const s=Ie(t,e);return mc(e,s,"y",n.intersect,i)}}};const od=["left","top","right","bottom"];function Un(e,t){return e.filter(n=>n.pos===t)}function yc(e,t){return e.filter(n=>od.indexOf(n.pos)===-1&&n.box.axis===t)}function Hn(e,t){return e.sort((n,i)=>{const s=t?i:n,r=t?n:i;return s.weight===r.weight?s.index-r.index:s.weight-r.weight})}function Oy(e){const t=[];let n,i,s,r,o,a;for(n=0,i=(e||[]).length;n<i;++n)s=e[n],{position:r,options:{stack:o,stackWeight:a=1}}=s,t.push({index:n,box:s,pos:r,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&r+o,stackWeight:a});return t}function Py(e){const t={};for(const n of e){const{stack:i,pos:s,stackWeight:r}=n;if(!i||!od.includes(s))continue;const o=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=r}return t}function Ry(e,t){const n=Py(e),{vBoxMaxWidth:i,hBoxMaxHeight:s}=t;let r,o,a;for(r=0,o=e.length;r<o;++r){a=e[r];const{fullSize:l}=a.box,c=n[a.stack],h=c&&a.stackWeight/c.weight;a.horizontal?(a.width=h?h*i:l&&t.availableWidth,a.height=s):(a.width=i,a.height=h?h*s:l&&t.availableHeight)}return n}function Ly(e){const t=Oy(e),n=Hn(t.filter(c=>c.box.fullSize),!0),i=Hn(Un(t,"left"),!0),s=Hn(Un(t,"right")),r=Hn(Un(t,"top"),!0),o=Hn(Un(t,"bottom")),a=yc(t,"x"),l=yc(t,"y");return{fullSize:n,leftAndTop:i.concat(r),rightAndBottom:s.concat(l).concat(o).concat(a),chartArea:Un(t,"chartArea"),vertical:i.concat(s).concat(l),horizontal:r.concat(o).concat(a)}}function bc(e,t,n,i){return Math.max(e[n],t[n])+Math.max(e[i],t[i])}function ad(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function Ny(e,t,n,i){const{pos:s,box:r}=n,o=e.maxPadding;if(!V(s)){n.size&&(e[s]-=n.size);const u=i[n.stack]||{size:0,count:1};u.size=Math.max(u.size,n.horizontal?r.height:r.width),n.size=u.size/u.count,e[s]+=n.size}r.getPadding&&ad(o,r.getPadding());const a=Math.max(0,t.outerWidth-bc(o,e,"left","right")),l=Math.max(0,t.outerHeight-bc(o,e,"top","bottom")),c=a!==e.w,h=l!==e.h;return e.w=a,e.h=l,n.horizontal?{same:c,other:h}:{same:h,other:c}}function Fy(e){const t=e.maxPadding;function n(i){const s=Math.max(t[i]-e[i],0);return e[i]+=s,s}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function By(e,t){const n=t.maxPadding;function i(s){const r={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{r[o]=Math.max(t[o],n[o])}),r}return i(e?["left","right"]:["top","bottom"])}function Qn(e,t,n,i){const s=[];let r,o,a,l,c,h;for(r=0,o=e.length,c=0;r<o;++r){a=e[r],l=a.box,l.update(a.width||t.w,a.height||t.h,By(a.horizontal,t));const{same:u,other:d}=Ny(t,n,a,i);c|=u&&s.length,h=h||d,l.fullSize||s.push(a)}return c&&Qn(s,t,n,i)||h}function os(e,t,n,i,s){e.top=n,e.left=t,e.right=t+i,e.bottom=n+s,e.width=i,e.height=s}function vc(e,t,n,i){const s=n.padding;let{x:r,y:o}=t;for(const a of e){const l=a.box,c=i[a.stack]||{count:1,placed:0,weight:1},h=a.stackWeight/c.weight||1;if(a.horizontal){const u=t.w*h,d=c.size||l.height;zt(c.start)&&(o=c.start),l.fullSize?os(l,s.left,o,n.outerWidth-s.right-s.left,d):os(l,t.left+c.placed,o,u,d),c.start=o,c.placed+=u,o=l.bottom}else{const u=t.h*h,d=c.size||l.width;zt(c.start)&&(r=c.start),l.fullSize?os(l,r,s.top,d,n.outerHeight-s.bottom-s.top):os(l,r,t.top+c.placed,d,u),c.start=r,c.placed+=u,r=l.right}}t.x=r,t.y=o}$.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var Tt={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,i){if(!e)return;const s=At(e.options.layout.padding),r=Math.max(t-s.width,0),o=Math.max(n-s.height,0),a=Ly(e.boxes),l=a.vertical,c=a.horizontal;q(e.boxes,p=>{typeof p.beforeLayout=="function"&&p.beforeLayout()});const h=l.reduce((p,m)=>m.box.options&&m.box.options.display===!1?p:p+1,0)||1,u=Object.freeze({outerWidth:t,outerHeight:n,padding:s,availableWidth:r,availableHeight:o,vBoxMaxWidth:r/2/h,hBoxMaxHeight:o/2}),d=Object.assign({},s);ad(d,At(i));const f=Object.assign({maxPadding:d,w:r,h:o,x:s.left,y:s.top},s),g=Ry(l.concat(c),u);Qn(a.fullSize,f,u,g),Qn(l,f,u,g),Qn(c,f,u,g)&&Qn(l,f,u,g),Fy(f),vc(a.leftAndTop,f,u,g),f.x+=f.w,f.y+=f.h,vc(a.rightAndBottom,f,u,g),e.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},q(a.chartArea,p=>{const m=p.box;Object.assign(m,e.chartArea),m.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class ld{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,i){}removeEventListener(t,n,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,i,s){return n=Math.max(0,n||t.width),i=i||t.height,{width:n,height:Math.max(0,s?Math.floor(n/s):i)}}isAttached(t){return!0}updateConfig(t){}}class Vy extends ld{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const vs="$chartjs",$y={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},_c=e=>e===null||e==="";function jy(e,t){const n=e.style,i=e.getAttribute("height"),s=e.getAttribute("width");if(e[vs]={initial:{height:i,width:s,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",_c(s)){const r=Jl(e,"width");r!==void 0&&(e.width=r)}if(_c(i))if(e.style.height==="")e.height=e.width/(t||2);else{const r=Jl(e,"height");r!==void 0&&(e.height=r)}return e}const cd=xm?{passive:!0}:!1;function zy(e,t,n){e.addEventListener(t,n,cd)}function Uy(e,t,n){e.canvas.removeEventListener(t,n,cd)}function Hy(e,t){const n=$y[e.type]||e.type,{x:i,y:s}=Ie(e,t);return{type:n,chart:t,native:e,x:i!==void 0?i:null,y:s!==void 0?s:null}}function ks(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function Wy(e,t,n){const i=e.canvas,s=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||ks(a.addedNodes,i),o=o&&!ks(a.removedNodes,i);o&&n()});return s.observe(document,{childList:!0,subtree:!0}),s}function Ky(e,t,n){const i=e.canvas,s=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||ks(a.removedNodes,i),o=o&&!ks(a.addedNodes,i);o&&n()});return s.observe(document,{childList:!0,subtree:!0}),s}const mi=new Map;let xc=0;function hd(){const e=window.devicePixelRatio;e!==xc&&(xc=e,mi.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function qy(e,t){mi.size||window.addEventListener("resize",hd),mi.set(e,t)}function Gy(e){mi.delete(e),mi.size||window.removeEventListener("resize",hd)}function Yy(e,t,n){const i=e.canvas,s=i&&Aa(i);if(!s)return;const r=Ru((a,l)=>{const c=s.clientWidth;n(a,l),c<s.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,h=l.contentRect.height;c===0&&h===0||r(c,h)});return o.observe(s),qy(e,r),o}function to(e,t,n){n&&n.disconnect(),t==="resize"&&Gy(e)}function Xy(e,t,n){const i=e.canvas,s=Ru(r=>{e.ctx!==null&&n(Hy(r,e))},e,r=>{const o=r[0];return[o,o.offsetX,o.offsetY]});return zy(i,t,s),s}class Qy extends ld{acquireContext(t,n){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(jy(t,n),i):null}releaseContext(t){const n=t.canvas;if(!n[vs])return!1;const i=n[vs].initial;["height","width"].forEach(r=>{const o=i[r];H(o)?n.removeAttribute(r):n.setAttribute(r,o)});const s=i.style||{};return Object.keys(s).forEach(r=>{n.style[r]=s[r]}),n.width=n.width,delete n[vs],!0}addEventListener(t,n,i){this.removeEventListener(t,n);const s=t.$proxies||(t.$proxies={}),o={attach:Wy,detach:Ky,resize:Yy}[n]||Xy;s[n]=o(t,n,i)}removeEventListener(t,n){const i=t.$proxies||(t.$proxies={}),s=i[n];if(!s)return;({attach:to,detach:to,resize:to}[n]||Uy)(t,n,s),i[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,i,s){return _m(t,n,i,s)}isAttached(t){const n=Aa(t);return!!(n&&n.isConnected)}}function Jy(e){return!Xu()||typeof OffscreenCanvas!="undefined"&&e instanceof OffscreenCanvas?Vy:Qy}class Zy{constructor(){this._init=[]}notify(t,n,i,s){n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const r=s?this._descriptors(t).filter(s):this._descriptors(t),o=this._notify(r,t,n,i);return n==="afterDestroy"&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall")),o}_notify(t,n,i,s){s=s||{};for(const r of t){const o=r.plugin,a=o[i],l=[n,s,r.options];if(Q(a,l,o)===!1&&s.cancelable)return!1}return!0}invalidate(){H(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const i=t&&t.config,s=L(i.options&&i.options.plugins,{}),r=tb(i);return s===!1&&!n?[]:nb(t,r,s,n)}_notifyStateChanges(t){const n=this._oldCache||[],i=this._cache,s=(r,o)=>r.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(s(n,i),t,"stop"),this._notify(s(i,n),t,"start")}}function tb(e){const t={},n=[],i=Object.keys(Gt.plugins.items);for(let r=0;r<i.length;r++)n.push(Gt.getPlugin(i[r]));const s=e.plugins||[];for(let r=0;r<s.length;r++){const o=s[r];n.indexOf(o)===-1&&(n.push(o),t[o.id]=!0)}return{plugins:n,localIds:t}}function eb(e,t){return!t&&e===!1?null:e===!0?{}:e}function nb(e,{plugins:t,localIds:n},i,s){const r=[],o=e.getContext();for(const a of t){const l=a.id,c=eb(i[l],s);c!==null&&r.push({plugin:a,options:ib(e.config,{plugin:a,local:n[l]},c,o)})}return r}function ib(e,{plugin:t,local:n},i,s){const r=e.pluginScopeKeys(t),o=e.getOptionScopes(i,r);return n&&t.defaults&&o.push(t.defaults),e.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Io(e,t){const n=$.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function sb(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function rb(e,t){return e===t?"_index_":"_value_"}function ob(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function ko(e,t){return e==="x"||e==="y"?e:t.axis||ob(t.position)||e.charAt(0).toLowerCase()}function ab(e,t){const n=Ue[e.type]||{scales:{}},i=t.scales||{},s=Io(e.type,t),r=Object.create(null),o=Object.create(null);return Object.keys(i).forEach(a=>{const l=i[a];if(!V(l))return console.error(`Invalid scale configuration for scale: ${a}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const c=ko(a,l),h=rb(c,s),u=n.scales||{};r[c]=r[c]||a,o[a]=ti(Object.create(null),[{axis:c},l,u[c],u[h]])}),e.data.datasets.forEach(a=>{const l=a.type||e.type,c=a.indexAxis||Io(l,t),u=(Ue[l]||{}).scales||{};Object.keys(u).forEach(d=>{const f=sb(d,c),g=a[f+"AxisID"]||r[f]||f;o[g]=o[g]||Object.create(null),ti(o[g],[{axis:f},i[g],u[d]])})}),Object.keys(o).forEach(a=>{const l=o[a];ti(l,[$.scales[l.type],$.scale])}),o}function ud(e){const t=e.options||(e.options={});t.plugins=L(t.plugins,{}),t.scales=ab(e,t)}function dd(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function lb(e){return e=e||{},e.data=dd(e.data),ud(e),e}const wc=new Map,fd=new Set;function as(e,t){let n=wc.get(e);return n||(n=t(),wc.set(e,n),fd.add(n)),n}const Wn=(e,t,n)=>{const i=me(t,n);i!==void 0&&e.add(i)};class cb{constructor(t){this._config=lb(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=dd(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),ud(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return as(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return as(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return as(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,i=this.type;return as(`${i}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const i=this._scopeCache;let s=i.get(t);return(!s||n)&&(s=new Map,i.set(t,s)),s}getOptionScopes(t,n,i){const{options:s,type:r}=this,o=this._cachedScopes(t,i),a=o.get(n);if(a)return a;const l=new Set;n.forEach(h=>{t&&(l.add(t),h.forEach(u=>Wn(l,t,u))),h.forEach(u=>Wn(l,s,u)),h.forEach(u=>Wn(l,Ue[r]||{},u)),h.forEach(u=>Wn(l,$,u)),h.forEach(u=>Wn(l,Ao,u))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),fd.has(n)&&o.set(n,c),c}chartOptionScopes(){const{options:t,type:n}=this;return[t,Ue[n]||{},$.datasets[n]||{},{type:n},$,Ao]}resolveNamedOptions(t,n,i,s=[""]){const r={$shared:!0},{resolver:o,subPrefixes:a}=Sc(this._resolverCache,t,s);let l=o;if(ub(o,n)){r.$shared=!1,i=ye(i)?i():i;const c=this.createResolver(t,i,a);l=bn(o,i,c)}for(const c of n)r[c]=l[c];return r}createResolver(t,n,i=[""],s){const{resolver:r}=Sc(this._resolverCache,t,i);return V(n)?bn(r,n,void 0,s):r}}function Sc(e,t,n){let i=e.get(t);i||(i=new Map,e.set(t,i));const s=n.join();let r=i.get(s);return r||(r={resolver:Ea(t,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},i.set(s,r)),r}const hb=e=>V(e)&&Object.getOwnPropertyNames(e).reduce((t,n)=>t||ye(e[n]),!1);function ub(e,t){const{isScriptable:n,isIndexable:i}=Hu(e);for(const s of t){const r=n(s),o=i(s),a=(o||r)&&e[s];if(r&&(ye(a)||hb(a))||o&&J(a))return!0}return!1}var db="3.9.1";const fb=["top","bottom","left","right","chartArea"];function Ec(e,t){return e==="top"||e==="bottom"||fb.indexOf(e)===-1&&t==="x"}function Tc(e,t){return function(n,i){return n[e]===i[e]?n[t]-i[t]:n[e]-i[e]}}function Cc(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),Q(n&&n.onComplete,[e],t)}function gb(e){const t=e.chart,n=t.options.animation;Q(n&&n.onProgress,[e],t)}function gd(e){return Xu()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const Os={},pd=e=>{const t=gd(e);return Object.values(Os).filter(n=>n.canvas===t).pop()};function pb(e,t,n){const i=Object.keys(e);for(const s of i){const r=+s;if(r>=t){const o=e[s];delete e[s],(n>0||r>t)&&(e[r+n]=o)}}}function mb(e,t,n,i){return!n||e.type==="mouseout"?null:i?t:e}class lr{constructor(t,n){const i=this.config=new cb(n),s=gd(t),r=pd(s);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const o=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||Jy(s)),this.platform.updateConfig(i);const a=this.platform.acquireContext(s,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,h=l&&l.width;if(this.id=ep(),this.ctx=a,this.canvas=l,this.width=h,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Zy,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=yp(u=>this.update(u),o.resizeDelay||0),this._dataChanges=[],Os[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Zt.listen(this,"complete",Cc),Zt.listen(this,"progress",gb),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:i,height:s,_aspectRatio:r}=this;return H(t)?n&&r?r:s?i/s:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Ql(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Gl(this.canvas,this.ctx),this}stop(){return Zt.stop(this),this}resize(t,n){Zt.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const i=this.options,s=this.canvas,r=i.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,t,n,r),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,Ql(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Q(i.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};q(n,(i,s)=>{i.id=s})}buildOrUpdateScales(){const t=this.options,n=t.scales,i=this.scales,s=Object.keys(i).reduce((o,a)=>(o[a]=!1,o),{});let r=[];n&&(r=r.concat(Object.keys(n).map(o=>{const a=n[o],l=ko(o,a),c=l==="r",h=l==="x";return{options:a,dposition:c?"chartArea":h?"bottom":"left",dtype:c?"radialLinear":h?"category":"linear"}}))),q(r,o=>{const a=o.options,l=a.id,c=ko(l,a),h=L(a.type,o.dtype);(a.position===void 0||Ec(a.position,c)!==Ec(o.dposition))&&(a.position=o.dposition),s[l]=!0;let u=null;if(l in i&&i[l].type===h)u=i[l];else{const d=Gt.getScale(h);u=new d({id:l,type:h,ctx:this.ctx,chart:this}),i[u.id]=u}u.init(a,t)}),q(s,(o,a)=>{o||delete i[a]}),q(i,o=>{Tt.configure(this,o,o.options),Tt.addBox(this,o)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,i=t.length;if(t.sort((s,r)=>s.index-r.index),i>n){for(let s=n;s<i;++s)this._destroyDatasetMeta(s);t.splice(n,i-n)}this._sortedMetasets=t.slice(0).sort(Tc("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((i,s)=>{n.filter(r=>r===i._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let i,s;for(this._removeUnreferencedMetasets(),i=0,s=n.length;i<s;i++){const r=n[i];let o=this.getDatasetMeta(i);const a=r.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(i),o=this.getDatasetMeta(i)),o.type=a,o.indexAxis=r.indexAxis||Io(a,this.options),o.order=r.order||0,o.index=i,o.label=""+r.label,o.visible=this.isDatasetVisible(i),o.controller)o.controller.updateIndex(i),o.controller.linkScales();else{const l=Gt.getController(a),{datasetElementType:c,dataElementType:h}=$.datasets[a];Object.assign(l.prototype,{dataElementType:Gt.getElement(h),datasetElementType:c&&Gt.getElement(c)}),o.controller=new l(this,i),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){q(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const i=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,h=this.data.datasets.length;c<h;c++){const{controller:u}=this.getDatasetMeta(c),d=!s&&r.indexOf(u)===-1;u.buildOrUpdateElements(d),o=Math.max(+u.getMaxOverflow(),o)}o=this._minPadding=i.layout.autoPadding?o:0,this._updateLayout(o),s||q(r,c=>{c.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Tc("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){q(this.scales,t=>{Tt.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),i=new Set(t.events);(!Nl(n,i)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:i,start:s,count:r}of n){const o=i==="_removeElements"?-r:r;pb(t,s,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,i=r=>new Set(t.filter(o=>o[0]===r).map((o,a)=>a+","+o.splice(1).join(","))),s=i(0);for(let r=1;r<n;r++)if(!Nl(s,i(r)))return;return Array.from(s).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Tt.update(this,this.width,this.height,t);const n=this.chartArea,i=n.width<=0||n.height<=0;this._layers=[],q(this.boxes,s=>{i&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,r)=>{s._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,i=this.data.datasets.length;n<i;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,i=this.data.datasets.length;n<i;++n)this._updateDataset(n,ye(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const i=this.getDatasetMeta(t),s={meta:i,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(i.controller._update(n),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Zt.has(this)?this.attached&&!Zt.running(this)&&Zt.start(this):(this.draw(),Cc({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:i,height:s}=this._resizeBeforeDraw;this._resize(i,s),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,i=[];let s,r;for(s=0,r=n.length;s<r;++s){const o=n[s];(!t||o.visible)&&i.push(o)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,i=t._clip,s=!i.disabled,r=this.chartArea,o={meta:t,index:t.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",o)!==!1&&(s&&Js(n,{left:i.left===!1?0:r.left-i.left,right:i.right===!1?this.width:r.right+i.right,top:i.top===!1?0:r.top-i.top,bottom:i.bottom===!1?this.height:r.bottom+i.bottom}),t.controller.draw(),s&&Zs(n),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(t){return gi(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,i,s){const r=ky.modes[n];return typeof r=="function"?r(this,t,i,s):[]}getDatasetMeta(t){const n=this.data.datasets[t],i=this._metasets;let s=i.filter(r=>r&&r._dataset===n).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},i.push(s)),s}getContext(){return this.$context||(this.$context=we(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const i=this.getDatasetMeta(t);return typeof i.hidden=="boolean"?!i.hidden:!n.hidden}setDatasetVisibility(t,n){const i=this.getDatasetMeta(t);i.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,i){const s=i?"show":"hide",r=this.getDatasetMeta(t),o=r.controller._resolveAnimations(void 0,s);zt(n)?(r.data[n].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),o.update(r,{visible:i}),this.update(a=>a.datasetIndex===t?s:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),Zt.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Gl(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete Os[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,i=(r,o)=>{n.addEventListener(this,r,o),t[r]=o},s=(r,o,a)=>{r.offsetX=o,r.offsetY=a,this._eventHandler(r)};q(this.options.events,r=>i(r,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,i=(l,c)=>{n.addEventListener(this,l,c),t[l]=c},s=(l,c)=>{t[l]&&(n.removeEventListener(this,l,c),delete t[l])},r=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{s("attach",a),this.attached=!0,this.resize(),i("resize",r),i("detach",o)};o=()=>{this.attached=!1,s("resize",r),this._stop(),this._resize(0,0),i("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){q(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},q(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,i){const s=i?"set":"remove";let r,o,a,l;for(n==="dataset"&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+s+"DatasetHoverStyle"]()),a=0,l=t.length;a<l;++a){o=t[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],i=t.map(({datasetIndex:r,index:o})=>{const a=this.getDatasetMeta(r);if(!a)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:a.data[o],index:o}});!Ts(i,n)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,n))}notifyPlugins(t,n,i){return this._plugins.notify(this,t,n,i)}_updateHoverStyles(t,n,i){const s=this.options.hover,r=(l,c)=>l.filter(h=>!c.some(u=>h.datasetIndex===u.datasetIndex&&h.index===u.index)),o=r(n,t),a=i?t:r(t,n);o.length&&this.updateHoverStyle(o,s.mode,!1),a.length&&s.mode&&this.updateHoverStyle(a,s.mode,!0)}_eventHandler(t,n){const i={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},s=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",i,s)===!1)return;const r=this._handleEvent(t,n,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,s),(r||i.changed)&&this.render(),this}_handleEvent(t,n,i){const{_active:s=[],options:r}=this,o=n,a=this._getActiveElements(t,s,i,o),l=ap(t),c=mb(t,this._lastEvent,i,l);i&&(this._lastEvent=null,Q(r.onHover,[t,a,this],this),l&&Q(r.onClick,[t,a,this],this));const h=!Ts(a,s);return(h||n)&&(this._active=a,this._updateHoverStyles(a,s,n)),this._lastEvent=c,h}_getActiveElements(t,n,i,s){if(t.type==="mouseout")return[];if(!i)return n;const r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,s)}}const Ac=()=>q(lr.instances,e=>e._plugins.invalidate()),ue=!0;Object.defineProperties(lr,{defaults:{enumerable:ue,value:$},instances:{enumerable:ue,value:Os},overrides:{enumerable:ue,value:Ue},registry:{enumerable:ue,value:Gt},version:{enumerable:ue,value:db},getChart:{enumerable:ue,value:pd},register:{enumerable:ue,value:(...e)=>{Gt.add(...e),Ac()}},unregister:{enumerable:ue,value:(...e)=>{Gt.remove(...e),Ac()}}});function md(e,t,n){const{startAngle:i,pixelMargin:s,x:r,y:o,outerRadius:a,innerRadius:l}=t;let c=s/a;e.beginPath(),e.arc(r,o,a,i-c,n+c),l>s?(c=s/l,e.arc(r,o,l,n+c,i-c,!0)):e.arc(r,o,s,n+it,i-it),e.closePath(),e.clip()}function yb(e){return Sa(e,["outerStart","outerEnd","innerStart","innerEnd"])}function bb(e,t,n,i){const s=yb(e.options.borderRadius),r=(n-t)/2,o=Math.min(r,i*t/2),a=l=>{const c=(n-Math.min(r,l))*i/2;return pt(l,0,Math.min(r,c))};return{outerStart:a(s.outerStart),outerEnd:a(s.outerEnd),innerStart:pt(s.innerStart,0,o),innerEnd:pt(s.innerEnd,0,o)}}function ln(e,t,n,i){return{x:n+e*Math.cos(t),y:i+e*Math.sin(t)}}function Oo(e,t,n,i,s,r){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:h}=t,u=Math.max(t.outerRadius+i+n-c,0),d=h>0?h+i+n+c:0;let f=0;const g=s-l;if(i){const P=h>0?h-i:0,at=u>0?u-i:0,st=(P+at)/2,Ae=st!==0?g*st/(st+i):g;f=(g-Ae)/2}const p=Math.max(.001,g*u-n/et)/u,m=(g-p)/2,y=l+m+f,b=s-m-f,{outerStart:_,outerEnd:x,innerStart:v,innerEnd:E}=bb(t,d,u,b-y),S=u-_,D=u-x,A=y+_/S,R=b-x/D,j=d+v,B=d+E,ot=y+v/j,Dt=b-E/B;if(e.beginPath(),r){if(e.arc(o,a,u,A,R),x>0){const st=ln(D,R,o,a);e.arc(st.x,st.y,x,R,b+it)}const P=ln(B,b,o,a);if(e.lineTo(P.x,P.y),E>0){const st=ln(B,Dt,o,a);e.arc(st.x,st.y,E,b+it,Dt+Math.PI)}if(e.arc(o,a,d,b-E/d,y+v/d,!0),v>0){const st=ln(j,ot,o,a);e.arc(st.x,st.y,v,ot+Math.PI,y-it)}const at=ln(S,y,o,a);if(e.lineTo(at.x,at.y),_>0){const st=ln(S,A,o,a);e.arc(st.x,st.y,_,y-it,A)}}else{e.moveTo(o,a);const P=Math.cos(A)*u+o,at=Math.sin(A)*u+a;e.lineTo(P,at);const st=Math.cos(R)*u+o,Ae=Math.sin(R)*u+a;e.lineTo(st,Ae)}e.closePath()}function vb(e,t,n,i,s){const{fullCircles:r,startAngle:o,circumference:a}=t;let l=t.endAngle;if(r){Oo(e,t,n,i,o+Y,s);for(let c=0;c<r;++c)e.fill();isNaN(a)||(l=o+a%Y,a%Y===0&&(l+=Y))}return Oo(e,t,n,i,l,s),e.fill(),l}function _b(e,t,n){const{x:i,y:s,startAngle:r,pixelMargin:o,fullCircles:a}=t,l=Math.max(t.outerRadius-o,0),c=t.innerRadius+o;let h;for(n&&md(e,t,r+Y),e.beginPath(),e.arc(i,s,c,r+Y,r,!0),h=0;h<a;++h)e.stroke();for(e.beginPath(),e.arc(i,s,l,r,r+Y),h=0;h<a;++h)e.stroke()}function xb(e,t,n,i,s,r){const{options:o}=t,{borderWidth:a,borderJoinStyle:l}=o,c=o.borderAlign==="inner";!a||(c?(e.lineWidth=a*2,e.lineJoin=l||"round"):(e.lineWidth=a,e.lineJoin=l||"bevel"),t.fullCircles&&_b(e,t,c),c&&md(e,t,s),Oo(e,t,n,i,s,r),e.stroke())}class cr extends Wt{constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,n,i){const s=this.getProps(["x","y"],i),{angle:r,distance:o}=Iu(s,{x:t,y:n}),{startAngle:a,endAngle:l,innerRadius:c,outerRadius:h,circumference:u}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),d=this.options.spacing/2,g=L(u,l-a)>=Y||fi(r,a,l),p=ie(o,c+d,h+d);return g&&p}getCenterPoint(t){const{x:n,y:i,startAngle:s,endAngle:r,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],t),{offset:l,spacing:c}=this.options,h=(s+r)/2,u=(o+a+c+l)/2;return{x:n+Math.cos(h)*u,y:i+Math.sin(h)*u}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:n,circumference:i}=this,s=(n.offset||0)/2,r=(n.spacing||0)/2,o=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=i>Y?Math.floor(i/Y):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();let a=0;if(s){a=s/2;const c=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(c)*a,Math.sin(c)*a),this.circumference>=et&&(a=s)}t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor;const l=vb(t,this,a,r,o);xb(t,this,a,r,l,o),t.restore()}}cr.id="arc";cr.defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};cr.defaultRoutes={backgroundColor:"backgroundColor"};function yd(e,t,n=t){e.lineCap=L(n.borderCapStyle,t.borderCapStyle),e.setLineDash(L(n.borderDash,t.borderDash)),e.lineDashOffset=L(n.borderDashOffset,t.borderDashOffset),e.lineJoin=L(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=L(n.borderWidth,t.borderWidth),e.strokeStyle=L(n.borderColor,t.borderColor)}function wb(e,t,n){e.lineTo(n.x,n.y)}function Sb(e){return e.stepped?Hp:e.tension||e.cubicInterpolationMode==="monotone"?Wp:wb}function bd(e,t,n={}){const i=e.length,{start:s=0,end:r=i-1}=n,{start:o,end:a}=t,l=Math.max(s,o),c=Math.min(r,a),h=s<o&&r<o||s>a&&r>a;return{count:i,start:l,loop:t.loop,ilen:c<l&&!h?i+c-l:c-l}}function Eb(e,t,n,i){const{points:s,options:r}=t,{count:o,start:a,loop:l,ilen:c}=bd(s,n,i),h=Sb(r);let{move:u=!0,reverse:d}=i||{},f,g,p;for(f=0;f<=c;++f)g=s[(a+(d?c-f:f))%o],!g.skip&&(u?(e.moveTo(g.x,g.y),u=!1):h(e,p,g,d,r.stepped),p=g);return l&&(g=s[(a+(d?c:0))%o],h(e,p,g,d,r.stepped)),!!l}function Tb(e,t,n,i){const s=t.points,{count:r,start:o,ilen:a}=bd(s,n,i),{move:l=!0,reverse:c}=i||{};let h=0,u=0,d,f,g,p,m,y;const b=x=>(o+(c?a-x:x))%r,_=()=>{p!==m&&(e.lineTo(h,m),e.lineTo(h,p),e.lineTo(h,y))};for(l&&(f=s[b(0)],e.moveTo(f.x,f.y)),d=0;d<=a;++d){if(f=s[b(d)],f.skip)continue;const x=f.x,v=f.y,E=x|0;E===g?(v<p?p=v:v>m&&(m=v),h=(u*h+x)/++u):(_(),e.lineTo(x,v),g=E,u=0,p=m=v),y=v}_()}function Po(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?Tb:Eb}function Cb(e){return e.stepped?wm:e.tension||e.cubicInterpolationMode==="monotone"?Sm:ke}function Ab(e,t,n,i){let s=t._path;s||(s=t._path=new Path2D,t.path(s,n,i)&&s.closePath()),yd(e,t.options),e.stroke(s)}function Db(e,t,n,i){const{segments:s,options:r}=t,o=Po(t);for(const a of s)yd(e,r,a.style),e.beginPath(),o(e,t,a,{start:n,end:n+i-1})&&e.closePath(),e.stroke()}const Mb=typeof Path2D=="function";function Ib(e,t,n,i){Mb&&!t.options.segment?Ab(e,t,n,i):Db(e,t,n,i)}class Se extends Wt{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const s=i.spanGaps?this._loop:this._fullLoop;gm(this._points,i,t,s,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Im(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,i=t.length;return i&&n[t[i-1].end]}interpolate(t,n){const i=this.options,s=t[n],r=this.points,o=ed(this,{property:n,start:s,end:s});if(!o.length)return;const a=[],l=Cb(i);let c,h;for(c=0,h=o.length;c<h;++c){const{start:u,end:d}=o[c],f=r[u],g=r[d];if(f===g){a.push(f);continue}const p=Math.abs((s-f[n])/(g[n]-f[n])),m=l(f,g,p,i.stepped);m[n]=t[n],a.push(m)}return a.length===1?a[0]:a}pathSegment(t,n,i){return Po(this)(t,this,n,i)}path(t,n,i){const s=this.segments,r=Po(this);let o=this._loop;n=n||0,i=i||this.points.length-n;for(const a of s)o&=r(t,this,a,{start:n,end:n+i-1});return!!o}draw(t,n,i,s){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(t.save(),Ib(t,this,i,s),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Se.id="line";Se.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};Se.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};Se.descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};function Dc(e,t,n,i){const s=e.options,{[n]:r}=e.getProps([n],i);return Math.abs(t-r)<s.radius+s.hitRadius}class hr extends Wt{constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,n,i){const s=this.options,{x:r,y:o}=this.getProps(["x","y"],i);return Math.pow(t-r,2)+Math.pow(n-o,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(t,n){return Dc(this,t,"x",n)}inYRange(t,n){return Dc(this,t,"y",n)}getCenterPoint(t){const{x:n,y:i}=this.getProps(["x","y"],t);return{x:n,y:i}}size(t){t=t||this.options||{};let n=t.radius||0;n=Math.max(n,n&&t.hoverRadius||0);const i=n&&t.borderWidth||0;return(n+i)*2}draw(t,n){const i=this.options;this.skip||i.radius<.1||!gi(this,n,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,Do(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}hr.id="point";hr.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};hr.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};function vd(e,t){const{x:n,y:i,base:s,width:r,height:o}=e.getProps(["x","y","base","width","height"],t);let a,l,c,h,u;return e.horizontal?(u=o/2,a=Math.min(n,s),l=Math.max(n,s),c=i-u,h=i+u):(u=r/2,a=n-u,l=n+u,c=Math.min(i,s),h=Math.max(i,s)),{left:a,top:c,right:l,bottom:h}}function fe(e,t,n,i){return e?0:pt(t,n,i)}function kb(e,t,n){const i=e.options.borderWidth,s=e.borderSkipped,r=Uu(i);return{t:fe(s.top,r.top,0,n),r:fe(s.right,r.right,0,t),b:fe(s.bottom,r.bottom,0,n),l:fe(s.left,r.left,0,t)}}function Ob(e,t,n){const{enableBorderRadius:i}=e.getProps(["enableBorderRadius"]),s=e.options.borderRadius,r=Fe(s),o=Math.min(t,n),a=e.borderSkipped,l=i||V(s);return{topLeft:fe(!l||a.top||a.left,r.topLeft,0,o),topRight:fe(!l||a.top||a.right,r.topRight,0,o),bottomLeft:fe(!l||a.bottom||a.left,r.bottomLeft,0,o),bottomRight:fe(!l||a.bottom||a.right,r.bottomRight,0,o)}}function Pb(e){const t=vd(e),n=t.right-t.left,i=t.bottom-t.top,s=kb(e,n/2,i/2),r=Ob(e,n/2,i/2);return{outer:{x:t.left,y:t.top,w:n,h:i,radius:r},inner:{x:t.left+s.l,y:t.top+s.t,w:n-s.l-s.r,h:i-s.t-s.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,r.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(s.b,s.r))}}}}function eo(e,t,n,i){const s=t===null,r=n===null,a=e&&!(s&&r)&&vd(e,i);return a&&(s||ie(t,a.left,a.right))&&(r||ie(n,a.top,a.bottom))}function Rb(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function Lb(e,t){e.rect(t.x,t.y,t.w,t.h)}function no(e,t,n={}){const i=e.x!==n.x?-t:0,s=e.y!==n.y?-t:0,r=(e.x+e.w!==n.x+n.w?t:0)-i,o=(e.y+e.h!==n.y+n.h?t:0)-s;return{x:e.x+i,y:e.y+s,w:e.w+r,h:e.h+o,radius:e.radius}}class ur extends Wt{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:n,options:{borderColor:i,backgroundColor:s}}=this,{inner:r,outer:o}=Pb(this),a=Rb(o.radius)?pi:Lb;t.save(),(o.w!==r.w||o.h!==r.h)&&(t.beginPath(),a(t,no(o,n,r)),t.clip(),a(t,no(r,-n,o)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),a(t,no(r,n)),t.fillStyle=s,t.fill(),t.restore()}inRange(t,n,i){return eo(this,t,n,i)}inXRange(t,n){return eo(this,t,null,n)}inYRange(t,n){return eo(this,null,t,n)}getCenterPoint(t){const{x:n,y:i,base:s,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(n+s)/2:n,y:r?i:(i+s)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}ur.id="bar";ur.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};ur.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var Nb=Object.freeze({__proto__:null,ArcElement:cr,LineElement:Se,PointElement:hr,BarElement:ur});function Fb(e,t,n,i,s){const r=s.samples||i;if(r>=n)return e.slice(t,t+n);const o=[],a=(n-2)/(r-2);let l=0;const c=t+n-1;let h=t,u,d,f,g,p;for(o[l++]=e[h],u=0;u<r-2;u++){let m=0,y=0,b;const _=Math.floor((u+1)*a)+1+t,x=Math.min(Math.floor((u+2)*a)+1,n)+t,v=x-_;for(b=_;b<x;b++)m+=e[b].x,y+=e[b].y;m/=v,y/=v;const E=Math.floor(u*a)+1+t,S=Math.min(Math.floor((u+1)*a)+1,n)+t,{x:D,y:A}=e[h];for(f=g=-1,b=E;b<S;b++)g=.5*Math.abs((D-m)*(e[b].y-A)-(D-e[b].x)*(y-A)),g>f&&(f=g,d=e[b],p=b);o[l++]=d,h=p}return o[l++]=e[c],o}function Bb(e,t,n,i){let s=0,r=0,o,a,l,c,h,u,d,f,g,p;const m=[],y=t+n-1,b=e[t].x,x=e[y].x-b;for(o=t;o<t+n;++o){a=e[o],l=(a.x-b)/x*i,c=a.y;const v=l|0;if(v===h)c<g?(g=c,u=o):c>p&&(p=c,d=o),s=(r*s+a.x)/++r;else{const E=o-1;if(!H(u)&&!H(d)){const S=Math.min(u,d),D=Math.max(u,d);S!==f&&S!==E&&m.push({...e[S],x:s}),D!==f&&D!==E&&m.push({...e[D],x:s})}o>0&&E!==f&&m.push(e[E]),m.push(a),h=v,r=0,g=p=c,u=d=f=o}}return m}function _d(e){if(e._decimated){const t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{value:t})}}function Mc(e){e.data.datasets.forEach(t=>{_d(t)})}function Vb(e,t){const n=t.length;let i=0,s;const{iScale:r}=e,{min:o,max:a,minDefined:l,maxDefined:c}=r.getUserBounds();return l&&(i=pt(se(t,r.axis,o).lo,0,n-1)),c?s=pt(se(t,r.axis,a).hi+1,i,n)-i:s=n-i,{start:i,count:s}}var $b={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,n)=>{if(!n.enabled){Mc(e);return}const i=e.width;e.data.datasets.forEach((s,r)=>{const{_data:o,indexAxis:a}=s,l=e.getDatasetMeta(r),c=o||s.data;if(Xn([a,e.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const h=e.scales[l.xAxisID];if(h.type!=="linear"&&h.type!=="time"||e.options.parsing)return;let{start:u,count:d}=Vb(l,c);const f=n.threshold||4*i;if(d<=f){_d(s);return}H(o)&&(s._data=c,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(p){this._data=p}}));let g;switch(n.algorithm){case"lttb":g=Fb(c,u,d,i,n);break;case"min-max":g=Bb(c,u,d,i);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}s._decimated=g})},destroy(e){Mc(e)}};function jb(e,t,n){const i=e.segments,s=e.points,r=t.points,o=[];for(const a of i){let{start:l,end:c}=a;c=Ma(l,c,s);const h=Ro(n,s[l],s[c],a.loop);if(!t.segments){o.push({source:a,target:h,start:s[l],end:s[c]});continue}const u=ed(t,h);for(const d of u){const f=Ro(n,r[d.start],r[d.end],d.loop),g=td(a,s,f);for(const p of g)o.push({source:p,target:d,start:{[n]:Ic(h,f,"start",Math.max)},end:{[n]:Ic(h,f,"end",Math.min)}})}}return o}function Ro(e,t,n,i){if(i)return;let s=t[e],r=n[e];return e==="angle"&&(s=Ft(s),r=Ft(r)),{property:e,start:s,end:r}}function zb(e,t){const{x:n=null,y:i=null}=e||{},s=t.points,r=[];return t.segments.forEach(({start:o,end:a})=>{a=Ma(o,a,s);const l=s[o],c=s[a];i!==null?(r.push({x:l.x,y:i}),r.push({x:c.x,y:i})):n!==null&&(r.push({x:n,y:l.y}),r.push({x:n,y:c.y}))}),r}function Ma(e,t,n){for(;t>e;t--){const i=n[t];if(!isNaN(i.x)&&!isNaN(i.y))break}return t}function Ic(e,t,n,i){return e&&t?i(e[n],t[n]):e?e[n]:t?t[n]:0}function xd(e,t){let n=[],i=!1;return J(e)?(i=!0,n=e):n=zb(e,t),n.length?new Se({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function kc(e){return e&&e.fill!==!1}function Ub(e,t,n){let s=e[t].fill;const r=[t];let o;if(!n)return s;for(;s!==!1&&r.indexOf(s)===-1;){if(!rt(s))return s;if(o=e[s],!o)return!1;if(o.visible)return s;r.push(s),s=o.fill}return!1}function Hb(e,t,n){const i=Gb(e);if(V(i))return isNaN(i.value)?!1:i;let s=parseFloat(i);return rt(s)&&Math.floor(s)===s?Wb(i[0],t,s,n):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function Wb(e,t,n,i){return(e==="-"||e==="+")&&(n=t+n),n===t||n<0||n>=i?!1:n}function Kb(e,t){let n=null;return e==="start"?n=t.bottom:e==="end"?n=t.top:V(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}function qb(e,t,n){let i;return e==="start"?i=n:e==="end"?i=t.options.reverse?t.min:t.max:V(e)?i=e.value:i=t.getBaseValue(),i}function Gb(e){const t=e.options,n=t.fill;let i=L(n&&n.target,n);return i===void 0&&(i=!!t.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function Yb(e){const{scale:t,index:n,line:i}=e,s=[],r=i.segments,o=i.points,a=Xb(t,n);a.push(xd({x:null,y:t.bottom},i));for(let l=0;l<r.length;l++){const c=r[l];for(let h=c.start;h<=c.end;h++)Qb(s,o[h],a)}return new Se({points:s,options:{}})}function Xb(e,t){const n=[],i=e.getMatchingVisibleMetas("line");for(let s=0;s<i.length;s++){const r=i[s];if(r.index===t)break;r.hidden||n.unshift(r.dataset)}return n}function Qb(e,t,n){const i=[];for(let s=0;s<n.length;s++){const r=n[s],{first:o,last:a,point:l}=Jb(r,t,"x");if(!(!l||o&&a)){if(o)i.unshift(l);else if(e.push(l),!a)break}}e.push(...i)}function Jb(e,t,n){const i=e.interpolate(t,n);if(!i)return{};const s=i[n],r=e.segments,o=e.points;let a=!1,l=!1;for(let c=0;c<r.length;c++){const h=r[c],u=o[h.start][n],d=o[h.end][n];if(ie(s,u,d)){a=s===u,l=s===d;break}}return{first:a,last:l,point:i}}class wd{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,n,i){const{x:s,y:r,radius:o}=this;return n=n||{start:0,end:Y},t.arc(s,r,o,n.end,n.start,!0),!i.bounds}interpolate(t){const{x:n,y:i,radius:s}=this,r=t.angle;return{x:n+Math.cos(r)*s,y:i+Math.sin(r)*s,angle:r}}}function Zb(e){const{chart:t,fill:n,line:i}=e;if(rt(n))return tv(t,n);if(n==="stack")return Yb(e);if(n==="shape")return!0;const s=ev(e);return s instanceof wd?s:xd(s,i)}function tv(e,t){const n=e.getDatasetMeta(t);return n&&e.isDatasetVisible(t)?n.dataset:null}function ev(e){return(e.scale||{}).getPointPositionForValue?iv(e):nv(e)}function nv(e){const{scale:t={},fill:n}=e,i=Kb(n,t);if(rt(i)){const s=t.isHorizontal();return{x:s?i:null,y:s?null:i}}return null}function iv(e){const{scale:t,fill:n}=e,i=t.options,s=t.getLabels().length,r=i.reverse?t.max:t.min,o=qb(n,t,r),a=[];if(i.grid.circular){const l=t.getPointPositionForValue(0,r);return new wd({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(o)})}for(let l=0;l<s;++l)a.push(t.getPointPositionForValue(l,o));return a}function io(e,t,n){const i=Zb(t),{line:s,scale:r,axis:o}=t,a=s.options,l=a.fill,c=a.backgroundColor,{above:h=c,below:u=c}=l||{};i&&s.points.length&&(Js(e,n),sv(e,{line:s,target:i,above:h,below:u,area:n,scale:r,axis:o}),Zs(e))}function sv(e,t){const{line:n,target:i,above:s,below:r,area:o,scale:a}=t,l=n._loop?"angle":t.axis;e.save(),l==="x"&&r!==s&&(Oc(e,i,o.top),Pc(e,{line:n,target:i,color:s,scale:a,property:l}),e.restore(),e.save(),Oc(e,i,o.bottom)),Pc(e,{line:n,target:i,color:r,scale:a,property:l}),e.restore()}function Oc(e,t,n){const{segments:i,points:s}=t;let r=!0,o=!1;e.beginPath();for(const a of i){const{start:l,end:c}=a,h=s[l],u=s[Ma(l,c,s)];r?(e.moveTo(h.x,h.y),r=!1):(e.lineTo(h.x,n),e.lineTo(h.x,h.y)),o=!!t.pathSegment(e,a,{move:o}),o?e.closePath():e.lineTo(u.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function Pc(e,t){const{line:n,target:i,property:s,color:r,scale:o}=t,a=jb(n,i,s);for(const{source:l,target:c,start:h,end:u}of a){const{style:{backgroundColor:d=r}={}}=l,f=i!==!0;e.save(),e.fillStyle=d,rv(e,o,f&&Ro(s,h,u)),e.beginPath();const g=!!n.pathSegment(e,l);let p;if(f){g?e.closePath():Rc(e,i,u,s);const m=!!i.pathSegment(e,c,{move:g,reverse:!0});p=g&&m,p||Rc(e,i,h,s)}e.closePath(),e.fill(p?"evenodd":"nonzero"),e.restore()}}function rv(e,t,n){const{top:i,bottom:s}=t.chart.chartArea,{property:r,start:o,end:a}=n||{};r==="x"&&(e.beginPath(),e.rect(o,i,a-o,s-i),e.clip())}function Rc(e,t,n,i){const s=t.interpolate(n,i);s&&e.lineTo(s.x,s.y)}var ov={id:"filler",afterDatasetsUpdate(e,t,n){const i=(e.data.datasets||[]).length,s=[];let r,o,a,l;for(o=0;o<i;++o)r=e.getDatasetMeta(o),a=r.dataset,l=null,a&&a.options&&a instanceof Se&&(l={visible:e.isDatasetVisible(o),index:o,fill:Hb(a,o,i),chart:e,axis:r.controller.options.indexAxis,scale:r.vScale,line:a}),r.$filler=l,s.push(l);for(o=0;o<i;++o)l=s[o],!(!l||l.fill===!1)&&(l.fill=Ub(s,o,n.propagate))},beforeDraw(e,t,n){const i=n.drawTime==="beforeDraw",s=e.getSortedVisibleDatasetMetas(),r=e.chartArea;for(let o=s.length-1;o>=0;--o){const a=s[o].$filler;!a||(a.line.updateControlPoints(r,a.axis),i&&a.fill&&io(e.ctx,a,r))}},beforeDatasetsDraw(e,t,n){if(n.drawTime!=="beforeDatasetsDraw")return;const i=e.getSortedVisibleDatasetMetas();for(let s=i.length-1;s>=0;--s){const r=i[s].$filler;kc(r)&&io(e.ctx,r,e.chartArea)}},beforeDatasetDraw(e,t,n){const i=t.meta.$filler;!kc(i)||n.drawTime!=="beforeDatasetDraw"||io(e.ctx,i,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Lc=(e,t)=>{let{boxHeight:n=t,boxWidth:i=t}=e;return e.usePointStyle&&(n=Math.min(n,t),i=e.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(t,n)}},av=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class Nc extends Wt{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,i){this.maxWidth=t,this.maxHeight=n,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let n=Q(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(i=>t.filter(i,this.chart.data))),t.sort&&(n=n.sort((i,s)=>t.sort(i,s,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}const i=t.labels,s=dt(i.font),r=s.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=Lc(i,r);let c,h;n.font=s.string,this.isHorizontal()?(c=this.maxWidth,h=this._fitRows(o,r,a,l)+10):(h=this.maxHeight,c=this._fitCols(o,r,a,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,n,i,s){const{ctx:r,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],h=s+a;let u=t;r.textAlign="left",r.textBaseline="middle";let d=-1,f=-h;return this.legendItems.forEach((g,p)=>{const m=i+n/2+r.measureText(g.text).width;(p===0||c[c.length-1]+m+2*a>o)&&(u+=h,c[c.length-(p>0?0:1)]=0,f+=h,d++),l[p]={left:0,top:f,row:d,width:m,height:s},c[c.length-1]+=m+a}),u}_fitCols(t,n,i,s){const{ctx:r,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],h=o-t;let u=a,d=0,f=0,g=0,p=0;return this.legendItems.forEach((m,y)=>{const b=i+n/2+r.measureText(m.text).width;y>0&&f+s+2*a>h&&(u+=d+a,c.push({width:d,height:f}),g+=d+a,p++,d=f=0),l[y]={left:g,top:f,col:p,width:b,height:s},d=Math.max(d,b),f+=s+a}),u+=d,c.push({width:d,height:f}),u}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:i,labels:{padding:s},rtl:r}}=this,o=dn(r,this.left,this.width);if(this.isHorizontal()){let a=0,l=Et(i,this.left+s,this.right-this.lineWidths[a]);for(const c of n)a!==c.row&&(a=c.row,l=Et(i,this.left+s,this.right-this.lineWidths[a])),c.top+=this.top+t+s,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+s}else{let a=0,l=Et(i,this.top+t+s,this.bottom-this.columnSizes[a].height);for(const c of n)c.col!==a&&(a=c.col,l=Et(i,this.top+t+s,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+s,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;Js(t,this),this._draw(),Zs(t)}}_draw(){const{options:t,columnSizes:n,lineWidths:i,ctx:s}=this,{align:r,labels:o}=t,a=$.color,l=dn(t.rtl,this.left,this.width),c=dt(o.font),{color:h,padding:u}=o,d=c.size,f=d/2;let g;this.drawTitle(),s.textAlign=l.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=c.string;const{boxWidth:p,boxHeight:m,itemHeight:y}=Lc(o,d),b=function(S,D,A){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;s.save();const R=L(A.lineWidth,1);if(s.fillStyle=L(A.fillStyle,a),s.lineCap=L(A.lineCap,"butt"),s.lineDashOffset=L(A.lineDashOffset,0),s.lineJoin=L(A.lineJoin,"miter"),s.lineWidth=R,s.strokeStyle=L(A.strokeStyle,a),s.setLineDash(L(A.lineDash,[])),o.usePointStyle){const j={radius:m*Math.SQRT2/2,pointStyle:A.pointStyle,rotation:A.rotation,borderWidth:R},B=l.xPlus(S,p/2),ot=D+f;zu(s,j,B,ot,o.pointStyleWidth&&p)}else{const j=D+Math.max((d-m)/2,0),B=l.leftForLtr(S,p),ot=Fe(A.borderRadius);s.beginPath(),Object.values(ot).some(Dt=>Dt!==0)?pi(s,{x:B,y:j,w:p,h:m,radius:ot}):s.rect(B,j,p,m),s.fill(),R!==0&&s.stroke()}s.restore()},_=function(S,D,A){He(s,A.text,S,D+y/2,c,{strikethrough:A.hidden,textAlign:l.textAlign(A.textAlign)})},x=this.isHorizontal(),v=this._computeTitleHeight();x?g={x:Et(r,this.left+u,this.right-i[0]),y:this.top+u+v,line:0}:g={x:this.left+u,y:Et(r,this.top+v+u,this.bottom-n[0].height),line:0},Qu(this.ctx,t.textDirection);const E=y+u;this.legendItems.forEach((S,D)=>{s.strokeStyle=S.fontColor||h,s.fillStyle=S.fontColor||h;const A=s.measureText(S.text).width,R=l.textAlign(S.textAlign||(S.textAlign=o.textAlign)),j=p+f+A;let B=g.x,ot=g.y;l.setWidth(this.width),x?D>0&&B+j+u>this.right&&(ot=g.y+=E,g.line++,B=g.x=Et(r,this.left+u,this.right-i[g.line])):D>0&&ot+E>this.bottom&&(B=g.x=B+n[g.line].width+u,g.line++,ot=g.y=Et(r,this.top+v+u,this.bottom-n[g.line].height));const Dt=l.x(B);b(Dt,ot,S),B=bp(R,B+p+f,x?B+j:this.right,t.rtl),_(l.x(B),ot,S),x?g.x+=j+u:g.y+=E}),Ju(this.ctx,t.textDirection)}drawTitle(){const t=this.options,n=t.title,i=dt(n.font),s=At(n.padding);if(!n.display)return;const r=dn(t.rtl,this.left,this.width),o=this.ctx,a=n.position,l=i.size/2,c=s.top+l;let h,u=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),h=this.top+c,u=Et(t.align,u,this.right-d);else{const g=this.columnSizes.reduce((p,m)=>Math.max(p,m.height),0);h=c+Et(t.align,this.top,this.bottom-g-t.labels.padding-this._computeTitleHeight())}const f=Et(a,u,u+d);o.textAlign=r.textAlign(va(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=i.string,He(o,n.text,f,h,i)}_computeTitleHeight(){const t=this.options.title,n=dt(t.font),i=At(t.padding);return t.display?n.lineHeight+i.height:0}_getLegendItemAt(t,n){let i,s,r;if(ie(t,this.left,this.right)&&ie(n,this.top,this.bottom)){for(r=this.legendHitBoxes,i=0;i<r.length;++i)if(s=r[i],ie(t,s.left,s.left+s.width)&&ie(n,s.top,s.top+s.height))return this.legendItems[i]}return null}handleEvent(t){const n=this.options;if(!lv(t.type,n))return;const i=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const s=this._hoveredItem,r=av(s,i);s&&!r&&Q(n.onLeave,[t,s,this],this),this._hoveredItem=i,i&&!r&&Q(n.onHover,[t,i,this],this)}else i&&Q(n.onClick,[t,i,this],this)}}function lv(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var cv={id:"legend",_element:Nc,start(e,t,n){const i=e.legend=new Nc({ctx:e.ctx,options:n,chart:e});Tt.configure(e,i,n),Tt.addBox(e,i)},stop(e){Tt.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const i=e.legend;Tt.configure(e,i,n),i.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const i=t.datasetIndex,s=n.chart;s.isDatasetVisible(i)?(s.hide(i),t.hidden=!0):(s.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:s,color:r}}=e.legend.options;return e._getSortedDatasetMetas().map(o=>{const a=o.controller.getStyle(n?0:void 0),l=At(a.borderWidth);return{text:t[o.index].label,fillStyle:a.backgroundColor,fontColor:r,hidden:!o.visible,lineCap:a.borderCapStyle,lineDash:a.borderDash,lineDashOffset:a.borderDashOffset,lineJoin:a.borderJoinStyle,lineWidth:(l.width+l.height)/4,strokeStyle:a.borderColor,pointStyle:i||a.pointStyle,rotation:a.rotation,textAlign:s||a.textAlign,borderRadius:0,datasetIndex:o.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class Ia extends Wt{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;const s=J(i.text)?i.text.length:1;this._padding=At(i.padding);const r=s*dt(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:n,left:i,bottom:s,right:r,options:o}=this,a=o.align;let l=0,c,h,u;return this.isHorizontal()?(h=Et(a,i,r),u=n+t,c=r-i):(o.position==="left"?(h=i+t,u=Et(a,s,n),l=et*-.5):(h=r-t,u=Et(a,n,s),l=et*.5),c=s-n),{titleX:h,titleY:u,maxWidth:c,rotation:l}}draw(){const t=this.ctx,n=this.options;if(!n.display)return;const i=dt(n.font),r=i.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(r);He(t,n.text,0,0,i,{color:n.color,maxWidth:l,rotation:c,textAlign:va(n.align),textBaseline:"middle",translation:[o,a]})}}function hv(e,t){const n=new Ia({ctx:e.ctx,options:t,chart:e});Tt.configure(e,n,t),Tt.addBox(e,n),e.titleBlock=n}var uv={id:"title",_element:Ia,start(e,t,n){hv(e,n)},stop(e){const t=e.titleBlock;Tt.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const i=e.titleBlock;Tt.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ls=new WeakMap;var dv={id:"subtitle",start(e,t,n){const i=new Ia({ctx:e.ctx,options:n,chart:e});Tt.configure(e,i,n),Tt.addBox(e,i),ls.set(e,i)},stop(e){Tt.removeBox(e,ls.get(e)),ls.delete(e)},beforeUpdate(e,t,n){const i=ls.get(e);Tt.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const si={average(e){if(!e.length)return!1;let t,n,i=0,s=0,r=0;for(t=0,n=e.length;t<n;++t){const o=e[t].element;if(o&&o.hasValue()){const a=o.tooltipPosition();i+=a.x,s+=a.y,++r}}return{x:i/r,y:s/r}},nearest(e,t){if(!e.length)return!1;let n=t.x,i=t.y,s=Number.POSITIVE_INFINITY,r,o,a;for(r=0,o=e.length;r<o;++r){const l=e[r].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),h=To(t,c);h<s&&(s=h,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,i=l.y}return{x:n,y:i}}};function Kt(e,t){return t&&(J(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function te(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function fv(e,t){const{element:n,datasetIndex:i,index:s}=t,r=e.getDatasetMeta(i).controller,{label:o,value:a}=r.getLabelAndValue(s);return{chart:e,label:o,parsed:r.getParsed(s),raw:e.data.datasets[i].data[s],formattedValue:a,dataset:r.getDataset(),dataIndex:s,datasetIndex:i,element:n}}function Fc(e,t){const n=e.chart.ctx,{body:i,footer:s,title:r}=e,{boxWidth:o,boxHeight:a}=t,l=dt(t.bodyFont),c=dt(t.titleFont),h=dt(t.footerFont),u=r.length,d=s.length,f=i.length,g=At(t.padding);let p=g.height,m=0,y=i.reduce((x,v)=>x+v.before.length+v.lines.length+v.after.length,0);if(y+=e.beforeBody.length+e.afterBody.length,u&&(p+=u*c.lineHeight+(u-1)*t.titleSpacing+t.titleMarginBottom),y){const x=t.displayColors?Math.max(a,l.lineHeight):l.lineHeight;p+=f*x+(y-f)*l.lineHeight+(y-1)*t.bodySpacing}d&&(p+=t.footerMarginTop+d*h.lineHeight+(d-1)*t.footerSpacing);let b=0;const _=function(x){m=Math.max(m,n.measureText(x).width+b)};return n.save(),n.font=c.string,q(e.title,_),n.font=l.string,q(e.beforeBody.concat(e.afterBody),_),b=t.displayColors?o+2+t.boxPadding:0,q(i,x=>{q(x.before,_),q(x.lines,_),q(x.after,_)}),b=0,n.font=h.string,q(e.footer,_),n.restore(),m+=g.width,{width:m,height:p}}function gv(e,t){const{y:n,height:i}=t;return n<i/2?"top":n>e.height-i/2?"bottom":"center"}function pv(e,t,n,i){const{x:s,width:r}=i,o=n.caretSize+n.caretPadding;if(e==="left"&&s+r+o>t.width||e==="right"&&s-r-o<0)return!0}function mv(e,t,n,i){const{x:s,width:r}=n,{width:o,chartArea:{left:a,right:l}}=e;let c="center";return i==="center"?c=s<=(a+l)/2?"left":"right":s<=r/2?c="left":s>=o-r/2&&(c="right"),pv(c,e,t,n)&&(c="center"),c}function Bc(e,t,n){const i=n.yAlign||t.yAlign||gv(e,n);return{xAlign:n.xAlign||t.xAlign||mv(e,t,n,i),yAlign:i}}function yv(e,t){let{x:n,width:i}=e;return t==="right"?n-=i:t==="center"&&(n-=i/2),n}function bv(e,t,n){let{y:i,height:s}=e;return t==="top"?i+=n:t==="bottom"?i-=s+n:i-=s/2,i}function Vc(e,t,n,i){const{caretSize:s,caretPadding:r,cornerRadius:o}=e,{xAlign:a,yAlign:l}=n,c=s+r,{topLeft:h,topRight:u,bottomLeft:d,bottomRight:f}=Fe(o);let g=yv(t,a);const p=bv(t,l,c);return l==="center"?a==="left"?g+=c:a==="right"&&(g-=c):a==="left"?g-=Math.max(h,d)+s:a==="right"&&(g+=Math.max(u,f)+s),{x:pt(g,0,i.width-t.width),y:pt(p,0,i.height-t.height)}}function cs(e,t,n){const i=At(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-i.right:e.x+i.left}function $c(e){return Kt([],te(e))}function vv(e,t,n){return we(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function jc(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}class Lo extends Wt{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart||t._chart,this._chart=this.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,i=this.options.setContext(this.getContext()),s=i.enabled&&n.options.animation&&i.animations,r=new nd(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=vv(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:i}=n,s=i.beforeTitle.apply(this,[t]),r=i.title.apply(this,[t]),o=i.afterTitle.apply(this,[t]);let a=[];return a=Kt(a,te(s)),a=Kt(a,te(r)),a=Kt(a,te(o)),a}getBeforeBody(t,n){return $c(n.callbacks.beforeBody.apply(this,[t]))}getBody(t,n){const{callbacks:i}=n,s=[];return q(t,r=>{const o={before:[],lines:[],after:[]},a=jc(i,r);Kt(o.before,te(a.beforeLabel.call(this,r))),Kt(o.lines,a.label.call(this,r)),Kt(o.after,te(a.afterLabel.call(this,r))),s.push(o)}),s}getAfterBody(t,n){return $c(n.callbacks.afterBody.apply(this,[t]))}getFooter(t,n){const{callbacks:i}=n,s=i.beforeFooter.apply(this,[t]),r=i.footer.apply(this,[t]),o=i.afterFooter.apply(this,[t]);let a=[];return a=Kt(a,te(s)),a=Kt(a,te(r)),a=Kt(a,te(o)),a}_createItems(t){const n=this._active,i=this.chart.data,s=[],r=[],o=[];let a=[],l,c;for(l=0,c=n.length;l<c;++l)a.push(fv(this.chart,n[l]));return t.filter&&(a=a.filter((h,u,d)=>t.filter(h,u,d,i))),t.itemSort&&(a=a.sort((h,u)=>t.itemSort(h,u,i))),q(a,h=>{const u=jc(t.callbacks,h);s.push(u.labelColor.call(this,h)),r.push(u.labelPointStyle.call(this,h)),o.push(u.labelTextColor.call(this,h))}),this.labelColors=s,this.labelPointStyles=r,this.labelTextColors=o,this.dataPoints=a,a}update(t,n){const i=this.options.setContext(this.getContext()),s=this._active;let r,o=[];if(!s.length)this.opacity!==0&&(r={opacity:0});else{const a=si[i.position].call(this,s,this._eventPosition);o=this._createItems(i),this.title=this.getTitle(o,i),this.beforeBody=this.getBeforeBody(o,i),this.body=this.getBody(o,i),this.afterBody=this.getAfterBody(o,i),this.footer=this.getFooter(o,i);const l=this._size=Fc(this,i),c=Object.assign({},a,l),h=Bc(this.chart,i,c),u=Vc(i,c,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,r={opacity:1,x:u.x,y:u.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,i,s){const r=this.getCaretPosition(t,i,s);n.lineTo(r.x1,r.y1),n.lineTo(r.x2,r.y2),n.lineTo(r.x3,r.y3)}getCaretPosition(t,n,i){const{xAlign:s,yAlign:r}=this,{caretSize:o,cornerRadius:a}=i,{topLeft:l,topRight:c,bottomLeft:h,bottomRight:u}=Fe(a),{x:d,y:f}=t,{width:g,height:p}=n;let m,y,b,_,x,v;return r==="center"?(x=f+p/2,s==="left"?(m=d,y=m-o,_=x+o,v=x-o):(m=d+g,y=m+o,_=x-o,v=x+o),b=m):(s==="left"?y=d+Math.max(l,h)+o:s==="right"?y=d+g-Math.max(c,u)-o:y=this.caretX,r==="top"?(_=f,x=_-o,m=y-o,b=y+o):(_=f+p,x=_+o,m=y+o,b=y-o),v=_),{x1:m,x2:y,x3:b,y1:_,y2:x,y3:v}}drawTitle(t,n,i){const s=this.title,r=s.length;let o,a,l;if(r){const c=dn(i.rtl,this.x,this.width);for(t.x=cs(this,i.titleAlign,i),n.textAlign=c.textAlign(i.titleAlign),n.textBaseline="middle",o=dt(i.titleFont),a=i.titleSpacing,n.fillStyle=i.titleColor,n.font=o.string,l=0;l<r;++l)n.fillText(s[l],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,l+1===r&&(t.y+=i.titleMarginBottom-a)}}_drawColorBox(t,n,i,s,r){const o=this.labelColors[i],a=this.labelPointStyles[i],{boxHeight:l,boxWidth:c,boxPadding:h}=r,u=dt(r.bodyFont),d=cs(this,"left",r),f=s.x(d),g=l<u.lineHeight?(u.lineHeight-l)/2:0,p=n.y+g;if(r.usePointStyle){const m={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},y=s.leftForLtr(f,c)+c/2,b=p+l/2;t.strokeStyle=r.multiKeyBackground,t.fillStyle=r.multiKeyBackground,Do(t,m,y,b),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,Do(t,m,y,b)}else{t.lineWidth=V(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const m=s.leftForLtr(f,c-h),y=s.leftForLtr(s.xPlus(f,1),c-h-2),b=Fe(o.borderRadius);Object.values(b).some(_=>_!==0)?(t.beginPath(),t.fillStyle=r.multiKeyBackground,pi(t,{x:m,y:p,w:c,h:l,radius:b}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),pi(t,{x:y,y:p+1,w:c-2,h:l-2,radius:b}),t.fill()):(t.fillStyle=r.multiKeyBackground,t.fillRect(m,p,c,l),t.strokeRect(m,p,c,l),t.fillStyle=o.backgroundColor,t.fillRect(y,p+1,c-2,l-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,n,i){const{body:s}=this,{bodySpacing:r,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:h}=i,u=dt(i.bodyFont);let d=u.lineHeight,f=0;const g=dn(i.rtl,this.x,this.width),p=function(D){n.fillText(D,g.x(t.x+f),t.y+d/2),t.y+=d+r},m=g.textAlign(o);let y,b,_,x,v,E,S;for(n.textAlign=o,n.textBaseline="middle",n.font=u.string,t.x=cs(this,m,i),n.fillStyle=i.bodyColor,q(this.beforeBody,p),f=a&&m!=="right"?o==="center"?c/2+h:c+2+h:0,x=0,E=s.length;x<E;++x){for(y=s[x],b=this.labelTextColors[x],n.fillStyle=b,q(y.before,p),_=y.lines,a&&_.length&&(this._drawColorBox(n,t,x,g,i),d=Math.max(u.lineHeight,l)),v=0,S=_.length;v<S;++v)p(_[v]),d=u.lineHeight;q(y.after,p)}f=0,d=u.lineHeight,q(this.afterBody,p),t.y-=r}drawFooter(t,n,i){const s=this.footer,r=s.length;let o,a;if(r){const l=dn(i.rtl,this.x,this.width);for(t.x=cs(this,i.footerAlign,i),t.y+=i.footerMarginTop,n.textAlign=l.textAlign(i.footerAlign),n.textBaseline="middle",o=dt(i.footerFont),n.fillStyle=i.footerColor,n.font=o.string,a=0;a<r;++a)n.fillText(s[a],l.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+i.footerSpacing}}drawBackground(t,n,i,s){const{xAlign:r,yAlign:o}=this,{x:a,y:l}=t,{width:c,height:h}=i,{topLeft:u,topRight:d,bottomLeft:f,bottomRight:g}=Fe(s.cornerRadius);n.fillStyle=s.backgroundColor,n.strokeStyle=s.borderColor,n.lineWidth=s.borderWidth,n.beginPath(),n.moveTo(a+u,l),o==="top"&&this.drawCaret(t,n,i,s),n.lineTo(a+c-d,l),n.quadraticCurveTo(a+c,l,a+c,l+d),o==="center"&&r==="right"&&this.drawCaret(t,n,i,s),n.lineTo(a+c,l+h-g),n.quadraticCurveTo(a+c,l+h,a+c-g,l+h),o==="bottom"&&this.drawCaret(t,n,i,s),n.lineTo(a+f,l+h),n.quadraticCurveTo(a,l+h,a,l+h-f),o==="center"&&r==="left"&&this.drawCaret(t,n,i,s),n.lineTo(a,l+u),n.quadraticCurveTo(a,l,a+u,l),n.closePath(),n.fill(),s.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,i=this.$animations,s=i&&i.x,r=i&&i.y;if(s||r){const o=si[t.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=Fc(this,t),l=Object.assign({},o,this._size),c=Bc(n,t,l),h=Vc(t,l,c,n);(s._to!==h.x||r._to!==h.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(n);const s={width:this.width,height:this.height},r={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const o=At(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(t.save(),t.globalAlpha=i,this.drawBackground(r,t,s,n),Qu(t,n.textDirection),r.y+=o.top,this.drawTitle(r,t,n),this.drawBody(r,t,n),this.drawFooter(r,t,n),Ju(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const i=this._active,s=t.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),r=!Ts(i,s),o=this._positionChanged(s,n);(r||o)&&(this._active=s,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,i=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,r=this._active||[],o=this._getActiveElements(t,r,n,i),a=this._positionChanged(o,t),l=n||!Ts(o,r)||a;return l&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),l}_getActiveElements(t,n,i,s){const r=this.options;if(t.type==="mouseout")return[];if(!s)return n;const o=this.chart.getElementsAtEventForMode(t,r.mode,r,i);return r.reverse&&o.reverse(),o}_positionChanged(t,n){const{caretX:i,caretY:s,options:r}=this,o=si[r.position].call(this,t,n);return o!==!1&&(i!==o.x||s!==o.y)}}Lo.positioners=si;var _v={id:"tooltip",_element:Lo,positioners:si,afterInit(e,t,n){n&&(e.tooltip=new Lo({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",n)===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:Jt,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,i=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return n[t.dataIndex]}return""},afterTitle:Jt,beforeBody:Jt,beforeLabel:Jt,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return H(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Jt,afterBody:Jt,beforeFooter:Jt,footer:Jt,afterFooter:Jt}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},xv=Object.freeze({__proto__:null,Decimation:$b,Filler:ov,Legend:cv,SubTitle:dv,Title:uv,Tooltip:_v});const wv=(e,t,n,i)=>(typeof t=="string"?(n=e.push(t)-1,i.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function Sv(e,t,n,i){const s=e.indexOf(t);if(s===-1)return wv(e,t,n,i);const r=e.lastIndexOf(t);return s!==r?n:s}const Ev=(e,t)=>e===null?null:pt(Math.round(e),0,t);class Ps extends Ze{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const i=this.getLabels();for(const{index:s,label:r}of n)i[s]===r&&i.splice(s,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(H(t))return null;const i=this.getLabels();return n=isFinite(n)&&i[n]===t?n:Sv(i,t,L(n,t),this._addedLabels),Ev(n,i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:i,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(i=0),n||(s=this.getLabels().length-1)),this.min=i,this.max=s}buildTicks(){const t=this.min,n=this.max,i=this.options.offset,s=[];let r=this.getLabels();r=t===0&&n===r.length-1?r:r.slice(t,n+1),this._valueRange=Math.max(r.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let o=t;o<=n;o++)s.push({value:o});return s}getLabelForValue(t){const n=this.getLabels();return t>=0&&t<n.length?n[t]:t}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}Ps.id="category";Ps.defaults={ticks:{callback:Ps.prototype.getLabelForValue}};function Tv(e,t){const n=[],{bounds:s,step:r,min:o,max:a,precision:l,count:c,maxTicks:h,maxDigits:u,includeBounds:d}=e,f=r||1,g=h-1,{min:p,max:m}=t,y=!H(o),b=!H(a),_=!H(c),x=(m-p)/(u+1);let v=Bl((m-p)/g/f)*f,E,S,D,A;if(v<1e-14&&!y&&!b)return[{value:p},{value:m}];A=Math.ceil(m/v)-Math.floor(p/v),A>g&&(v=Bl(A*v/g/f)*f),H(l)||(E=Math.pow(10,l),v=Math.ceil(v*E)/E),s==="ticks"?(S=Math.floor(p/v)*v,D=Math.ceil(m/v)*v):(S=p,D=m),y&&b&&r&&up((a-o)/r,v/1e3)?(A=Math.round(Math.min((a-o)/v,h)),v=(a-o)/A,S=o,D=a):_?(S=y?o:S,D=b?a:D,A=c-1,v=(D-S)/A):(A=(D-S)/v,ei(A,Math.round(A),v/1e3)?A=Math.round(A):A=Math.ceil(A));const R=Math.max(Vl(v),Vl(S));E=Math.pow(10,H(l)?R:l),S=Math.round(S*E)/E,D=Math.round(D*E)/E;let j=0;for(y&&(d&&S!==o?(n.push({value:o}),S<o&&j++,ei(Math.round((S+j*v)*E)/E,o,zc(o,x,e))&&j++):S<o&&j++);j<A;++j)n.push({value:Math.round((S+j*v)*E)/E});return b&&d&&D!==a?n.length&&ei(n[n.length-1].value,a,zc(a,x,e))?n[n.length-1].value=a:n.push({value:a}):(!b||D===a)&&n.push({value:D}),n}function zc(e,t,{horizontal:n,minRotation:i}){const s=Ut(i),r=(n?Math.sin(s):Math.cos(s))||.001,o=.75*t*(""+e).length;return Math.min(t/r,o)}class Rs extends Ze{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return H(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:i}=this.getUserBounds();let{min:s,max:r}=this;const o=l=>s=n?s:l,a=l=>r=i?r:l;if(t){const l=Yt(s),c=Yt(r);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(s===r){let l=1;(r>=Number.MAX_SAFE_INTEGER||s<=Number.MIN_SAFE_INTEGER)&&(l=Math.abs(r*.05)),a(r+l),t||o(s-l)}this.min=s,this.max=r}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:i}=t,s;return i?(s=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),n=n||11),n&&(s=Math.min(n,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const s={maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},r=this._range||this,o=Tv(s,r);return t.bounds==="ticks"&&Mu(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let n=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const s=(i-n)/Math.max(t.length-1,1)/2;n-=s,i+=s}this._startValue=n,this._endValue=i,this._valueRange=i-n}getLabelForValue(t){return Pi(t,this.chart.options.locale,this.options.ticks.format)}}class ka extends Rs{determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=rt(t)?t:0,this.max=rt(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,i=Ut(this.options.ticks.minRotation),s=(t?Math.sin(i):Math.cos(i))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,r.lineHeight/s))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}ka.id="linear";ka.defaults={ticks:{callback:or.formatters.numeric}};function Uc(e){return e/Math.pow(10,Math.floor(jt(e)))===1}function Cv(e,t){const n=Math.floor(jt(t.max)),i=Math.ceil(t.max/Math.pow(10,n)),s=[];let r=$t(e.min,Math.pow(10,Math.floor(jt(t.min)))),o=Math.floor(jt(r)),a=Math.floor(r/Math.pow(10,o)),l=o<0?Math.pow(10,Math.abs(o)):1;do s.push({value:r,major:Uc(r)}),++a,a===10&&(a=1,++o,l=o>=0?1:l),r=Math.round(a*Math.pow(10,o)*l)/l;while(o<n||o===n&&a<i);const c=$t(e.max,r);return s.push({value:c,major:Uc(r)}),s}class Oa extends Ze{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,n){const i=Rs.prototype.parse.apply(this,[t,n]);if(i===0){this._zero=!0;return}return rt(i)&&i>0?i:null}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=rt(t)?Math.max(0,t):null,this.max=rt(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let i=this.min,s=this.max;const r=l=>i=t?i:l,o=l=>s=n?s:l,a=(l,c)=>Math.pow(10,Math.floor(jt(l))+c);i===s&&(i<=0?(r(1),o(10)):(r(a(i,-1)),o(a(s,1)))),i<=0&&r(a(s,-1)),s<=0&&o(a(i,1)),this._zero&&this.min!==this._suggestedMin&&i===a(this.min,0)&&r(a(i,-1)),this.min=i,this.max=s}buildTicks(){const t=this.options,n={min:this._userMin,max:this._userMax},i=Cv(n,this);return t.bounds==="ticks"&&Mu(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(t){return t===void 0?"0":Pi(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=jt(t),this._valueRange=jt(this.max)-jt(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(jt(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const n=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+n*this._valueRange)}}Oa.id="logarithmic";Oa.defaults={ticks:{callback:or.formatters.logarithmic,major:{enabled:!0}}};function No(e){const t=e.ticks;if(t.display&&e.display){const n=At(t.backdropPadding);return L(t.font&&t.font.size,$.font.size)+n.height}return 0}function Av(e,t,n){return n=J(n)?n:[n],{w:Up(e,t.string,n),h:n.length*t.lineHeight}}function Hc(e,t,n,i,s){return e===i||e===s?{start:t-n/2,end:t+n/2}:e<i||e>s?{start:t-n,end:t}:{start:t,end:t+n}}function Dv(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),i=[],s=[],r=e._pointLabels.length,o=e.options.pointLabels,a=o.centerPointLabels?et/r:0;for(let l=0;l<r;l++){const c=o.setContext(e.getPointLabelContext(l));s[l]=c.padding;const h=e.getPointPosition(l,e.drawingArea+s[l],a),u=dt(c.font),d=Av(e.ctx,u,e._pointLabels[l]);i[l]=d;const f=Ft(e.getIndexAngle(l)+a),g=Math.round(ya(f)),p=Hc(g,h.x,d.w,0,180),m=Hc(g,h.y,d.h,90,270);Mv(n,t,f,p,m)}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=Iv(e,i,s)}function Mv(e,t,n,i,s){const r=Math.abs(Math.sin(n)),o=Math.abs(Math.cos(n));let a=0,l=0;i.start<t.l?(a=(t.l-i.start)/r,e.l=Math.min(e.l,t.l-a)):i.end>t.r&&(a=(i.end-t.r)/r,e.r=Math.max(e.r,t.r+a)),s.start<t.t?(l=(t.t-s.start)/o,e.t=Math.min(e.t,t.t-l)):s.end>t.b&&(l=(s.end-t.b)/o,e.b=Math.max(e.b,t.b+l))}function Iv(e,t,n){const i=[],s=e._pointLabels.length,r=e.options,o=No(r)/2,a=e.drawingArea,l=r.pointLabels.centerPointLabels?et/s:0;for(let c=0;c<s;c++){const h=e.getPointPosition(c,a+o+n[c],l),u=Math.round(ya(Ft(h.angle+it))),d=t[c],f=Pv(h.y,d.h,u),g=kv(u),p=Ov(h.x,d.w,g);i.push({x:h.x,y:f,textAlign:g,left:p,top:f,right:p+d.w,bottom:f+d.h})}return i}function kv(e){return e===0||e===180?"center":e<180?"left":"right"}function Ov(e,t,n){return n==="right"?e-=t:n==="center"&&(e-=t/2),e}function Pv(e,t,n){return n===90||n===270?e-=t/2:(n>270||n<90)&&(e-=t),e}function Rv(e,t){const{ctx:n,options:{pointLabels:i}}=e;for(let s=t-1;s>=0;s--){const r=i.setContext(e.getPointLabelContext(s)),o=dt(r.font),{x:a,y:l,textAlign:c,left:h,top:u,right:d,bottom:f}=e._pointLabelItems[s],{backdropColor:g}=r;if(!H(g)){const p=Fe(r.borderRadius),m=At(r.backdropPadding);n.fillStyle=g;const y=h-m.left,b=u-m.top,_=d-h+m.width,x=f-u+m.height;Object.values(p).some(v=>v!==0)?(n.beginPath(),pi(n,{x:y,y:b,w:_,h:x,radius:p}),n.fill()):n.fillRect(y,b,_,x)}He(n,e._pointLabels[s],a,l+o.lineHeight/2,o,{color:r.color,textAlign:c,textBaseline:"middle"})}}function Sd(e,t,n,i){const{ctx:s}=e;if(n)s.arc(e.xCenter,e.yCenter,t,0,Y);else{let r=e.getPointPosition(0,t);s.moveTo(r.x,r.y);for(let o=1;o<i;o++)r=e.getPointPosition(o,t),s.lineTo(r.x,r.y)}}function Lv(e,t,n,i){const s=e.ctx,r=t.circular,{color:o,lineWidth:a}=t;!r&&!i||!o||!a||n<0||(s.save(),s.strokeStyle=o,s.lineWidth=a,s.setLineDash(t.borderDash),s.lineDashOffset=t.borderDashOffset,s.beginPath(),Sd(e,n,r,i),s.closePath(),s.stroke(),s.restore())}function Nv(e,t,n){return we(e,{label:n,index:t,type:"pointLabel"})}class Li extends Rs{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=At(No(this.options)/2),n=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+n/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(n,i)/2)}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!1);this.min=rt(t)&&!isNaN(t)?t:0,this.max=rt(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/No(this.options))}generateTickLabels(t){Rs.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((n,i)=>{const s=Q(this.options.pointLabels.callback,[n,i],this);return s||s===0?s:""}).filter((n,i)=>this.chart.getDataVisibility(i))}fit(){const t=this.options;t.display&&t.pointLabels.display?Dv(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,n,i,s){this.xCenter+=Math.floor((t-n)/2),this.yCenter+=Math.floor((i-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,n,i,s))}getIndexAngle(t){const n=Y/(this._pointLabels.length||1),i=this.options.startAngle||0;return Ft(t*n+Ut(i))}getDistanceFromCenterForValue(t){if(H(t))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*n:(t-this.min)*n}getValueForDistanceFromCenter(t){if(H(t))return NaN;const n=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(t){const n=this._pointLabels||[];if(t>=0&&t<n.length){const i=n[t];return Nv(this.getContext(),t,i)}}getPointPosition(t,n,i=0){const s=this.getIndexAngle(t)-it+i;return{x:Math.cos(s)*n+this.xCenter,y:Math.sin(s)*n+this.yCenter,angle:s}}getPointPositionForValue(t,n){return this.getPointPosition(t,this.getDistanceFromCenterForValue(n))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:n,top:i,right:s,bottom:r}=this._pointLabelItems[t];return{left:n,top:i,right:s,bottom:r}}drawBackground(){const{backgroundColor:t,grid:{circular:n}}=this.options;if(t){const i=this.ctx;i.save(),i.beginPath(),Sd(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const t=this.ctx,n=this.options,{angleLines:i,grid:s}=n,r=this._pointLabels.length;let o,a,l;if(n.pointLabels.display&&Rv(this,r),s.display&&this.ticks.forEach((c,h)=>{if(h!==0){a=this.getDistanceFromCenterForValue(c.value);const u=s.setContext(this.getContext(h-1));Lv(this,u,a,r)}}),i.display){for(t.save(),o=r-1;o>=0;o--){const c=i.setContext(this.getPointLabelContext(o)),{color:h,lineWidth:u}=c;!u||!h||(t.lineWidth=u,t.strokeStyle=h,t.setLineDash(c.borderDash),t.lineDashOffset=c.borderDashOffset,a=this.getDistanceFromCenterForValue(n.ticks.reverse?this.min:this.max),l=this.getPointPosition(o,a),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(l.x,l.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,n=this.options,i=n.ticks;if(!i.display)return;const s=this.getIndexAngle(0);let r,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(s),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&!n.reverse)return;const c=i.setContext(this.getContext(l)),h=dt(c.font);if(r=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){t.font=h.string,o=t.measureText(a.label).width,t.fillStyle=c.backdropColor;const u=At(c.backdropPadding);t.fillRect(-o/2-u.left,-r-h.size/2-u.top,o+u.width,h.size+u.height)}He(t,a.label,0,-r,h,{color:c.color})}),t.restore()}drawTitle(){}}Li.id="radialLinear";Li.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:or.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};Li.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};Li.descriptors={angleLines:{_fallback:"grid"}};const dr={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Pt=Object.keys(dr);function Fv(e,t){return e-t}function Wc(e,t){if(H(t))return null;const n=e._adapter,{parser:i,round:s,isoWeekday:r}=e._parseOpts;let o=t;return typeof i=="function"&&(o=i(o)),rt(o)||(o=typeof i=="string"?n.parse(o,i):n.parse(o)),o===null?null:(s&&(o=s==="week"&&(yn(r)||r===!0)?n.startOf(o,"isoWeek",r):n.startOf(o,s)),+o)}function Kc(e,t,n,i){const s=Pt.length;for(let r=Pt.indexOf(e);r<s-1;++r){const o=dr[Pt[r]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-t)/(a*o.size))<=i)return Pt[r]}return Pt[s-1]}function Bv(e,t,n,i,s){for(let r=Pt.length-1;r>=Pt.indexOf(n);r--){const o=Pt[r];if(dr[o].common&&e._adapter.diff(s,i,o)>=t-1)return o}return Pt[n?Pt.indexOf(n):0]}function Vv(e){for(let t=Pt.indexOf(e)+1,n=Pt.length;t<n;++t)if(dr[Pt[t]].common)return Pt[t]}function qc(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:i,hi:s}=ba(n,t),r=n[i]>=t?n[i]:n[s];e[r]=!0}}function $v(e,t,n,i){const s=e._adapter,r=+s.startOf(t[0].value,i),o=t[t.length-1].value;let a,l;for(a=r;a<=o;a=+s.add(a,1,i))l=n[a],l>=0&&(t[l].major=!0);return t}function Gc(e,t,n){const i=[],s={},r=t.length;let o,a;for(o=0;o<r;++o)a=t[o],s[a]=o,i.push({value:a,major:!1});return r===0||!n?i:$v(e,i,s,n)}class Ni extends Ze{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n){const i=t.time||(t.time={}),s=this._adapter=new Cy._date(t.adapters.date);s.init(n),ti(i.displayFormats,s.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:Wc(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,i=t.time.unit||"day";let{min:s,max:r,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(s=Math.min(s,c.min)),!a&&!isNaN(c.max)&&(r=Math.max(r,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),s=rt(s)&&!isNaN(s)?s:+n.startOf(Date.now(),i),r=rt(r)&&!isNaN(r)?r:+n.endOf(Date.now(),i)+1,this.min=Math.min(s,r-1),this.max=Math.max(s+1,r)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],i=t[t.length-1]),{min:n,max:i}}buildTicks(){const t=this.options,n=t.time,i=t.ticks,s=i.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const r=this.min,o=this.max,a=pp(s,r,o);return this._unit=n.unit||(i.autoSkip?Kc(n.minUnit,this.min,this.max,this._getLabelCapacity(r)):Bv(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:Vv(this._unit),this.initOffsets(s),t.reverse&&a.reverse(),Gc(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t){let n=0,i=0,s,r;this.options.offset&&t.length&&(s=this.getDecimalForValue(t[0]),t.length===1?n=1-s:n=(this.getDecimalForValue(t[1])-s)/2,r=this.getDecimalForValue(t[t.length-1]),t.length===1?i=r:i=(r-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;n=pt(n,0,o),i=pt(i,0,o),this._offsets={start:n,end:i,factor:1/(n+1+i)}}_generate(){const t=this._adapter,n=this.min,i=this.max,s=this.options,r=s.time,o=r.unit||Kc(r.minUnit,n,i,this._getLabelCapacity(n)),a=L(r.stepSize,1),l=o==="week"?r.isoWeekday:!1,c=yn(l)||l===!0,h={};let u=n,d,f;if(c&&(u=+t.startOf(u,"isoWeek",l)),u=+t.startOf(u,c?"day":o),t.diff(i,n,o)>1e5*a)throw new Error(n+" and "+i+" are too far apart with stepSize of "+a+" "+o);const g=s.ticks.source==="data"&&this.getDataTimestamps();for(d=u,f=0;d<i;d=+t.add(d,a,o),f++)qc(h,d,g);return(d===i||s.bounds==="ticks"||f===1)&&qc(h,d,g),Object.keys(h).sort((p,m)=>p-m).map(p=>+p)}getLabelForValue(t){const n=this._adapter,i=this.options.time;return i.tooltipFormat?n.format(t,i.tooltipFormat):n.format(t,i.displayFormats.datetime)}_tickFormatFunction(t,n,i,s){const r=this.options,o=r.time.displayFormats,a=this._unit,l=this._majorUnit,c=a&&o[a],h=l&&o[l],u=i[n],d=l&&h&&u&&u.major,f=this._adapter.format(t,s||(d?h:c)),g=r.ticks.callback;return g?Q(g,[f,n,i],this):f}generateTickLabels(t){let n,i,s;for(n=0,i=t.length;n<i;++n)s=t[n],s.label=this._tickFormatFunction(s.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+i)*n.factor)}getValueForPixel(t){const n=this._offsets,i=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,i=this.ctx.measureText(t).width,s=Ut(this.isHorizontal()?n.maxRotation:n.minRotation),r=Math.cos(s),o=Math.sin(s),a=this._resolveTickFontOptions(0).size;return{w:i*r+a*o,h:i*o+a*r}}_getLabelCapacity(t){const n=this.options.time,i=n.displayFormats,s=i[n.unit]||i.millisecond,r=this._tickFormatFunction(t,0,Gc(this,[t],this._majorUnit),s),o=this._getLabelSize(r),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let t=this._cache.data||[],n,i;if(t.length)return t;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(n=0,i=s.length;n<i;++n)t=t.concat(s[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,i;if(t.length)return t;const s=this.getLabels();for(n=0,i=s.length;n<i;++n)t.push(Wc(this,s[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Ou(t.sort(Fv))}}Ni.id="time";Ni.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};function hs(e,t,n){let i=0,s=e.length-1,r,o,a,l;n?(t>=e[i].pos&&t<=e[s].pos&&({lo:i,hi:s}=se(e,"pos",t)),{pos:r,time:a}=e[i],{pos:o,time:l}=e[s]):(t>=e[i].time&&t<=e[s].time&&({lo:i,hi:s}=se(e,"time",t)),{time:r,pos:a}=e[i],{time:o,pos:l}=e[s]);const c=o-r;return c?a+(l-a)*(t-r)/c:a}class Pa extends Ni{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=hs(n,this.min),this._tableRange=hs(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:i}=this,s=[],r=[];let o,a,l,c,h;for(o=0,a=t.length;o<a;++o)c=t[o],c>=n&&c<=i&&s.push(c);if(s.length<2)return[{time:n,pos:0},{time:i,pos:1}];for(o=0,a=s.length;o<a;++o)h=s[o+1],l=s[o-1],c=s[o],Math.round((h+l)/2)!==c&&r.push({time:c,pos:o/(a-1)});return r}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),i=this.getLabelTimestamps();return n.length&&i.length?t=this.normalize(n.concat(i)):t=n.length?n:i,t=this._cache.all=t,t}getDecimalForValue(t){return(hs(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,i=this.getDecimalForPixel(t)/n.factor-n.end;return hs(this._table,i*this._tableRange+this._minPos,!0)}}Pa.id="timeseries";Pa.defaults=Ni.defaults;var jv=Object.freeze({__proto__:null,CategoryScale:Ps,LinearScale:ka,LogarithmicScale:Oa,RadialLinearScale:Li,TimeScale:Ni,TimeSeriesScale:Pa});const zv=[Ty,Nb,xv,jv];var Uv=typeof global=="object"&&global&&global.Object===Object&&global,Ed=Uv,Hv=typeof self=="object"&&self&&self.Object===Object&&self,Wv=Ed||Hv||Function("return this")(),Qt=Wv,Kv=Qt.Symbol,be=Kv,Td=Object.prototype,qv=Td.hasOwnProperty,Gv=Td.toString,Kn=be?be.toStringTag:void 0;function Yv(e){var t=qv.call(e,Kn),n=e[Kn];try{e[Kn]=void 0;var i=!0}catch{}var s=Gv.call(e);return i&&(t?e[Kn]=n:delete e[Kn]),s}var Xv=Object.prototype,Qv=Xv.toString;function Jv(e){return Qv.call(e)}var Zv="[object Null]",t0="[object Undefined]",Yc=be?be.toStringTag:void 0;function Fi(e){return e==null?e===void 0?t0:Zv:Yc&&Yc in Object(e)?Yv(e):Jv(e)}function We(e){return e!=null&&typeof e=="object"}var e0=Array.isArray,_n=e0;function Bi(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var n0="[object AsyncFunction]",i0="[object Function]",s0="[object GeneratorFunction]",r0="[object Proxy]";function Cd(e){if(!Bi(e))return!1;var t=Fi(e);return t==i0||t==s0||t==n0||t==r0}var o0=Qt["__core-js_shared__"],so=o0,Xc=function(){var e=/[^.]+$/.exec(so&&so.keys&&so.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function a0(e){return!!Xc&&Xc in e}var l0=Function.prototype,c0=l0.toString;function tn(e){if(e!=null){try{return c0.call(e)}catch{}try{return e+""}catch{}}return""}var h0=/[\\^$.*+?()[\]{}|]/g,u0=/^\[object .+?Constructor\]$/,d0=Function.prototype,f0=Object.prototype,g0=d0.toString,p0=f0.hasOwnProperty,m0=RegExp("^"+g0.call(p0).replace(h0,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function y0(e){if(!Bi(e)||a0(e))return!1;var t=Cd(e)?m0:u0;return t.test(tn(e))}function b0(e,t){return e==null?void 0:e[t]}function en(e,t){var n=b0(e,t);return y0(n)?n:void 0}var v0=en(Qt,"WeakMap"),Fo=v0,Qc=Object.create,_0=function(){function e(){}return function(t){if(!Bi(t))return{};if(Qc)return Qc(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),x0=_0;function w0(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}var S0=function(){try{var e=en(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Jc=S0;function E0(e,t){for(var n=-1,i=e==null?0:e.length;++n<i&&t(e[n],n,e)!==!1;);return e}var T0=9007199254740991,C0=/^(?:0|[1-9]\d*)$/;function A0(e,t){var n=typeof e;return t=t==null?T0:t,!!t&&(n=="number"||n!="symbol"&&C0.test(e))&&e>-1&&e%1==0&&e<t}function Ad(e,t,n){t=="__proto__"&&Jc?Jc(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Ra(e,t){return e===t||e!==e&&t!==t}var D0=Object.prototype,M0=D0.hasOwnProperty;function Dd(e,t,n){var i=e[t];(!(M0.call(e,t)&&Ra(i,n))||n===void 0&&!(t in e))&&Ad(e,t,n)}function fr(e,t,n,i){var s=!n;n||(n={});for(var r=-1,o=t.length;++r<o;){var a=t[r],l=i?i(n[a],e[a],a,n,e):void 0;l===void 0&&(l=e[a]),s?Ad(n,a,l):Dd(n,a,l)}return n}var I0=9007199254740991;function Md(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=I0}function La(e){return e!=null&&Md(e.length)&&!Cd(e)}var k0=Object.prototype;function gr(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||k0;return e===n}function O0(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}var P0="[object Arguments]";function Zc(e){return We(e)&&Fi(e)==P0}var Id=Object.prototype,R0=Id.hasOwnProperty,L0=Id.propertyIsEnumerable,N0=Zc(function(){return arguments}())?Zc:function(e){return We(e)&&R0.call(e,"callee")&&!L0.call(e,"callee")},kd=N0;function F0(){return!1}var Od=typeof exports=="object"&&exports&&!exports.nodeType&&exports,th=Od&&typeof module=="object"&&module&&!module.nodeType&&module,B0=th&&th.exports===Od,eh=B0?Qt.Buffer:void 0,V0=eh?eh.isBuffer:void 0,$0=V0||F0,yi=$0,j0="[object Arguments]",z0="[object Array]",U0="[object Boolean]",H0="[object Date]",W0="[object Error]",K0="[object Function]",q0="[object Map]",G0="[object Number]",Y0="[object Object]",X0="[object RegExp]",Q0="[object Set]",J0="[object String]",Z0="[object WeakMap]",t_="[object ArrayBuffer]",e_="[object DataView]",n_="[object Float32Array]",i_="[object Float64Array]",s_="[object Int8Array]",r_="[object Int16Array]",o_="[object Int32Array]",a_="[object Uint8Array]",l_="[object Uint8ClampedArray]",c_="[object Uint16Array]",h_="[object Uint32Array]",Z={};Z[n_]=Z[i_]=Z[s_]=Z[r_]=Z[o_]=Z[a_]=Z[l_]=Z[c_]=Z[h_]=!0;Z[j0]=Z[z0]=Z[t_]=Z[U0]=Z[e_]=Z[H0]=Z[W0]=Z[K0]=Z[q0]=Z[G0]=Z[Y0]=Z[X0]=Z[Q0]=Z[J0]=Z[Z0]=!1;function u_(e){return We(e)&&Md(e.length)&&!!Z[Fi(e)]}function Na(e){return function(t){return e(t)}}var Pd=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ri=Pd&&typeof module=="object"&&module&&!module.nodeType&&module,d_=ri&&ri.exports===Pd,ro=d_&&Ed.process,f_=function(){try{var e=ri&&ri.require&&ri.require("util").types;return e||ro&&ro.binding&&ro.binding("util")}catch{}}(),xn=f_,nh=xn&&xn.isTypedArray,g_=nh?Na(nh):u_,Fa=g_,p_=Object.prototype,m_=p_.hasOwnProperty;function Rd(e,t){var n=_n(e),i=!n&&kd(e),s=!n&&!i&&yi(e),r=!n&&!i&&!s&&Fa(e),o=n||i||s||r,a=o?O0(e.length,String):[],l=a.length;for(var c in e)(t||m_.call(e,c))&&!(o&&(c=="length"||s&&(c=="offset"||c=="parent")||r&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||A0(c,l)))&&a.push(c);return a}function Ld(e,t){return function(n){return e(t(n))}}var y_=Ld(Object.keys,Object),b_=y_,v_=Object.prototype,__=v_.hasOwnProperty;function Nd(e){if(!gr(e))return b_(e);var t=[];for(var n in Object(e))__.call(e,n)&&n!="constructor"&&t.push(n);return t}function Ba(e){return La(e)?Rd(e):Nd(e)}function x_(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var w_=Object.prototype,S_=w_.hasOwnProperty;function E_(e){if(!Bi(e))return x_(e);var t=gr(e),n=[];for(var i in e)i=="constructor"&&(t||!S_.call(e,i))||n.push(i);return n}function Va(e){return La(e)?Rd(e,!0):E_(e)}var T_=en(Object,"create"),bi=T_;function C_(){this.__data__=bi?bi(null):{},this.size=0}function A_(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var D_="__lodash_hash_undefined__",M_=Object.prototype,I_=M_.hasOwnProperty;function k_(e){var t=this.__data__;if(bi){var n=t[e];return n===D_?void 0:n}return I_.call(t,e)?t[e]:void 0}var O_=Object.prototype,P_=O_.hasOwnProperty;function R_(e){var t=this.__data__;return bi?t[e]!==void 0:P_.call(t,e)}var L_="__lodash_hash_undefined__";function N_(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=bi&&t===void 0?L_:t,this}function Ke(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Ke.prototype.clear=C_;Ke.prototype.delete=A_;Ke.prototype.get=k_;Ke.prototype.has=R_;Ke.prototype.set=N_;function F_(){this.__data__=[],this.size=0}function pr(e,t){for(var n=e.length;n--;)if(Ra(e[n][0],t))return n;return-1}var B_=Array.prototype,V_=B_.splice;function $_(e){var t=this.__data__,n=pr(t,e);if(n<0)return!1;var i=t.length-1;return n==i?t.pop():V_.call(t,n,1),--this.size,!0}function j_(e){var t=this.__data__,n=pr(t,e);return n<0?void 0:t[n][1]}function z_(e){return pr(this.__data__,e)>-1}function U_(e,t){var n=this.__data__,i=pr(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}function he(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}he.prototype.clear=F_;he.prototype.delete=$_;he.prototype.get=j_;he.prototype.has=z_;he.prototype.set=U_;var H_=en(Qt,"Map"),vi=H_;function W_(){this.size=0,this.__data__={hash:new Ke,map:new(vi||he),string:new Ke}}function K_(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function mr(e,t){var n=e.__data__;return K_(t)?n[typeof t=="string"?"string":"hash"]:n.map}function q_(e){var t=mr(this,e).delete(e);return this.size-=t?1:0,t}function G_(e){return mr(this,e).get(e)}function Y_(e){return mr(this,e).has(e)}function X_(e,t){var n=mr(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}function nn(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}nn.prototype.clear=W_;nn.prototype.delete=q_;nn.prototype.get=G_;nn.prototype.has=Y_;nn.prototype.set=X_;function Fd(e,t){for(var n=-1,i=t.length,s=e.length;++n<i;)e[s+n]=t[n];return e}var Q_=Ld(Object.getPrototypeOf,Object),Bd=Q_;function J_(){this.__data__=new he,this.size=0}function Z_(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function tx(e){return this.__data__.get(e)}function ex(e){return this.__data__.has(e)}var nx=200;function ix(e,t){var n=this.__data__;if(n instanceof he){var i=n.__data__;if(!vi||i.length<nx-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new nn(i)}return n.set(e,t),this.size=n.size,this}function oe(e){var t=this.__data__=new he(e);this.size=t.size}oe.prototype.clear=J_;oe.prototype.delete=Z_;oe.prototype.get=tx;oe.prototype.has=ex;oe.prototype.set=ix;function sx(e,t){return e&&fr(t,Ba(t),e)}function rx(e,t){return e&&fr(t,Va(t),e)}var Vd=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ih=Vd&&typeof module=="object"&&module&&!module.nodeType&&module,ox=ih&&ih.exports===Vd,sh=ox?Qt.Buffer:void 0,rh=sh?sh.allocUnsafe:void 0;function ax(e,t){if(t)return e.slice();var n=e.length,i=rh?rh(n):new e.constructor(n);return e.copy(i),i}function lx(e,t){for(var n=-1,i=e==null?0:e.length,s=0,r=[];++n<i;){var o=e[n];t(o,n,e)&&(r[s++]=o)}return r}function $d(){return[]}var cx=Object.prototype,hx=cx.propertyIsEnumerable,oh=Object.getOwnPropertySymbols,ux=oh?function(e){return e==null?[]:(e=Object(e),lx(oh(e),function(t){return hx.call(e,t)}))}:$d,$a=ux;function dx(e,t){return fr(e,$a(e),t)}var fx=Object.getOwnPropertySymbols,gx=fx?function(e){for(var t=[];e;)Fd(t,$a(e)),e=Bd(e);return t}:$d,jd=gx;function px(e,t){return fr(e,jd(e),t)}function zd(e,t,n){var i=t(e);return _n(e)?i:Fd(i,n(e))}function Bo(e){return zd(e,Ba,$a)}function mx(e){return zd(e,Va,jd)}var yx=en(Qt,"DataView"),Vo=yx,bx=en(Qt,"Promise"),$o=bx,vx=en(Qt,"Set"),jo=vx,ah="[object Map]",_x="[object Object]",lh="[object Promise]",ch="[object Set]",hh="[object WeakMap]",uh="[object DataView]",xx=tn(Vo),wx=tn(vi),Sx=tn($o),Ex=tn(jo),Tx=tn(Fo),Oe=Fi;(Vo&&Oe(new Vo(new ArrayBuffer(1)))!=uh||vi&&Oe(new vi)!=ah||$o&&Oe($o.resolve())!=lh||jo&&Oe(new jo)!=ch||Fo&&Oe(new Fo)!=hh)&&(Oe=function(e){var t=Fi(e),n=t==_x?e.constructor:void 0,i=n?tn(n):"";if(i)switch(i){case xx:return uh;case wx:return ah;case Sx:return lh;case Ex:return ch;case Tx:return hh}return t});var wn=Oe,Cx=Object.prototype,Ax=Cx.hasOwnProperty;function Dx(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&Ax.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var Mx=Qt.Uint8Array,Ls=Mx;function ja(e){var t=new e.constructor(e.byteLength);return new Ls(t).set(new Ls(e)),t}function Ix(e,t){var n=t?ja(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var kx=/\w*$/;function Ox(e){var t=new e.constructor(e.source,kx.exec(e));return t.lastIndex=e.lastIndex,t}var dh=be?be.prototype:void 0,fh=dh?dh.valueOf:void 0;function Px(e){return fh?Object(fh.call(e)):{}}function Rx(e,t){var n=t?ja(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var Lx="[object Boolean]",Nx="[object Date]",Fx="[object Map]",Bx="[object Number]",Vx="[object RegExp]",$x="[object Set]",jx="[object String]",zx="[object Symbol]",Ux="[object ArrayBuffer]",Hx="[object DataView]",Wx="[object Float32Array]",Kx="[object Float64Array]",qx="[object Int8Array]",Gx="[object Int16Array]",Yx="[object Int32Array]",Xx="[object Uint8Array]",Qx="[object Uint8ClampedArray]",Jx="[object Uint16Array]",Zx="[object Uint32Array]";function tw(e,t,n){var i=e.constructor;switch(t){case Ux:return ja(e);case Lx:case Nx:return new i(+e);case Hx:return Ix(e,n);case Wx:case Kx:case qx:case Gx:case Yx:case Xx:case Qx:case Jx:case Zx:return Rx(e,n);case Fx:return new i;case Bx:case jx:return new i(e);case Vx:return Ox(e);case $x:return new i;case zx:return Px(e)}}function ew(e){return typeof e.constructor=="function"&&!gr(e)?x0(Bd(e)):{}}var nw="[object Map]";function iw(e){return We(e)&&wn(e)==nw}var gh=xn&&xn.isMap,sw=gh?Na(gh):iw,rw=sw,ow="[object Set]";function aw(e){return We(e)&&wn(e)==ow}var ph=xn&&xn.isSet,lw=ph?Na(ph):aw,cw=lw,hw=1,uw=2,dw=4,Ud="[object Arguments]",fw="[object Array]",gw="[object Boolean]",pw="[object Date]",mw="[object Error]",Hd="[object Function]",yw="[object GeneratorFunction]",bw="[object Map]",vw="[object Number]",Wd="[object Object]",_w="[object RegExp]",xw="[object Set]",ww="[object String]",Sw="[object Symbol]",Ew="[object WeakMap]",Tw="[object ArrayBuffer]",Cw="[object DataView]",Aw="[object Float32Array]",Dw="[object Float64Array]",Mw="[object Int8Array]",Iw="[object Int16Array]",kw="[object Int32Array]",Ow="[object Uint8Array]",Pw="[object Uint8ClampedArray]",Rw="[object Uint16Array]",Lw="[object Uint32Array]",X={};X[Ud]=X[fw]=X[Tw]=X[Cw]=X[gw]=X[pw]=X[Aw]=X[Dw]=X[Mw]=X[Iw]=X[kw]=X[bw]=X[vw]=X[Wd]=X[_w]=X[xw]=X[ww]=X[Sw]=X[Ow]=X[Pw]=X[Rw]=X[Lw]=!0;X[mw]=X[Hd]=X[Ew]=!1;function _s(e,t,n,i,s,r){var o,a=t&hw,l=t&uw,c=t&dw;if(n&&(o=s?n(e,i,s,r):n(e)),o!==void 0)return o;if(!Bi(e))return e;var h=_n(e);if(h){if(o=Dx(e),!a)return w0(e,o)}else{var u=wn(e),d=u==Hd||u==yw;if(yi(e))return ax(e,a);if(u==Wd||u==Ud||d&&!s){if(o=l||d?{}:ew(e),!a)return l?px(e,rx(o,e)):dx(e,sx(o,e))}else{if(!X[u])return s?e:{};o=tw(e,u,a)}}r||(r=new oe);var f=r.get(e);if(f)return f;r.set(e,o),cw(e)?e.forEach(function(m){o.add(_s(m,t,n,m,e,r))}):rw(e)&&e.forEach(function(m,y){o.set(y,_s(m,t,n,y,e,r))});var g=c?l?mx:Bo:l?Va:Ba,p=h?void 0:g(e);return E0(p||e,function(m,y){p&&(y=m,m=e[y]),Dd(o,y,_s(m,t,n,y,e,r))}),o}var Nw=1,Fw=4;function qn(e){return _s(e,Nw|Fw)}var Bw="__lodash_hash_undefined__";function Vw(e){return this.__data__.set(e,Bw),this}function $w(e){return this.__data__.has(e)}function Ns(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new nn;++t<n;)this.add(e[t])}Ns.prototype.add=Ns.prototype.push=Vw;Ns.prototype.has=$w;function jw(e,t){for(var n=-1,i=e==null?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}function zw(e,t){return e.has(t)}var Uw=1,Hw=2;function Kd(e,t,n,i,s,r){var o=n&Uw,a=e.length,l=t.length;if(a!=l&&!(o&&l>a))return!1;var c=r.get(e),h=r.get(t);if(c&&h)return c==t&&h==e;var u=-1,d=!0,f=n&Hw?new Ns:void 0;for(r.set(e,t),r.set(t,e);++u<a;){var g=e[u],p=t[u];if(i)var m=o?i(p,g,u,t,e,r):i(g,p,u,e,t,r);if(m!==void 0){if(m)continue;d=!1;break}if(f){if(!jw(t,function(y,b){if(!zw(f,b)&&(g===y||s(g,y,n,i,r)))return f.push(b)})){d=!1;break}}else if(!(g===p||s(g,p,n,i,r))){d=!1;break}}return r.delete(e),r.delete(t),d}function Ww(e){var t=-1,n=Array(e.size);return e.forEach(function(i,s){n[++t]=[s,i]}),n}function Kw(e){var t=-1,n=Array(e.size);return e.forEach(function(i){n[++t]=i}),n}var qw=1,Gw=2,Yw="[object Boolean]",Xw="[object Date]",Qw="[object Error]",Jw="[object Map]",Zw="[object Number]",tS="[object RegExp]",eS="[object Set]",nS="[object String]",iS="[object Symbol]",sS="[object ArrayBuffer]",rS="[object DataView]",mh=be?be.prototype:void 0,oo=mh?mh.valueOf:void 0;function oS(e,t,n,i,s,r,o){switch(n){case rS:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case sS:return!(e.byteLength!=t.byteLength||!r(new Ls(e),new Ls(t)));case Yw:case Xw:case Zw:return Ra(+e,+t);case Qw:return e.name==t.name&&e.message==t.message;case tS:case nS:return e==t+"";case Jw:var a=Ww;case eS:var l=i&qw;if(a||(a=Kw),e.size!=t.size&&!l)return!1;var c=o.get(e);if(c)return c==t;i|=Gw,o.set(e,t);var h=Kd(a(e),a(t),i,s,r,o);return o.delete(e),h;case iS:if(oo)return oo.call(e)==oo.call(t)}return!1}var aS=1,lS=Object.prototype,cS=lS.hasOwnProperty;function hS(e,t,n,i,s,r){var o=n&aS,a=Bo(e),l=a.length,c=Bo(t),h=c.length;if(l!=h&&!o)return!1;for(var u=l;u--;){var d=a[u];if(!(o?d in t:cS.call(t,d)))return!1}var f=r.get(e),g=r.get(t);if(f&&g)return f==t&&g==e;var p=!0;r.set(e,t),r.set(t,e);for(var m=o;++u<l;){d=a[u];var y=e[d],b=t[d];if(i)var _=o?i(b,y,d,t,e,r):i(y,b,d,e,t,r);if(!(_===void 0?y===b||s(y,b,n,i,r):_)){p=!1;break}m||(m=d=="constructor")}if(p&&!m){var x=e.constructor,v=t.constructor;x!=v&&"constructor"in e&&"constructor"in t&&!(typeof x=="function"&&x instanceof x&&typeof v=="function"&&v instanceof v)&&(p=!1)}return r.delete(e),r.delete(t),p}var uS=1,yh="[object Arguments]",bh="[object Array]",us="[object Object]",dS=Object.prototype,vh=dS.hasOwnProperty;function fS(e,t,n,i,s,r){var o=_n(e),a=_n(t),l=o?bh:wn(e),c=a?bh:wn(t);l=l==yh?us:l,c=c==yh?us:c;var h=l==us,u=c==us,d=l==c;if(d&&yi(e)){if(!yi(t))return!1;o=!0,h=!1}if(d&&!h)return r||(r=new oe),o||Fa(e)?Kd(e,t,n,i,s,r):oS(e,t,l,n,i,s,r);if(!(n&uS)){var f=h&&vh.call(e,"__wrapped__"),g=u&&vh.call(t,"__wrapped__");if(f||g){var p=f?e.value():e,m=g?t.value():t;return r||(r=new oe),s(p,m,n,i,r)}}return d?(r||(r=new oe),hS(e,t,n,i,s,r)):!1}function qd(e,t,n,i,s){return e===t?!0:e==null||t==null||!We(e)&&!We(t)?e!==e&&t!==t:fS(e,t,n,i,qd,s)}var gS="[object Map]",pS="[object Set]",mS=Object.prototype,yS=mS.hasOwnProperty;function bS(e){if(e==null)return!0;if(La(e)&&(_n(e)||typeof e=="string"||typeof e.splice=="function"||yi(e)||Fa(e)||kd(e)))return!e.length;var t=wn(e);if(t==gS||t==pS)return!e.size;if(gr(e))return!Nd(e).length;for(var n in e)if(yS.call(e,n))return!1;return!0}function _h(e,t){return qd(e,t)}var vS=Object.defineProperty,_S=Object.defineProperties,xS=Object.getOwnPropertyDescriptors,xh=Object.getOwnPropertySymbols,wS=Object.prototype.hasOwnProperty,SS=Object.prototype.propertyIsEnumerable,wh=(e,t,n)=>t in e?vS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xs=(e,t)=>{for(var n in t||(t={}))wS.call(t,n)&&wh(e,n,t[n]);if(xh)for(var n of xh(t))SS.call(t,n)&&wh(e,n,t[n]);return e},Gd=(e,t)=>_S(e,xS(t));function Yd(e){return(e.match(/[a-zA-Z0-9]+/g)||[]).map(t=>`${t.charAt(0).toUpperCase()}${t.slice(1)}`).join("")}var Ee=(e,t)=>{const n={chartData:{type:Object,required:!0},options:{type:Object,required:!1},chartId:{default:e,type:String},width:{default:400,type:Number},height:{default:400,type:Number},cssClasses:{type:String,default:""},styles:{type:Object},plugins:{type:Array,default:()=>[]},onLabelsUpdate:{type:Function},onChartUpdate:{type:Function},onChartDestroy:{type:Function},onChartRender:{type:Function}},i=Yd(e);return Tu({name:i,props:n,emits:{"labels:update":()=>!0,"chart:update":s=>!0,"chart:destroy":()=>!0,"chart:render":s=>!0},setup(s,{emit:r,expose:o}){const a=ee(null),l=`${s.chartId}`;let c=qg(null);kl(()=>s.chartData,h,{deep:!0}),kl(()=>s.options,m=>{c.value&&m&&(c.value.options=qn(m),g())},{deep:!0});function h(m){if(c.value){let y=c.value;_h(m.labels,c.value.data.labels)||(y.data.labels=m.labels,d()),_h(m.datasets,c.value.data.datasets)||m.datasets.forEach((b,_)=>{var x,v;if(bS(b))y.data.datasets=[];else{const E=qn(y.data),S=Object.keys((v=(x=E.datasets)==null?void 0:x[_])!=null?v:{}),D=Object.keys(b);S.filter(R=>R!=="_meta"&&D.indexOf(R)===-1).forEach(R=>{y.data.datasets[_]&&delete y.data.datasets[_][R]});for(const R in b){const j=qn(b[R]);y.data.datasets[_]||(y.data.datasets[_]={}),b.hasOwnProperty(R)&&j!=null&&y&&(y.data.datasets[_][R]=j)}}}),g()}else c.value&&p(),u()}function u(){a.value?(c.value=new lr(a.value,{data:qn(s.chartData),type:t,options:qn(s.options),plugins:s.plugins}),f()):console.error(`Error on component ${i}, canvas cannot be rendered. Check if the render appends server-side`)}function d(){r("labels:update"),s.onLabelsUpdate&&s.onLabelsUpdate()}function f(){c.value&&(r("chart:render",c.value),s.onChartRender&&s.onChartRender(c.value))}function g(){c.value&&(c.value.update(),r("chart:update",c.value),s.onChartUpdate&&s.onChartUpdate(c.value))}function p(){c.value&&c.value.destroy(),r("chart:destroy"),s.onChartDestroy&&s.onChartDestroy()}return Cu(u),Gg(()=>{c.value&&c.value.destroy()}),o({canvasRef:a,renderChart:u,chartInstance:c,canvasId:l,update:g}),()=>Ol("div",{style:Gd(xs({maxWidth:"100%"},s.styles),{position:"relative"}),class:s.cssClasses},[Ol("canvas",{style:{maxWidth:"100%",maxHeight:"100%"},id:l,width:s.width,height:s.height,ref:a})])}})},ES=e=>t=>{const n=`${e}ChartRef`,i={[n]:ee()},s=Eo(()=>Gd(xs(xs(xs({},t),t.jsx&&{ref:i[n]}),!t.jsx&&{ref:n}),{chartData:Pl(t.chartData),options:Pl(t.options)}));function r(){var o;const a=i[n].value;a?(o=a==null?void 0:a.chartInstance.value)==null||o.update():console.warn(`No chartInstance to update (use${Yd(e)}Chart)`)}return{[`${e}ChartProps`]:s,[n]:i[n],update:r}},TS=Ee("bar-chart","bar");Ee("doughnut-chart","doughnut");Ee("line-chart","line");Ee("pie-chart","pie");Ee("polar-chart","polarArea");Ee("radar-chart","radar");Ee("bubble-chart","bubble");Ee("scatter-chart","scatter");var CS=ES("bar");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xd=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let s=e.charCodeAt(i);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=s&63|128):(s&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++i)&1023),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=s&63|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=s&63|128)}return t},AS=function(e){const t=[];let n=0,i=0;for(;n<e.length;){const s=e[n++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=e[n++];t[i++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=e[n++],o=e[n++],a=e[n++],l=((s&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{const r=e[n++],o=e[n++];t[i++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return t.join("")},DS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<e.length;s+=3){const r=e[s],o=s+1<e.length,a=o?e[s+1]:0,l=s+2<e.length,c=l?e[s+2]:0,h=r>>2,u=(r&3)<<4|a>>4;let d=(a&15)<<2|c>>6,f=c&63;l||(f=64,o||(d=64)),i.push(n[h],n[u],n[d],n[f])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Xd(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):AS(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<e.length;){const r=n[e.charAt(s++)],a=s<e.length?n[e.charAt(s)]:0;++s;const c=s<e.length?n[e.charAt(s)]:64;++s;const u=s<e.length?n[e.charAt(s)]:64;if(++s,r==null||a==null||c==null||u==null)throw Error();const d=r<<2|a>>4;if(i.push(d),c!==64){const f=a<<4&240|c>>2;if(i.push(f),u!==64){const g=c<<6&192|u;i.push(g)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},MS=function(e){const t=Xd(e);return DS.encodeByteArray(t,!0)},Qd=function(e){return MS(e).replace(/\./g,"")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,i))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yr(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kS(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(yr())}function OS(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function PS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function RS(){return yr().indexOf("Electron/")>=0}function LS(){const e=yr();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function NS(){return yr().indexOf("MSAppHost/")>=0}function FS(){return typeof indexedDB=="object"}function BS(){return new Promise((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var r;t(((r=s.error)===null||r===void 0?void 0:r.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VS="FirebaseError";class kn extends Error{constructor(t,n,i){super(n),this.code=t,this.customData=i,this.name=VS,Object.setPrototypeOf(this,kn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Jd.prototype.create)}}class Jd{constructor(t,n,i){this.service=t,this.serviceName=n,this.errors=i}create(t,...n){const i=n[0]||{},s=`${this.service}/${t}`,r=this.errors[t],o=r?$S(r,i):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new kn(s,a,i)}}function $S(e,t){return e.replace(jS,(n,i)=>{const s=t[i];return s!=null?String(s):`<${i}?>`})}const jS=/\{\$([^}]+)}/g;function zo(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const s of n){if(!i.includes(s))return!1;const r=e[s],o=t[s];if(Sh(r)&&Sh(o)){if(!zo(r,o))return!1}else if(r!==o)return!1}for(const s of i)if(!n.includes(s))return!1;return!0}function Sh(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zS(e){return e&&e._delegate?e._delegate:e}class _i{constructor(t,n,i){this.name=t,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pe="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const i=new IS;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(WS(t))try{this.getOrInitializeService({instanceIdentifier:Pe})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:s});i.resolve(r)}catch{}}}}clearInstance(t=Pe){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Pe){return this.instances.has(t)}getOptions(t=Pe){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&o.resolve(s)}return s}onInit(t,n){var i;const s=this.normalizeInstanceIdentifier(n),r=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;r.add(t),this.onInitCallbacks.set(s,r);const o=this.instances.get(s);return o&&t(o,s),()=>{r.delete(t)}}invokeOnInitCallbacks(t,n){const i=this.onInitCallbacks.get(n);if(!!i)for(const s of i)try{s(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:HS(t),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Pe){return this.component?this.component.multipleInstances?t:Pe:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function HS(e){return e===Pe?void 0:e}function WS(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new US(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var K;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(K||(K={}));const qS={debug:K.DEBUG,verbose:K.VERBOSE,info:K.INFO,warn:K.WARN,error:K.ERROR,silent:K.SILENT},GS=K.INFO,YS={[K.DEBUG]:"log",[K.VERBOSE]:"log",[K.INFO]:"info",[K.WARN]:"warn",[K.ERROR]:"error"},XS=(e,t,...n)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),s=YS[t];if(s)console[s](`[${i}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Zd{constructor(t){this.name=t,this._logLevel=GS,this._logHandler=XS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in K))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?qS[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,K.DEBUG,...t),this._logHandler(this,K.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,K.VERBOSE,...t),this._logHandler(this,K.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,K.INFO,...t),this._logHandler(this,K.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,K.WARN,...t),this._logHandler(this,K.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,K.ERROR,...t),this._logHandler(this,K.ERROR,...t)}}const QS=(e,t)=>t.some(n=>e instanceof n);let Eh,Th;function JS(){return Eh||(Eh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZS(){return Th||(Th=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const tf=new WeakMap,Uo=new WeakMap,ef=new WeakMap,ao=new WeakMap,za=new WeakMap;function tE(e){const t=new Promise((n,i)=>{const s=()=>{e.removeEventListener("success",r),e.removeEventListener("error",o)},r=()=>{n(pe(e.result)),s()},o=()=>{i(e.error),s()};e.addEventListener("success",r),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&tf.set(n,e)}).catch(()=>{}),za.set(t,e),t}function eE(e){if(Uo.has(e))return;const t=new Promise((n,i)=>{const s=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",o),e.removeEventListener("abort",o)},r=()=>{n(),s()},o=()=>{i(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",r),e.addEventListener("error",o),e.addEventListener("abort",o)});Uo.set(e,t)}let Ho={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Uo.get(e);if(t==="objectStoreNames")return e.objectStoreNames||ef.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return pe(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function nE(e){Ho=e(Ho)}function iE(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const i=e.call(lo(this),t,...n);return ef.set(i,t.sort?t.sort():[t]),pe(i)}:ZS().includes(e)?function(...t){return e.apply(lo(this),t),pe(tf.get(this))}:function(...t){return pe(e.apply(lo(this),t))}}function sE(e){return typeof e=="function"?iE(e):(e instanceof IDBTransaction&&eE(e),QS(e,JS())?new Proxy(e,Ho):e)}function pe(e){if(e instanceof IDBRequest)return tE(e);if(ao.has(e))return ao.get(e);const t=sE(e);return t!==e&&(ao.set(e,t),za.set(t,e)),t}const lo=e=>za.get(e);function rE(e,t,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(e,t),a=pe(o);return i&&o.addEventListener("upgradeneeded",l=>{i(pe(o.result),l.oldVersion,l.newVersion,pe(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(l=>{r&&l.addEventListener("close",()=>r()),s&&l.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}const oE=["get","getKey","getAll","getAllKeys","count"],aE=["put","add","delete","clear"],co=new Map;function Ch(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(co.get(t))return co.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,s=aE.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(s||oE.includes(n)))return;const r=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return co.set(t,r),r}nE(e=>({...e,get:(t,n,i)=>Ch(t,n)||e.get(t,n,i),has:(t,n)=>!!Ch(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(cE(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function cE(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Wo="@firebase/app",Ah="0.7.31";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qe=new Zd("@firebase/app"),hE="@firebase/app-compat",uE="@firebase/analytics-compat",dE="@firebase/analytics",fE="@firebase/app-check-compat",gE="@firebase/app-check",pE="@firebase/auth",mE="@firebase/auth-compat",yE="@firebase/database",bE="@firebase/database-compat",vE="@firebase/functions",_E="@firebase/functions-compat",xE="@firebase/installations",wE="@firebase/installations-compat",SE="@firebase/messaging",EE="@firebase/messaging-compat",TE="@firebase/performance",CE="@firebase/performance-compat",AE="@firebase/remote-config",DE="@firebase/remote-config-compat",ME="@firebase/storage",IE="@firebase/storage-compat",kE="@firebase/firestore",OE="@firebase/firestore-compat",PE="firebase",RE="9.9.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nf="[DEFAULT]",LE={[Wo]:"fire-core",[hE]:"fire-core-compat",[dE]:"fire-analytics",[uE]:"fire-analytics-compat",[gE]:"fire-app-check",[fE]:"fire-app-check-compat",[pE]:"fire-auth",[mE]:"fire-auth-compat",[yE]:"fire-rtdb",[bE]:"fire-rtdb-compat",[vE]:"fire-fn",[_E]:"fire-fn-compat",[xE]:"fire-iid",[wE]:"fire-iid-compat",[SE]:"fire-fcm",[EE]:"fire-fcm-compat",[TE]:"fire-perf",[CE]:"fire-perf-compat",[AE]:"fire-rc",[DE]:"fire-rc-compat",[ME]:"fire-gcs",[IE]:"fire-gcs-compat",[kE]:"fire-fst",[OE]:"fire-fst-compat","fire-js":"fire-js",[PE]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fs=new Map,Ko=new Map;function NE(e,t){try{e.container.addComponent(t)}catch(n){qe.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Bs(e){const t=e.name;if(Ko.has(t))return qe.debug(`There were multiple attempts to register component ${t}.`),!1;Ko.set(t,e);for(const n of Fs.values())NE(n,e);return!0}function FE(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BE={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Ge=new Jd("app","Firebase",BE);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(t,n,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new _i("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Ge.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $E=RE;function jE(e,t={}){typeof t!="object"&&(t={name:t});const n=Object.assign({name:nf,automaticDataCollectionEnabled:!1},t),i=n.name;if(typeof i!="string"||!i)throw Ge.create("bad-app-name",{appName:String(i)});const s=Fs.get(i);if(s){if(zo(e,s.options)&&zo(n,s.config))return s;throw Ge.create("duplicate-app",{appName:i})}const r=new KS(i);for(const a of Ko.values())r.addComponent(a);const o=new VE(e,n,r);return Fs.set(i,o),o}function zE(e=nf){const t=Fs.get(e);if(!t)throw Ge.create("no-app",{appName:e});return t}function fn(e,t,n){var i;let s=(i=LE[e])!==null&&i!==void 0?i:e;n&&(s+=`-${n}`);const r=s.match(/\s|\//),o=t.match(/\s|\//);if(r||o){const a=[`Unable to register library "${s}" with version "${t}":`];r&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),qe.warn(a.join(" "));return}Bs(new _i(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UE="firebase-heartbeat-database",HE=1,xi="firebase-heartbeat-store";let ho=null;function sf(){return ho||(ho=rE(UE,HE,{upgrade:(e,t)=>{switch(t){case 0:e.createObjectStore(xi)}}}).catch(e=>{throw Ge.create("idb-open",{originalErrorMessage:e.message})})),ho}async function WE(e){var t;try{return(await sf()).transaction(xi).objectStore(xi).get(rf(e))}catch(n){if(n instanceof kn)qe.warn(n.message);else{const i=Ge.create("idb-get",{originalErrorMessage:(t=n)===null||t===void 0?void 0:t.message});qe.warn(i.message)}}}async function Dh(e,t){var n;try{const s=(await sf()).transaction(xi,"readwrite");return await s.objectStore(xi).put(t,rf(e)),s.done}catch(i){if(i instanceof kn)qe.warn(i.message);else{const s=Ge.create("idb-set",{originalErrorMessage:(n=i)===null||n===void 0?void 0:n.message});qe.warn(s.message)}}}function rf(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE=1024,qE=30*24*60*60*1e3;class GE{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new XE(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Mh();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(s=>s.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const r=new Date(s.date).valueOf();return Date.now()-r<=qE}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Mh(),{heartbeatsToSend:n,unsentEntries:i}=YE(this._heartbeatsCache.heartbeats),s=Qd(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Mh(){return new Date().toISOString().substring(0,10)}function YE(e,t=KE){const n=[];let i=e.slice();for(const s of e){const r=n.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),Ih(n)>t){r.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ih(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class XE{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return FS()?BS().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await WE(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Dh(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Dh(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function Ih(e){return Qd(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE(e){Bs(new _i("platform-logger",t=>new lE(t),"PRIVATE")),Bs(new _i("heartbeat",t=>new GE(t),"PRIVATE")),fn(Wo,Ah,e),fn(Wo,Ah,"esm2017"),fn("fire-js","")}QE("");var JE=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},C,Ua=Ua||{},O=JE||self;function Vs(){}function qo(e){var t=typeof e;return t=t!="object"?t:e?Array.isArray(e)?"array":t:"null",t=="array"||t=="object"&&typeof e.length=="number"}function Vi(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function ZE(e){return Object.prototype.hasOwnProperty.call(e,uo)&&e[uo]||(e[uo]=++tT)}var uo="closure_uid_"+(1e9*Math.random()>>>0),tT=0;function eT(e,t,n){return e.call.apply(e.bind,arguments)}function nT(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,i),e.apply(t,s)}}return function(){return e.apply(t,arguments)}}function _t(e,t,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_t=eT:_t=nT,_t.apply(null,arguments)}function ds(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var i=n.slice();return i.push.apply(i,arguments),e.apply(this,i)}}function St(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(i,s,r){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return t.prototype[s].apply(i,o)}}function Te(){this.s=this.s,this.o=this.o}var iT=0;Te.prototype.s=!1;Te.prototype.na=function(){!this.s&&(this.s=!0,this.M(),iT!=0)&&ZE(this)};Te.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const of=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(typeof e=="string")return typeof t!="string"||t.length!=1?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},af=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){const i=e.length,s=typeof e=="string"?e.split(""):e;for(let r=0;r<i;r++)r in s&&t.call(n,s[r],r,e)};function sT(e){t:{var t=YT;const n=e.length,i=typeof e=="string"?e.split(""):e;for(let s=0;s<n;s++)if(s in i&&t.call(void 0,i[s],s,e)){t=s;break t}t=-1}return 0>t?null:typeof e=="string"?e.charAt(t):e[t]}function kh(e){return Array.prototype.concat.apply([],arguments)}function Ha(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function $s(e){return/^[\s\xa0]*$/.test(e)}var Oh=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Mt(e,t){return e.indexOf(t)!=-1}function fo(e,t){return e<t?-1:e>t?1:0}var It;t:{var Ph=O.navigator;if(Ph){var Rh=Ph.userAgent;if(Rh){It=Rh;break t}}It=""}function Wa(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function lf(e){const t={};for(const n in e)t[n]=e[n];return t}var Lh="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function cf(e,t){let n,i;for(let s=1;s<arguments.length;s++){i=arguments[s];for(n in i)e[n]=i[n];for(let r=0;r<Lh.length;r++)n=Lh[r],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function Ka(e){return Ka[" "](e),e}Ka[" "]=Vs;function rT(e){var t=lT;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}var oT=Mt(It,"Opera"),Sn=Mt(It,"Trident")||Mt(It,"MSIE"),hf=Mt(It,"Edge"),Go=hf||Sn,uf=Mt(It,"Gecko")&&!(Mt(It.toLowerCase(),"webkit")&&!Mt(It,"Edge"))&&!(Mt(It,"Trident")||Mt(It,"MSIE"))&&!Mt(It,"Edge"),aT=Mt(It.toLowerCase(),"webkit")&&!Mt(It,"Edge");function df(){var e=O.document;return e?e.documentMode:void 0}var js;t:{var go="",po=function(){var e=It;if(uf)return/rv:([^\);]+)(\)|;)/.exec(e);if(hf)return/Edge\/([\d\.]+)/.exec(e);if(Sn)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(aT)return/WebKit\/(\S+)/.exec(e);if(oT)return/(?:Version)[ \/]?(\S+)/.exec(e)}();if(po&&(go=po?po[1]:""),Sn){var mo=df();if(mo!=null&&mo>parseFloat(go)){js=String(mo);break t}}js=go}var lT={};function cT(){return rT(function(){let e=0;const t=Oh(String(js)).split("."),n=Oh("9").split("."),i=Math.max(t.length,n.length);for(let o=0;e==0&&o<i;o++){var s=t[o]||"",r=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s[0].length==0&&r[0].length==0)break;e=fo(s[1].length==0?0:parseInt(s[1],10),r[1].length==0?0:parseInt(r[1],10))||fo(s[2].length==0,r[2].length==0)||fo(s[2],r[2]),s=s[3],r=r[3]}while(e==0)}return 0<=e})}var Yo;if(O.document&&Sn){var Nh=df();Yo=Nh||parseInt(js,10)||void 0}else Yo=void 0;var hT=Yo,uT=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{O.addEventListener("test",Vs,t),O.removeEventListener("test",Vs,t)}catch{}return e}();function Ct(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Ct.prototype.h=function(){this.defaultPrevented=!0};function wi(e,t){if(Ct.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(uf){t:{try{Ka(t.nodeName);var s=!0;break t}catch{}s=!1}s||(t=null)}}else n=="mouseover"?t=e.fromElement:n=="mouseout"&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:dT[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&wi.Z.h.call(this)}}St(wi,Ct);var dT={2:"touch",3:"pen",4:"mouse"};wi.prototype.h=function(){wi.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var $i="closure_listenable_"+(1e6*Math.random()|0),fT=0;function gT(e,t,n,i,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.ia=s,this.key=++fT,this.ca=this.fa=!1}function br(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function vr(e){this.src=e,this.g={},this.h=0}vr.prototype.add=function(e,t,n,i,s){var r=e.toString();e=this.g[r],e||(e=this.g[r]=[],this.h++);var o=Qo(e,t,i,s);return-1<o?(t=e[o],n||(t.fa=!1)):(t=new gT(t,this.src,r,!!i,s),t.fa=n,e.push(t)),t};function Xo(e,t){var n=t.type;if(n in e.g){var i=e.g[n],s=of(i,t),r;(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(br(t),e.g[n].length==0&&(delete e.g[n],e.h--))}}function Qo(e,t,n,i){for(var s=0;s<e.length;++s){var r=e[s];if(!r.ca&&r.listener==t&&r.capture==!!n&&r.ia==i)return s}return-1}var qa="closure_lm_"+(1e6*Math.random()|0),yo={};function ff(e,t,n,i,s){if(i&&i.once)return pf(e,t,n,i,s);if(Array.isArray(t)){for(var r=0;r<t.length;r++)ff(e,t[r],n,i,s);return null}return n=Xa(n),e&&e[$i]?e.N(t,n,Vi(i)?!!i.capture:!!i,s):gf(e,t,n,!1,i,s)}function gf(e,t,n,i,s,r){if(!t)throw Error("Invalid event type");var o=Vi(s)?!!s.capture:!!s,a=Ya(e);if(a||(e[qa]=a=new vr(e)),n=a.add(t,n,i,o,r),n.proxy)return n;if(i=pT(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)uT||(s=o),s===void 0&&(s=!1),e.addEventListener(t.toString(),i,s);else if(e.attachEvent)e.attachEvent(yf(t.toString()),i);else if(e.addListener&&e.removeListener)e.addListener(i);else throw Error("addEventListener and attachEvent are unavailable.");return n}function pT(){function e(n){return t.call(e.src,e.listener,n)}var t=mT;return e}function pf(e,t,n,i,s){if(Array.isArray(t)){for(var r=0;r<t.length;r++)pf(e,t[r],n,i,s);return null}return n=Xa(n),e&&e[$i]?e.O(t,n,Vi(i)?!!i.capture:!!i,s):gf(e,t,n,!0,i,s)}function mf(e,t,n,i,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)mf(e,t[r],n,i,s);else i=Vi(i)?!!i.capture:!!i,n=Xa(n),e&&e[$i]?(e=e.i,t=String(t).toString(),t in e.g&&(r=e.g[t],n=Qo(r,n,i,s),-1<n&&(br(r[n]),Array.prototype.splice.call(r,n,1),r.length==0&&(delete e.g[t],e.h--)))):e&&(e=Ya(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Qo(t,n,i,s)),(n=-1<e?t[e]:null)&&Ga(n))}function Ga(e){if(typeof e!="number"&&e&&!e.ca){var t=e.src;if(t&&t[$i])Xo(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(yf(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=Ya(t))?(Xo(n,e),n.h==0&&(n.src=null,t[qa]=null)):br(e)}}}function yf(e){return e in yo?yo[e]:yo[e]="on"+e}function mT(e,t){if(e.ca)e=!0;else{t=new wi(t,this);var n=e.listener,i=e.ia||e.src;e.fa&&Ga(e),e=n.call(i,t)}return e}function Ya(e){return e=e[qa],e instanceof vr?e:null}var bo="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xa(e){return typeof e=="function"?e:(e[bo]||(e[bo]=function(t){return e.handleEvent(t)}),e[bo])}function mt(){Te.call(this),this.i=new vr(this),this.P=this,this.I=null}St(mt,Te);mt.prototype[$i]=!0;mt.prototype.removeEventListener=function(e,t,n,i){mf(this,e,t,n,i)};function xt(e,t){var n,i=e.I;if(i)for(n=[];i;i=i.I)n.push(i);if(e=e.P,i=t.type||t,typeof t=="string")t=new Ct(t,e);else if(t instanceof Ct)t.target=t.target||e;else{var s=t;t=new Ct(i,e),cf(t,s)}if(s=!0,n)for(var r=n.length-1;0<=r;r--){var o=t.g=n[r];s=fs(o,i,!0,t)&&s}if(o=t.g=e,s=fs(o,i,!0,t)&&s,s=fs(o,i,!1,t)&&s,n)for(r=0;r<n.length;r++)o=t.g=n[r],s=fs(o,i,!1,t)&&s}mt.prototype.M=function(){if(mt.Z.M.call(this),this.i){var e=this.i,t;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)br(n[i]);delete e.g[t],e.h--}}this.I=null};mt.prototype.N=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)};mt.prototype.O=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};function fs(e,t,n,i){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();for(var s=!0,r=0;r<t.length;++r){var o=t[r];if(o&&!o.ca&&o.capture==n){var a=o.listener,l=o.ia||o.src;o.fa&&Xo(e.i,o),s=a.call(l,i)!==!1&&s}}return s&&!i.defaultPrevented}var Qa=O.JSON.stringify;function yT(){var e=vf;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}class bT{constructor(){this.h=this.g=null}add(t,n){const i=bf.get();i.set(t,n),this.h?this.h.next=i:this.g=i,this.h=i}}var bf=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new vT,e=>e.reset());class vT{constructor(){this.next=this.g=this.h=null}set(t,n){this.h=t,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function _T(e){O.setTimeout(()=>{throw e},0)}function Ja(e,t){Jo||xT(),Zo||(Jo(),Zo=!0),vf.add(e,t)}var Jo;function xT(){var e=O.Promise.resolve(void 0);Jo=function(){e.then(wT)}}var Zo=!1,vf=new bT;function wT(){for(var e;e=yT();){try{e.h.call(e.g)}catch(n){_T(n)}var t=bf;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Zo=!1}function _r(e,t){mt.call(this),this.h=e||1,this.g=t||O,this.j=_t(this.kb,this),this.l=Date.now()}St(_r,mt);C=_r.prototype;C.da=!1;C.S=null;C.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),xt(this,"tick"),this.da&&(Za(this),this.start()))}};C.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Za(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}C.M=function(){_r.Z.M.call(this),Za(this),delete this.g};function tl(e,t,n){if(typeof e=="function")n&&(e=_t(e,n));else if(e&&typeof e.handleEvent=="function")e=_t(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:O.setTimeout(e,t||0)}function _f(e){e.g=tl(()=>{e.g=null,e.i&&(e.i=!1,_f(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}class ST extends Te{constructor(t,n){super(),this.m=t,this.j=n,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:_f(this)}M(){super.M(),this.g&&(O.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Si(e){Te.call(this),this.h=e,this.g={}}St(Si,Te);var Fh=[];function xf(e,t,n,i){Array.isArray(n)||(n&&(Fh[0]=n.toString()),n=Fh);for(var s=0;s<n.length;s++){var r=ff(t,n[s],i||e.handleEvent,!1,e.h||e);if(!r)break;e.g[r.key]=r}}function wf(e){Wa(e.g,function(t,n){this.g.hasOwnProperty(n)&&Ga(t)},e),e.g={}}Si.prototype.M=function(){Si.Z.M.call(this),wf(this)};Si.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function xr(){this.g=!0}xr.prototype.Aa=function(){this.g=!1};function ET(e,t,n,i,s,r){e.info(function(){if(e.g)if(r)for(var o="",a=r.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var h=c[0];c=c[1];var u=h.split("_");o=2<=u.length&&u[1]=="type"?o+(h+"="+c+"&"):o+(h+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+i+") [attempt "+s+"]: "+t+`
`+n+`
`+o})}function TT(e,t,n,i,s,r,o){e.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+s+"]: "+t+`
`+n+`
`+r+" "+o})}function hn(e,t,n,i){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+AT(e,n)+(i?" "+i:"")})}function CT(e,t){e.info(function(){return"TIMEOUT: "+t})}xr.prototype.info=function(){};function AT(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n){for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var s=i[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if(r!="noop"&&r!="stop"&&r!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return Qa(n)}catch{return t}}var sn={},Bh=null;function wr(){return Bh=Bh||new mt}sn.Ma="serverreachability";function Sf(e){Ct.call(this,sn.Ma,e)}St(Sf,Ct);function Ei(e){const t=wr();xt(t,new Sf(t))}sn.STAT_EVENT="statevent";function Ef(e,t){Ct.call(this,sn.STAT_EVENT,e),this.stat=t}St(Ef,Ct);function kt(e){const t=wr();xt(t,new Ef(t,e))}sn.Na="timingevent";function Tf(e,t){Ct.call(this,sn.Na,e),this.size=t}St(Tf,Ct);function ji(e,t){if(typeof e!="function")throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){e()},t)}var Sr={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Cf={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function el(){}el.prototype.h=null;function Vh(e){return e.h||(e.h=e.i())}function Af(){}var zi={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function nl(){Ct.call(this,"d")}St(nl,Ct);function il(){Ct.call(this,"c")}St(il,Ct);var ta;function Er(){}St(Er,el);Er.prototype.g=function(){return new XMLHttpRequest};Er.prototype.i=function(){return{}};ta=new Er;function Ui(e,t,n,i){this.l=e,this.j=t,this.m=n,this.X=i||1,this.V=new Si(this),this.P=DT,e=Go?125:void 0,this.W=new _r(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Df}function Df(){this.i=null,this.g="",this.h=!1}var DT=45e3,ea={},zs={};C=Ui.prototype;C.setTimeout=function(e){this.P=e};function na(e,t,n){e.K=1,e.v=Cr(ae(t)),e.s=n,e.U=!0,Mf(e,null)}function Mf(e,t){e.F=Date.now(),Hi(e),e.A=ae(e.v);var n=e.A,i=e.X;Array.isArray(i)||(i=[String(i)]),Nf(n.h,"t",i),e.C=0,n=e.l.H,e.h=new Df,e.g=ng(e.l,n?t:null,!e.s),0<e.O&&(e.L=new ST(_t(e.Ia,e,e.g),e.O)),xf(e.V,e.g,"readystatechange",e.gb),t=e.H?lf(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ei(),ET(e.j,e.u,e.A,e.m,e.X,e.s)}C.gb=function(e){e=e.target;const t=this.L;t&&re(e)==3?t.l():this.Ia(e)};C.Ia=function(e){try{if(e==this.g)t:{const h=re(this.g);var t=this.g.Da();const u=this.g.ba();if(!(3>h)&&(h!=3||Go||this.g&&(this.h.h||this.g.ga()||Uh(this.g)))){this.I||h!=4||t==7||(t==8||0>=u?Ei(3):Ei(2)),Tr(this);var n=this.g.ba();this.N=n;e:if(If(this)){var i=Uh(this.g);e="";var s=i.length,r=re(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){Re(this),oi(this);var o="";break e}this.h.i=new O.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:r&&t==s-1});i.splice(0,s),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,TT(this.j,this.u,this.A,this.m,this.X,h,n),this.i){if(this.$&&!this.J){e:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$s(a)){var c=a;break e}}c=null}if(n=c)hn(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,ia(this,n);else{this.i=!1,this.o=3,kt(12),Re(this),oi(this);break t}}this.U?(kf(this,h,o),Go&&this.i&&h==3&&(xf(this.V,this.W,"tick",this.fb),this.W.start())):(hn(this.j,this.m,o,null),ia(this,o)),h==4&&Re(this),this.i&&!this.I&&(h==4?Jf(this.l,this):(this.i=!1,Hi(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,kt(12)):(this.o=0,kt(13)),Re(this),oi(this)}}}catch{}finally{}};function If(e){return e.g?e.u=="GET"&&e.K!=2&&e.l.Ba:!1}function kf(e,t,n){let i=!0,s;for(;!e.I&&e.C<n.length;)if(s=MT(e,n),s==zs){t==4&&(e.o=4,kt(14),i=!1),hn(e.j,e.m,null,"[Incomplete Response]");break}else if(s==ea){e.o=4,kt(15),hn(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}else hn(e.j,e.m,s,null),ia(e,s);If(e)&&s!=zs&&s!=ea&&(e.h.g="",e.C=0),t!=4||n.length!=0||e.h.h||(e.o=1,kt(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,t=e.l,t.g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),dl(t),t.L=!0,kt(11))):(hn(e.j,e.m,n,"[Invalid Chunked Response]"),Re(e),oi(e))}C.fb=function(){if(this.g){var e=re(this.g),t=this.g.ga();this.C<t.length&&(Tr(this),kf(this,e,t),this.i&&e!=4&&Hi(this))}};function MT(e,t){var n=e.C,i=t.indexOf(`
`,n);return i==-1?zs:(n=Number(t.substring(n,i)),isNaN(n)?ea:(i+=1,i+n>t.length?zs:(t=t.substr(i,n),e.C=i+n,t)))}C.cancel=function(){this.I=!0,Re(this)};function Hi(e){e.Y=Date.now()+e.P,Of(e,e.P)}function Of(e,t){if(e.B!=null)throw Error("WatchDog timer not null");e.B=ji(_t(e.eb,e),t)}function Tr(e){e.B&&(O.clearTimeout(e.B),e.B=null)}C.eb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(CT(this.j,this.A),this.K!=2&&(Ei(),kt(17)),Re(this),this.o=2,oi(this)):Of(this,this.Y-e)};function oi(e){e.l.G==0||e.I||Jf(e.l,e)}function Re(e){Tr(e);var t=e.L;t&&typeof t.na=="function"&&t.na(),e.L=null,Za(e.W),wf(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function ia(e,t){try{var n=e.l;if(n.G!=0&&(n.g==e||sa(n.i,e))){if(n.I=e.N,!e.J&&sa(n.i,e)&&n.G==3){try{var i=n.Ca.g.parse(t)}catch{i=null}if(Array.isArray(i)&&i.length==3){var s=i;if(s[0]==0){t:if(!n.u){if(n.g)if(n.g.F+3e3<e.F)Ks(n),Mr(n);else break t;ul(n),kt(18)}}else n.ta=s[1],0<n.ta-n.U&&37500>s[2]&&n.N&&n.A==0&&!n.v&&(n.v=ji(_t(n.ab,n),6e3));if(1>=Vf(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else Le(n,11)}else if((e.J||n.g==e)&&Ks(n),!$s(t))for(s=n.Ca.g.parse(t),t=0;t<s.length;t++){let c=s[t];if(n.U=c[0],c=c[1],n.G==2)if(c[0]=="c"){n.J=c[1],n.la=c[2];const h=c[3];h!=null&&(n.ma=h,n.h.info("VER="+n.ma));const u=c[4];u!=null&&(n.za=u,n.h.info("SVER="+n.za));const d=c[5];d!=null&&typeof d=="number"&&0<d&&(i=1.5*d,n.K=i,n.h.info("backChannelRequestTimeoutMs_="+i)),i=n;const f=e.g;if(f){const g=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(g){var r=i.i;!r.g&&(Mt(g,"spdy")||Mt(g,"quic")||Mt(g,"h2"))&&(r.j=r.l,r.g=new Set,r.h&&(ol(r,r.h),r.h=null))}if(i.D){const p=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;p&&(i.sa=p,tt(i.F,i.D,p))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms")),i=n;var o=e;if(i.oa=eg(i,i.H?i.la:null,i.W),o.J){$f(i.i,o);var a=o,l=i.K;l&&a.setTimeout(l),a.B&&(Tr(a),Hi(a)),i.g=o}else Xf(i);0<n.l.length&&Ir(n)}else c[0]!="stop"&&c[0]!="close"||Le(n,7);else n.G==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Le(n,7):hl(n):c[0]!="noop"&&n.j&&n.j.wa(c),n.A=0)}}Ei(4)}catch{}}function IT(e){if(e.R&&typeof e.R=="function")return e.R();if(typeof e=="string")return e.split("");if(qo(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}t=[],n=0;for(i in e)t[n++]=e[i];return t}function sl(e,t){if(e.forEach&&typeof e.forEach=="function")e.forEach(t,void 0);else if(qo(e)||typeof e=="string")af(e,t,void 0);else{if(e.T&&typeof e.T=="function")var n=e.T();else if(e.R&&typeof e.R=="function")n=void 0;else if(qo(e)||typeof e=="string"){n=[];for(var i=e.length,s=0;s<i;s++)n.push(s)}else for(s in n=[],i=0,e)n[i++]=s;i=IT(e),s=i.length;for(var r=0;r<s;r++)t.call(void 0,i[r],n&&n[r],e)}}function On(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(e)if(e instanceof On)for(n=e.T(),i=0;i<n.length;i++)this.set(n[i],e.get(n[i]));else for(i in e)this.set(i,e[i])}C=On.prototype;C.R=function(){rl(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e};C.T=function(){return rl(this),this.g.concat()};function rl(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var i=e.g[t];Ye(e.h,i)&&(e.g[n++]=i),t++}e.g.length=n}if(e.i!=e.g.length){var s={};for(n=t=0;t<e.g.length;)i=e.g[t],Ye(s,i)||(e.g[n++]=i,s[i]=1),t++;e.g.length=n}}C.get=function(e,t){return Ye(this.h,e)?this.h[e]:t};C.set=function(e,t){Ye(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t};C.forEach=function(e,t){for(var n=this.T(),i=0;i<n.length;i++){var s=n[i],r=this.get(s);e.call(t,r,s,this)}};function Ye(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Pf=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function kT(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),s=null;if(0<=i){var r=e[n].substring(0,i);s=e[n].substring(i+1)}else r=e[n];t(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function Xe(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof Xe){this.g=t!==void 0?t:e.g,Us(this,e.j),this.s=e.s,Hs(this,e.i),Ws(this,e.m),this.l=e.l,t=e.h;var n=new Ti;n.i=t.i,t.g&&(n.g=new On(t.g),n.h=t.h),$h(this,n),this.o=e.o}else e&&(n=String(e).match(Pf))?(this.g=!!t,Us(this,n[1]||"",!0),this.s=ai(n[2]||""),Hs(this,n[3]||"",!0),Ws(this,n[4]),this.l=ai(n[5]||"",!0),$h(this,n[6]||"",!0),this.o=ai(n[7]||"")):(this.g=!!t,this.h=new Ti(null,this.g))}Xe.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Jn(t,jh,!0),":");var n=this.i;return(n||t=="file")&&(e.push("//"),(t=this.s)&&e.push(Jn(t,jh,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&e.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&e.push("/"),e.push(Jn(n,n.charAt(0)=="/"?NT:LT,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Jn(n,BT)),e.join("")};function ae(e){return new Xe(e)}function Us(e,t,n){e.j=n?ai(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Hs(e,t,n){e.i=n?ai(t,!0):t}function Ws(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function $h(e,t,n){t instanceof Ti?(e.h=t,VT(e.h,e.g)):(n||(t=Jn(t,FT)),e.h=new Ti(t,e.g))}function tt(e,t,n){e.h.set(t,n)}function Cr(e){return tt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function OT(e){return e instanceof Xe?ae(e):new Xe(e,void 0)}function PT(e,t,n,i){var s=new Xe(null,void 0);return e&&Us(s,e),t&&Hs(s,t),n&&Ws(s,n),i&&(s.l=i),s}function ai(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Jn(e,t,n){return typeof e=="string"?(e=encodeURI(e).replace(t,RT),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function RT(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var jh=/[#\/\?@]/g,LT=/[#\?:]/g,NT=/[#\?]/g,FT=/[#\?@]/g,BT=/#/g;function Ti(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Ce(e){e.g||(e.g=new On,e.h=0,e.i&&kT(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}C=Ti.prototype;C.add=function(e,t){Ce(this),this.i=null,e=Pn(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this};function Rf(e,t){Ce(e),t=Pn(e,t),Ye(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,e=e.g,Ye(e.h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&rl(e)))}function Lf(e,t){return Ce(e),t=Pn(e,t),Ye(e.g.h,t)}C.forEach=function(e,t){Ce(this),this.g.forEach(function(n,i){af(n,function(s){e.call(t,s,i,this)},this)},this)};C.T=function(){Ce(this);for(var e=this.g.R(),t=this.g.T(),n=[],i=0;i<t.length;i++)for(var s=e[i],r=0;r<s.length;r++)n.push(t[i]);return n};C.R=function(e){Ce(this);var t=[];if(typeof e=="string")Lf(this,e)&&(t=kh(t,this.g.get(Pn(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=kh(t,e[n])}return t};C.set=function(e,t){return Ce(this),this.i=null,e=Pn(this,e),Lf(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this};C.get=function(e,t){return e?(e=this.R(e),0<e.length?String(e[0]):t):t};function Nf(e,t,n){Rf(e,t),0<n.length&&(e.i=null,e.g.set(Pn(e,t),Ha(n)),e.h+=n.length)}C.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var i=t[n],s=encodeURIComponent(String(i));i=this.R(i);for(var r=0;r<i.length;r++){var o=s;i[r]!==""&&(o+="="+encodeURIComponent(String(i[r]))),e.push(o)}}return this.i=e.join("&")};function Pn(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function VT(e,t){t&&!e.j&&(Ce(e),e.i=null,e.g.forEach(function(n,i){var s=i.toLowerCase();i!=s&&(Rf(this,i),Nf(this,s,n))},e)),e.j=t}var $T=class{constructor(e,t){this.h=e,this.g=t}};function Ff(e){this.l=e||jT,O.PerformanceNavigationTiming?(e=O.performance.getEntriesByType("navigation"),e=0<e.length&&(e[0].nextHopProtocol=="hq"||e[0].nextHopProtocol=="h2")):e=!!(O.g&&O.g.Ea&&O.g.Ea()&&O.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var jT=10;function Bf(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function Vf(e){return e.h?1:e.g?e.g.size:0}function sa(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function ol(e,t){e.g?e.g.add(t):e.h=t}function $f(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}Ff.prototype.cancel=function(){if(this.i=jf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const e of this.g.values())e.cancel();this.g.clear()}};function jf(e){if(e.h!=null)return e.i.concat(e.h.D);if(e.g!=null&&e.g.size!==0){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return Ha(e.i)}function al(){}al.prototype.stringify=function(e){return O.JSON.stringify(e,void 0)};al.prototype.parse=function(e){return O.JSON.parse(e,void 0)};function zT(){this.g=new al}function UT(e,t,n){const i=n||"";try{sl(e,function(s,r){let o=s;Vi(s)&&(o=Qa(s)),t.push(i+r+"="+encodeURIComponent(o))})}catch(s){throw t.push(i+"type="+encodeURIComponent("_badmap")),s}}function HT(e,t){const n=new xr;if(O.Image){const i=new Image;i.onload=ds(gs,n,i,"TestLoadImage: loaded",!0,t),i.onerror=ds(gs,n,i,"TestLoadImage: error",!1,t),i.onabort=ds(gs,n,i,"TestLoadImage: abort",!1,t),i.ontimeout=ds(gs,n,i,"TestLoadImage: timeout",!1,t),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=e}else t(!1)}function gs(e,t,n,i,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(i)}catch{}}function Wi(e){this.l=e.$b||null,this.j=e.ib||!1}St(Wi,el);Wi.prototype.g=function(){return new Ar(this.l,this.j)};Wi.prototype.i=function(e){return function(){return e}}({});function Ar(e,t){mt.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=ll,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}St(Ar,mt);var ll=0;C=Ar.prototype;C.open=function(e,t){if(this.readyState!=ll)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Ci(this)};C.send=function(e){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||O).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))};C.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ki(this)),this.readyState=ll};C.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ci(this)),this.g&&(this.readyState=3,Ci(this),this.g)))if(this.responseType==="arraybuffer")e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof O.ReadableStream!="undefined"&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;zf(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))};function zf(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}C.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ki(this):Ci(this),this.readyState==3&&zf(this)}};C.Ua=function(e){this.g&&(this.response=this.responseText=e,Ki(this))};C.Ta=function(e){this.g&&(this.response=e,Ki(this))};C.ha=function(){this.g&&Ki(this)};function Ki(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Ci(e)}C.setRequestHeader=function(e,t){this.v.append(e,t)};C.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""};C.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join(`\r
`)};function Ci(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(Ar.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(e){this.m=e?"include":"same-origin"}});var WT=O.JSON.parse;function ut(e){mt.call(this),this.headers=new On,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Uf,this.K=this.L=!1}St(ut,mt);var Uf="",KT=/^https?$/i,qT=["POST","PUT"];C=ut.prototype;C.ea=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ta.g(),this.C=this.u?Vh(this.u):Vh(ta),this.g.onreadystatechange=_t(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(r){zh(this,r);return}e=n||"";const s=new On(this.headers);i&&sl(i,function(r,o){s.set(o,r)}),i=sT(s.T()),n=O.FormData&&e instanceof O.FormData,!(0<=of(qT,t))||i||n||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(r,o){this.g.setRequestHeader(o,r)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Kf(this),0<this.B&&((this.K=GT(this.g))?(this.g.timeout=this.B,this.g.ontimeout=_t(this.pa,this)):this.A=tl(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(r){zh(this,r)}};function GT(e){return Sn&&cT()&&typeof e.timeout=="number"&&e.ontimeout!==void 0}function YT(e){return e.toLowerCase()=="content-type"}C.pa=function(){typeof Ua!="undefined"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,xt(this,"timeout"),this.abort(8))};function zh(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Hf(e),Dr(e)}function Hf(e){e.D||(e.D=!0,xt(e,"complete"),xt(e,"error"))}C.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,xt(this,"complete"),xt(this,"abort"),Dr(this))};C.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Dr(this,!0)),ut.Z.M.call(this)};C.Fa=function(){this.s||(this.F||this.v||this.l?Wf(this):this.cb())};C.cb=function(){Wf(this)};function Wf(e){if(e.h&&typeof Ua!="undefined"&&(!e.C[1]||re(e)!=4||e.ba()!=2)){if(e.v&&re(e)==4)tl(e.Fa,0,e);else if(xt(e,"readystatechange"),re(e)==4){e.h=!1;try{const a=e.ba();t:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break t;default:t=!1}var n;if(!(n=t)){var i;if(i=a===0){var s=String(e.H).match(Pf)[1]||null;if(!s&&O.self&&O.self.location){var r=O.self.location.protocol;s=r.substr(0,r.length-1)}i=!KT.test(s?s.toLowerCase():"")}n=i}if(n)xt(e,"complete"),xt(e,"success");else{e.m=6;try{var o=2<re(e)?e.g.statusText:""}catch{o=""}e.j=o+" ["+e.ba()+"]",Hf(e)}}finally{Dr(e)}}}}function Dr(e,t){if(e.g){Kf(e);const n=e.g,i=e.C[0]?Vs:null;e.g=null,e.C=null,t||xt(e,"ready");try{n.onreadystatechange=i}catch{}}}function Kf(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(O.clearTimeout(e.A),e.A=null)}function re(e){return e.g?e.g.readyState:0}C.ba=function(){try{return 2<re(this)?this.g.status:-1}catch{return-1}};C.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};C.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),WT(t)}};function Uh(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case Uf:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}C.Da=function(){return this.m};C.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function XT(e){let t="";return Wa(e,function(n,i){t+=i,t+=":",t+=n,t+=`\r
`}),t}function cl(e,t,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=XT(n),typeof e=="string"?n!=null&&encodeURIComponent(String(n)):tt(e,t,n))}function Gn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function qf(e){this.za=0,this.l=[],this.h=new xr,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Gn("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Gn("baseRetryDelayMs",5e3,e),this.$a=Gn("retryDelaySeedMs",1e4,e),this.Ya=Gn("forwardChannelMaxRetries",2,e),this.ra=Gn("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new Ff(e&&e.concurrentRequestLimit),this.Ca=new zT,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||e.Xb!==!1}C=qf.prototype;C.ma=8;C.G=1;function hl(e){if(Gf(e),e.G==3){var t=e.V++,n=ae(e.F);tt(n,"SID",e.J),tt(n,"RID",t),tt(n,"TYPE","terminate"),qi(e,n),t=new Ui(e,e.h,t,void 0),t.K=2,t.v=Cr(ae(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(t.v.toString(),"")),!n&&O.Image&&(new Image().src=t.v,n=!0),n||(t.g=ng(t.l,null),t.g.ea(t.v)),t.F=Date.now(),Hi(t)}tg(e)}C.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch{}};function Mr(e){e.g&&(dl(e),e.g.cancel(),e.g=null)}function Gf(e){Mr(e),e.u&&(O.clearTimeout(e.u),e.u=null),Ks(e),e.i.cancel(),e.m&&(typeof e.m=="number"&&O.clearTimeout(e.m),e.m=null)}function vo(e,t){e.l.push(new $T(e.Za++,t)),e.G==3&&Ir(e)}function Ir(e){Bf(e.i)||e.m||(e.m=!0,Ja(e.Ha,e),e.C=0)}function QT(e,t){return Vf(e.i)>=e.i.j-(e.m?1:0)?!1:e.m?(e.l=t.D.concat(e.l),!0):e.G==1||e.G==2||e.C>=(e.Xa?0:e.Ya)?!1:(e.m=ji(_t(e.Ha,e,t),Zf(e,e.C)),e.C++,!0)}C.Ha=function(e){if(this.m)if(this.m=null,this.G==1){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const s=new Ui(this,this.h,e,void 0);let r=this.s;if(this.P&&(r?(r=lf(r),cf(r,this.P)):r=this.P),this.o===null&&(s.H=r),this.ja)t:{for(var t=0,n=0;n<this.l.length;n++){e:{var i=this.l[n];if("__data__"in i.g&&(i=i.g.__data__,typeof i=="string")){i=i.length;break e}i=void 0}if(i===void 0)break;if(t+=i,4096<t){t=n;break t}if(t===4096||n===this.l.length-1){t=n+1;break t}}t=1e3}else t=1e3;t=Yf(this,s,t),n=ae(this.F),tt(n,"RID",e),tt(n,"CVER",22),this.D&&tt(n,"X-HTTP-Session-Id",this.D),qi(this,n),this.o&&r&&cl(n,this.o,r),ol(this.i,s),this.Ra&&tt(n,"TYPE","init"),this.ja?(tt(n,"$req",t),tt(n,"SID","null"),s.$=!0,na(s,n,null)):na(s,n,t),this.G=2}}else this.G==3&&(e?Hh(this,e):this.l.length==0||Bf(this.i)||Hh(this))};function Hh(e,t){var n;t?n=t.m:n=e.V++;const i=ae(e.F);tt(i,"SID",e.J),tt(i,"RID",n),tt(i,"AID",e.U),qi(e,i),e.o&&e.s&&cl(i,e.o,e.s),n=new Ui(e,e.h,n,e.C+1),e.o===null&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=Yf(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),ol(e.i,n),na(n,i,t)}function qi(e,t){e.j&&sl({},function(n,i){tt(t,i,n)})}function Yf(e,t,n){n=Math.min(e.l.length,n);var i=e.j?_t(e.j.Oa,e.j,e):null;t:{var s=e.l;let r=-1;for(;;){const o=["count="+n];r==-1?0<n?(r=s[0].h,o.push("ofs="+r)):r=0:o.push("ofs="+r);let a=!0;for(let l=0;l<n;l++){let c=s[l].h;const h=s[l].g;if(c-=r,0>c)r=Math.max(0,s[l].h-100),a=!1;else try{UT(h,o,"req"+c+"_")}catch{i&&i(h)}}if(a){i=o.join("&");break t}}}return e=e.l.splice(0,n),t.D=e,i}function Xf(e){e.g||e.u||(e.Y=1,Ja(e.Ga,e),e.A=0)}function ul(e){return e.g||e.u||3<=e.A?!1:(e.Y++,e.u=ji(_t(e.Ga,e),Zf(e,e.A)),e.A++,!0)}C.Ga=function(){if(this.u=null,Qf(this),this.$&&!(this.L||this.g==null||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=ji(_t(this.bb,this),e)}};C.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,kt(10),Mr(this),Qf(this))};function dl(e){e.B!=null&&(O.clearTimeout(e.B),e.B=null)}function Qf(e){e.g=new Ui(e,e.h,"rpc",e.Y),e.o===null&&(e.g.H=e.s),e.g.O=0;var t=ae(e.oa);tt(t,"RID","rpc"),tt(t,"SID",e.J),tt(t,"CI",e.N?"0":"1"),tt(t,"AID",e.U),qi(e,t),tt(t,"TYPE","xmlhttp"),e.o&&e.s&&cl(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=Cr(ae(t)),n.s=null,n.U=!0,Mf(n,e)}C.ab=function(){this.v!=null&&(this.v=null,Mr(this),ul(this),kt(19))};function Ks(e){e.v!=null&&(O.clearTimeout(e.v),e.v=null)}function Jf(e,t){var n=null;if(e.g==t){Ks(e),dl(e),e.g=null;var i=2}else if(sa(e.i,t))n=t.D,$f(e.i,t),i=1;else return;if(e.I=t.N,e.G!=0){if(t.i)if(i==1){n=t.s?t.s.length:0,t=Date.now()-t.F;var s=e.C;i=wr(),xt(i,new Tf(i,n)),Ir(e)}else Xf(e);else if(s=t.o,s==3||s==0&&0<e.I||!(i==1&&QT(e,t)||i==2&&ul(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),s){case 1:Le(e,5);break;case 4:Le(e,10);break;case 3:Le(e,6);break;default:Le(e,2)}}}function Zf(e,t){let n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function Le(e,t){if(e.h.info("Error code "+t),t==2){var n=null;e.j&&(n=null);var i=_t(e.jb,e);n||(n=new Xe("//www.google.com/images/cleardot.gif"),O.location&&O.location.protocol=="http"||Us(n,"https"),Cr(n)),HT(n.toString(),i)}else kt(2);e.G=0,e.j&&e.j.va(t),tg(e),Gf(e)}C.jb=function(e){e?(this.h.info("Successfully pinged google.com"),kt(2)):(this.h.info("Failed to ping google.com"),kt(1))};function tg(e){e.G=0,e.I=-1,e.j&&((jf(e.i).length!=0||e.l.length!=0)&&(e.i.i.length=0,Ha(e.l),e.l.length=0),e.j.ua())}function eg(e,t,n){let i=OT(n);if(i.i!="")t&&Hs(i,t+"."+i.i),Ws(i,i.m);else{const s=O.location;i=PT(s.protocol,t?t+"."+s.hostname:s.hostname,+s.port,n)}return e.aa&&Wa(e.aa,function(s,r){tt(i,r,s)}),t=e.D,n=e.sa,t&&n&&tt(i,t,n),tt(i,"VER",e.ma),qi(e,i),i}function ng(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return t=n&&e.Ba&&!e.qa?new ut(new Wi({ib:!0})):new ut(e.qa),t.L=e.H,t}function ig(){}C=ig.prototype;C.xa=function(){};C.wa=function(){};C.va=function(){};C.ua=function(){};C.Oa=function(){};function qs(){if(Sn&&!(10<=Number(hT)))throw Error("Environmental error: no available transport.")}qs.prototype.g=function(e,t){return new Bt(e,t)};function Bt(e,t){mt.call(this),this.g=new qf(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!$s(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!$s(t)&&(this.g.D=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new Rn(this)}St(Bt,mt);Bt.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),Ja(_t(e.hb,e,t))),kt(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=eg(e,null,e.W),Ir(e)};Bt.prototype.close=function(){hl(this.g)};Bt.prototype.u=function(e){if(typeof e=="string"){var t={};t.__data__=e,vo(this.g,t)}else this.v?(t={},t.__data__=Qa(e),vo(this.g,t)):vo(this.g,e)};Bt.prototype.M=function(){this.g.j=null,delete this.j,hl(this.g),delete this.g,Bt.Z.M.call(this)};function sg(e){nl.call(this);var t=e.__sm__;if(t){t:{for(const n in t){e=n;break t}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}St(sg,nl);function rg(){il.call(this),this.status=1}St(rg,il);function Rn(e){this.g=e}St(Rn,ig);Rn.prototype.xa=function(){xt(this.g,"a")};Rn.prototype.wa=function(e){xt(this.g,new sg(e))};Rn.prototype.va=function(e){xt(this.g,new rg)};Rn.prototype.ua=function(){xt(this.g,"b")};qs.prototype.createWebChannel=qs.prototype.g;Bt.prototype.send=Bt.prototype.u;Bt.prototype.open=Bt.prototype.m;Bt.prototype.close=Bt.prototype.close;Sr.NO_ERROR=0;Sr.TIMEOUT=8;Sr.HTTP_ERROR=6;Cf.COMPLETE="complete";Af.EventType=zi;zi.OPEN="a";zi.CLOSE="b";zi.ERROR="c";zi.MESSAGE="d";mt.prototype.listen=mt.prototype.N;ut.prototype.listenOnce=ut.prototype.O;ut.prototype.getLastError=ut.prototype.La;ut.prototype.getLastErrorCode=ut.prototype.Da;ut.prototype.getStatus=ut.prototype.ba;ut.prototype.getResponseJson=ut.prototype.Qa;ut.prototype.getResponseText=ut.prototype.ga;ut.prototype.send=ut.prototype.ea;var JT=function(){return new qs},ZT=function(){return wr()},_o=Sr,tC=Cf,eC=sn,Wh={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},nC=Wi,ps=Af,iC=ut;const Kh="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Ot.UNAUTHENTICATED=new Ot(null),Ot.GOOGLE_CREDENTIALS=new Ot("google-credentials-uid"),Ot.FIRST_PARTY=new Ot("first-party-uid"),Ot.MOCK_USER=new Ot("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ln="9.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qe=new Zd("@firebase/firestore");function qh(){return Qe.logLevel}function M(e,...t){if(Qe.logLevel<=K.DEBUG){const n=t.map(fl);Qe.debug(`Firestore (${Ln}): ${e}`,...n)}}function le(e,...t){if(Qe.logLevel<=K.ERROR){const n=t.map(fl);Qe.error(`Firestore (${Ln}): ${e}`,...n)}}function Gh(e,...t){if(Qe.logLevel<=K.WARN){const n=t.map(fl);Qe.warn(`Firestore (${Ln}): ${e}`,...n)}}function fl(e){if(typeof e=="string")return e;try{return t=e,JSON.stringify(t)}catch{return e}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N(e="Unexpected state"){const t=`FIRESTORE (${Ln}) INTERNAL ASSERTION FAILED: `+e;throw le(t),new Error(t)}function ht(e,t){e||N()}function W(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class k extends kn{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class rC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(Ot.UNAUTHENTICATED))}shutdown(){}}class oC{constructor(t){this.t=t,this.currentUser=Ot.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){let i=this.i;const s=l=>this.i!==i?(i=this.i,n(l)):Promise.resolve();let r=new Ve;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Ve,t.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=r;t.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Ve)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==t?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ht(typeof i.accessToken=="string"),new sC(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return ht(t===null||typeof t=="string"),new Ot(t)}}class aC{constructor(t,n,i){this.type="FirstParty",this.user=Ot.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);const s=t.auth.getAuthHeaderValueForFirstParty([]);s&&this.headers.set("Authorization",s),i&&this.headers.set("X-Goog-Iam-Authorization-Token",i)}}class lC{constructor(t,n,i){this.h=t,this.l=n,this.m=i}getToken(){return Promise.resolve(new aC(this.h,this.l,this.m))}start(t,n){t.enqueueRetryable(()=>n(Ot.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class cC{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class hC{constructor(t){this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(t,n){const i=r=>{r.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.p;return this.p=r.token,M("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(r.token):Promise.resolve()};this.o=r=>{t.enqueueRetryable(()=>i(r))};const s=r=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.appCheck.addTokenListener(this.o)};this.g.onInit(r=>s(r)),setTimeout(()=>{if(!this.appCheck){const r=this.g.getImmediate({optional:!0});r?s(r):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(ht(typeof n.token=="string"),this.p=n.token,new cC(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uC(e){const t=typeof self!="undefined"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{static I(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/t.length)*t.length;let i="";for(;i.length<20;){const s=uC(40);for(let r=0;r<s.length;++r)i.length<20&&s[r]<n&&(i+=t.charAt(s[r]%t.length))}return i}}function G(e,t){return e<t?-1:e>t?1:0}function En(e,t,n){return e.length===t.length&&e.every((i,s)=>n(i,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new k(T.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new k(T.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new k(T.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new k(T.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Nt.fromMillis(Date.now())}static fromDate(t){return Nt.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),i=Math.floor(1e6*(t-1e3*n));return new Nt(n,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?G(this.nanoseconds,t.nanoseconds):G(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(t){this.timestamp=t}static fromTimestamp(t){return new F(t)}static min(){return new F(new Nt(0,0))}static max(){return new F(new Nt(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(t,n,i){n===void 0?n=0:n>t.length&&N(),i===void 0?i=t.length-n:i>t.length-n&&N(),this.segments=t,this.offset=n,this.len=i}get length(){return this.len}isEqual(t){return Ai.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof Ai?t.forEach(i=>{n.push(i)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,i=this.limit();n<i;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const i=Math.min(t.length,n.length);for(let s=0;s<i;s++){const r=t.get(s),o=n.get(s);if(r<o)return-1;if(r>o)return 1}return t.length<n.length?-1:t.length>n.length?1:0}}class nt extends Ai{construct(t,n,i){return new nt(t,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const n=[];for(const i of t){if(i.indexOf("//")>=0)throw new k(T.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(s=>s.length>0))}return new nt(n)}static emptyPath(){return new nt([])}}const fC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Rt extends Ai{construct(t,n,i){return new Rt(t,n,i)}static isValidIdentifier(t){return fC.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Rt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Rt(["__name__"])}static fromServerFormat(t){const n=[];let i="",s=0;const r=()=>{if(i.length===0)throw new k(T.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let o=!1;for(;s<t.length;){const a=t[s];if(a==="\\"){if(s+1===t.length)throw new k(T.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new k(T.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(i+=a,s++):(r(),s++)}if(r(),o)throw new k(T.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Rt(n)}static emptyPath(){return new Rt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I{constructor(t){this.path=t}static fromPath(t){return new I(nt.fromString(t))}static fromName(t){return new I(nt.fromString(t).popFirst(5))}static empty(){return new I(nt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&nt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return nt.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new I(new nt(t.slice()))}}function gC(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,s=F.fromTimestamp(i===1e9?new Nt(n+1,0):new Nt(n,i));return new ve(s,I.empty(),t)}function pC(e){return new ve(e.readTime,e.key,-1)}class ve{constructor(t,n,i){this.readTime=t,this.documentKey=n,this.largestBatchId=i}static min(){return new ve(F.min(),I.empty(),-1)}static max(){return new ve(F.max(),I.empty(),-1)}}function mC(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=I.comparator(e.documentKey,t.documentKey),n!==0?n:G(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class bC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gl(e){if(e.code!==T.FAILED_PRECONDITION||e.message!==yC)throw e;M("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&N(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new w((i,s)=>{this.nextCallback=r=>{this.wrapSuccess(t,r).next(i,s)},this.catchCallback=r=>{this.wrapFailure(n,r).next(i,s)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof w?n:w.resolve(n)}catch(n){return w.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):w.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):w.reject(n)}static resolve(t){return new w((n,i)=>{n(t)})}static reject(t){return new w((n,i)=>{i(t)})}static waitFor(t){return new w((n,i)=>{let s=0,r=0,o=!1;t.forEach(a=>{++s,a.next(()=>{++r,o&&r===s&&n()},l=>i(l))}),o=!0,r===s&&n()})}static or(t){let n=w.resolve(!1);for(const i of t)n=n.next(s=>s?w.resolve(s):i());return n}static forEach(t,n){const i=[];return t.forEach((s,r)=>{i.push(n.call(this,s,r))}),this.waitFor(i)}static mapArray(t,n){return new w((i,s)=>{const r=t.length,o=new Array(r);let a=0;for(let l=0;l<r;l++){const c=l;n(t[c]).next(h=>{o[c]=h,++a,a===r&&i(o)},h=>s(h))}})}static doWhile(t,n){return new w((i,s)=>{const r=()=>{t()===!0?n().next(()=>{r()},s):i()};r()})}}function Gi(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.it(i),this.rt=i=>n.writeSequenceNumber(i))}it(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.rt&&this.rt(t),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yh(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function kr(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function vC(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pl.ot=-1;class yt{constructor(t,n){this.comparator=t,this.root=n||bt.EMPTY}insert(t,n){return new yt(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,bt.BLACK,null,null))}remove(t){return new yt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,bt.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(t){let n=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(t,i.key);if(s===0)return n+i.left.size;s<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,i)=>(t(n,i),!1))}toString(){const t=[];return this.inorderTraversal((n,i)=>(t.push(`${n}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new ms(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new ms(this.root,t,this.comparator,!1)}getReverseIterator(){return new ms(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new ms(this.root,t,this.comparator,!0)}}class ms{constructor(t,n,i,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=n?i(t.key,n):1,n&&s&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(r===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class bt{constructor(t,n,i,s,r){this.key=t,this.value=n,this.color=i!=null?i:bt.RED,this.left=s!=null?s:bt.EMPTY,this.right=r!=null?r:bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,i,s,r){return new bt(t!=null?t:this.key,n!=null?n:this.value,i!=null?i:this.color,s!=null?s:this.left,r!=null?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,i){let s=this;const r=i(t,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(t,n,i),null):r===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(t,n,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return bt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let i,s=this;if(n(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(t,s.key)===0){if(s.right.isEmpty())return bt.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw N();const t=this.left.check();if(t!==this.right.check())throw N();return t+(this.isRed()?0:1)}}bt.EMPTY=null,bt.RED=!0,bt.BLACK=!1;bt.EMPTY=new class{constructor(){this.size=0}get key(){throw N()}get value(){throw N()}get color(){throw N()}get left(){throw N()}get right(){throw N()}copy(e,t,n,i,s){return this}insert(e,t,n){return new bt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(t){this.comparator=t,this.data=new yt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,i)=>(t(n),!1))}forEachInRange(t,n){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,t[1])>=0)return;n(s.key)}}forEachWhile(t,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new Xh(this.data.getIterator())}getIteratorFrom(t){return new Xh(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(i=>{n=n.add(i)}),n}isEqual(t){if(!(t instanceof ft)||this.size!==t.size)return!1;const n=this.data.getIterator(),i=t.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,r=i.getNext().key;if(this.comparator(s,r)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new ft(this.comparator);return n.data=t,n}}class Xh{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(t){this.fields=t,t.sort(Rt.comparator)}static empty(){return new $e([])}unionWith(t){let n=new ft(Rt.comparator);for(const i of this.fields)n=n.add(i);for(const i of t)n=n.add(i);return new $e(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return En(this.fields,t.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(t){this.binaryString=t}static fromBase64String(t){const n=atob(t);return new wt(n)}static fromUint8Array(t){const n=function(i){let s="";for(let r=0;r<i.length;++r)s+=String.fromCharCode(i[r]);return s}(t);return new wt(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return G(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}wt.EMPTY_BYTE_STRING=new wt("");const _C=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _e(e){if(ht(!!e),typeof e=="string"){let t=0;const n=_C.exec(e);if(ht(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),t=Number(s)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:ct(e.seconds),nanos:ct(e.nanos)}}function ct(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Tn(e){return typeof e=="string"?wt.fromBase64String(e):wt.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function og(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function ag(e){const t=e.mapValue.fields.__previous_value__;return og(t)?ag(t):t}function Di(e){const t=_e(e.mapValue.fields.__local_write_time__.timestampValue);return new Nt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(t,n,i,s,r,o,a,l){this.databaseId=t,this.appId=n,this.persistenceKey=i,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=l}}class Cn{constructor(t,n){this.projectId=t,this.database=n||"(default)"}static empty(){return new Cn("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof Cn&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Or(e){return e==null}function ra(e){return e===0&&1/e==-1/0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ys={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Je(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?og(e)?4:wC(e)?9007199254740991:10:N()}function Xt(e,t){if(e===t)return!0;const n=Je(e);if(n!==Je(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Di(e).isEqual(Di(t));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const r=_e(i.timestampValue),o=_e(s.timestampValue);return r.seconds===o.seconds&&r.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,s){return Tn(i.bytesValue).isEqual(Tn(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,s){return ct(i.geoPointValue.latitude)===ct(s.geoPointValue.latitude)&&ct(i.geoPointValue.longitude)===ct(s.geoPointValue.longitude)}(e,t);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ct(i.integerValue)===ct(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const r=ct(i.doubleValue),o=ct(s.doubleValue);return r===o?ra(r)===ra(o):isNaN(r)&&isNaN(o)}return!1}(e,t);case 9:return En(e.arrayValue.values||[],t.arrayValue.values||[],Xt);case 10:return function(i,s){const r=i.mapValue.fields||{},o=s.mapValue.fields||{};if(Yh(r)!==Yh(o))return!1;for(const a in r)if(r.hasOwnProperty(a)&&(o[a]===void 0||!Xt(r[a],o[a])))return!1;return!0}(e,t);default:return N()}}function Mi(e,t){return(e.values||[]).find(n=>Xt(n,t))!==void 0}function An(e,t){if(e===t)return 0;const n=Je(e),i=Je(t);if(n!==i)return G(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return G(e.booleanValue,t.booleanValue);case 2:return function(s,r){const o=ct(s.integerValue||s.doubleValue),a=ct(r.integerValue||r.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(e,t);case 3:return Qh(e.timestampValue,t.timestampValue);case 4:return Qh(Di(e),Di(t));case 5:return G(e.stringValue,t.stringValue);case 6:return function(s,r){const o=Tn(s),a=Tn(r);return o.compareTo(a)}(e.bytesValue,t.bytesValue);case 7:return function(s,r){const o=s.split("/"),a=r.split("/");for(let l=0;l<o.length&&l<a.length;l++){const c=G(o[l],a[l]);if(c!==0)return c}return G(o.length,a.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,r){const o=G(ct(s.latitude),ct(r.latitude));return o!==0?o:G(ct(s.longitude),ct(r.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(s,r){const o=s.values||[],a=r.values||[];for(let l=0;l<o.length&&l<a.length;++l){const c=An(o[l],a[l]);if(c)return c}return G(o.length,a.length)}(e.arrayValue,t.arrayValue);case 10:return function(s,r){if(s===ys.mapValue&&r===ys.mapValue)return 0;if(s===ys.mapValue)return 1;if(r===ys.mapValue)return-1;const o=s.fields||{},a=Object.keys(o),l=r.fields||{},c=Object.keys(l);a.sort(),c.sort();for(let h=0;h<a.length&&h<c.length;++h){const u=G(a[h],c[h]);if(u!==0)return u;const d=An(o[a[h]],l[c[h]]);if(d!==0)return d}return G(a.length,c.length)}(e.mapValue,t.mapValue);default:throw N()}}function Qh(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return G(e,t);const n=_e(e),i=_e(t),s=G(n.seconds,i.seconds);return s!==0?s:G(n.nanos,i.nanos)}function gn(e){return oa(e)}function oa(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(i){const s=_e(i);return`time(${s.seconds},${s.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Tn(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,I.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(i){let s="[",r=!0;for(const o of i.values||[])r?r=!1:s+=",",s+=oa(o);return s+"]"}(e.arrayValue):"mapValue"in e?function(i){const s=Object.keys(i.fields||{}).sort();let r="{",o=!0;for(const a of s)o?o=!1:r+=",",r+=`${a}:${oa(i.fields[a])}`;return r+"}"}(e.mapValue):N();var t,n}function aa(e){return!!e&&"integerValue"in e}function ml(e){return!!e&&"arrayValue"in e}function Jh(e){return!!e&&"nullValue"in e}function Zh(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function xo(e){return!!e&&"mapValue"in e}function li(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return kr(e.mapValue.fields,(n,i)=>t.mapValue.fields[n]=li(i)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=li(e.arrayValue.values[n]);return t}return Object.assign({},e)}function wC(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(t){this.value=t}static empty(){return new qt({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let i=0;i<t.length-1;++i)if(n=(n.mapValue.fields||{})[t.get(i)],!xo(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=li(n)}setAll(t){let n=Rt.emptyPath(),i={},s=[];t.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,i,s),i={},s=[],n=a.popLast()}o?i[a.lastSegment()]=li(o):s.push(a.lastSegment())});const r=this.getFieldsMap(n);this.applyChanges(r,i,s)}delete(t){const n=this.field(t.popLast());xo(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return Xt(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<t.length;++i){let s=n.mapValue.fields[t.get(i)];xo(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[t.get(i)]=s),n=s}return n.mapValue.fields}applyChanges(t,n,i){kr(n,(s,r)=>t[s]=r);for(const s of i)delete t[s]}clone(){return new qt(li(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(t,n,i,s,r,o){this.key=t,this.documentType=n,this.version=i,this.readTime=s,this.data=r,this.documentState=o}static newInvalidDocument(t){return new vt(t,0,F.min(),F.min(),qt.empty(),0)}static newFoundDocument(t,n,i){return new vt(t,1,n,F.min(),i,0)}static newNoDocument(t,n){return new vt(t,2,n,F.min(),qt.empty(),0)}static newUnknownDocument(t,n){return new vt(t,3,n,F.min(),qt.empty(),2)}convertToFoundDocument(t,n){return this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=qt.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=qt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=F.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof vt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new vt(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(t,n=null,i=[],s=[],r=null,o=null,a=null){this.path=t,this.collectionGroup=n,this.orderBy=i,this.filters=s,this.limit=r,this.startAt=o,this.endAt=a,this.ut=null}}function tu(e,t=null,n=[],i=[],s=null,r=null,o=null){return new SC(e,t,n,i,s,r,o)}function yl(e){const t=W(e);if(t.ut===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(i=>{return(s=i).field.canonicalString()+s.op.toString()+gn(s.value);var s}).join(","),n+="|ob:",n+=t.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),Or(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>gn(i)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>gn(i)).join(",")),t.ut=n}return t.ut}function EC(e){let t=e.path.canonicalString();return e.collectionGroup!==null&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(n=>{return`${(i=n).field.canonicalString()} ${i.op} ${gn(i.value)}`;var i}).join(", ")}]`),Or(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(n=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(n)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>gn(n)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>gn(n)).join(",")),`Target(${t})`}function bl(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let s=0;s<e.orderBy.length;s++)if(!OC(e.orderBy[s],t.orderBy[s]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let s=0;s<e.filters.length;s++)if(n=e.filters[s],i=t.filters[s],n.op!==i.op||!n.field.isEqual(i.field)||!Xt(n.value,i.value))return!1;var n,i;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!nu(e.startAt,t.startAt)&&nu(e.endAt,t.endAt)}function la(e){return I.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}class Lt extends class{}{constructor(t,n,i){super(),this.field=t,this.op=n,this.value=i}static create(t,n,i){return t.isKeyField()?n==="in"||n==="not-in"?this.ct(t,n,i):new TC(t,n,i):n==="array-contains"?new DC(t,i):n==="in"?new MC(t,i):n==="not-in"?new IC(t,i):n==="array-contains-any"?new kC(t,i):new Lt(t,n,i)}static ct(t,n,i){return n==="in"?new CC(t,i):new AC(t,i)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&this.at(An(n,this.value)):n!==null&&Je(this.value)===Je(n)&&this.at(An(n,this.value))}at(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return N()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class TC extends Lt{constructor(t,n,i){super(t,n,i),this.key=I.fromName(i.referenceValue)}matches(t){const n=I.comparator(t.key,this.key);return this.at(n)}}class CC extends Lt{constructor(t,n){super(t,"in",n),this.keys=lg("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class AC extends Lt{constructor(t,n){super(t,"not-in",n),this.keys=lg("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function lg(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(i=>I.fromName(i.referenceValue))}class DC extends Lt{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return ml(n)&&Mi(n.arrayValue,this.value)}}class MC extends Lt{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&Mi(this.value.arrayValue,n)}}class IC extends Lt{constructor(t,n){super(t,"not-in",n)}matches(t){if(Mi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&!Mi(this.value.arrayValue,n)}}class kC extends Lt{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!ml(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>Mi(this.value.arrayValue,i))}}class Gs{constructor(t,n){this.position=t,this.inclusive=n}}class ci{constructor(t,n="asc"){this.field=t,this.dir=n}}function OC(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function eu(e,t,n){let i=0;for(let s=0;s<e.position.length;s++){const r=t[s],o=e.position[s];if(r.field.isKeyField()?i=I.comparator(I.fromName(o.referenceValue),n.key):i=An(o,n.data.field(r.field)),r.dir==="desc"&&(i*=-1),i!==0)break}return i}function nu(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Xt(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(t,n=null,i=[],s=[],r=null,o="F",a=null,l=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=s,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=l,this.lt=null,this.ft=null,this.startAt,this.endAt}}function PC(e,t,n,i,s,r,o,a){return new Pr(e,t,n,i,s,r,o,a)}function cg(e){return new Pr(e)}function iu(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function RC(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function LC(e){for(const t of e.filters)if(t.ht())return t.field;return null}function NC(e){return e.collectionGroup!==null}function Ii(e){const t=W(e);if(t.lt===null){t.lt=[];const n=LC(t),i=RC(t);if(n!==null&&i===null)n.isKeyField()||t.lt.push(new ci(n)),t.lt.push(new ci(Rt.keyField(),"asc"));else{let s=!1;for(const r of t.explicitOrderBy)t.lt.push(r),r.field.isKeyField()&&(s=!0);if(!s){const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.lt.push(new ci(Rt.keyField(),r))}}}return t.lt}function ce(e){const t=W(e);if(!t.ft)if(t.limitType==="F")t.ft=tu(t.path,t.collectionGroup,Ii(t),t.filters,t.limit,t.startAt,t.endAt);else{const n=[];for(const r of Ii(t)){const o=r.dir==="desc"?"asc":"desc";n.push(new ci(r.field,o))}const i=t.endAt?new Gs(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new Gs(t.startAt.position,t.startAt.inclusive):null;t.ft=tu(t.path,t.collectionGroup,n,t.filters,t.limit,i,s)}return t.ft}function ca(e,t,n){return new Pr(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Rr(e,t){return bl(ce(e),ce(t))&&e.limitType===t.limitType}function hg(e){return`${yl(ce(e))}|lt:${e.limitType}`}function ha(e){return`Query(target=${EC(ce(e))}; limitType=${e.limitType})`}function vl(e,t){return t.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):I.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(e,t)&&function(n,i){for(const s of n.explicitOrderBy)if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(e,t)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(e,t)&&function(n,i){return!(n.startAt&&!function(s,r,o){const a=eu(s,r,o);return s.inclusive?a<=0:a<0}(n.startAt,Ii(n),i)||n.endAt&&!function(s,r,o){const a=eu(s,r,o);return s.inclusive?a>=0:a>0}(n.endAt,Ii(n),i))}(e,t)}function FC(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function ug(e){return(t,n)=>{let i=!1;for(const s of Ii(e)){const r=BC(s,t,n);if(r!==0)return r;i=i||s.field.isKeyField()}return 0}}function BC(e,t,n){const i=e.field.isKeyField()?I.comparator(t.key,n.key):function(s,r,o){const a=r.data.field(s),l=o.data.field(s);return a!==null&&l!==null?An(a,l):N()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return N()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(e,t){if(e.dt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ra(t)?"-0":t}}function $C(e){return{integerValue:""+e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(){this._=void 0}}function jC(e,t,n){return e instanceof ua?function(i,s){const r={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&(r.fields.__previous_value__=s),{mapValue:r}}(n,t):e instanceof Ys?dg(e,t):e instanceof Xs?fg(e,t):function(i,s){const r=UC(i,s),o=su(r)+su(i._t);return aa(r)&&aa(i._t)?$C(o):VC(i.wt,o)}(e,t)}function zC(e,t,n){return e instanceof Ys?dg(e,t):e instanceof Xs?fg(e,t):n}function UC(e,t){return e instanceof da?aa(n=t)||function(i){return!!i&&"doubleValue"in i}(n)?t:{integerValue:0}:null;var n}class ua extends Lr{}class Ys extends Lr{constructor(t){super(),this.elements=t}}function dg(e,t){const n=gg(t);for(const i of e.elements)n.some(s=>Xt(s,i))||n.push(i);return{arrayValue:{values:n}}}class Xs extends Lr{constructor(t){super(),this.elements=t}}function fg(e,t){let n=gg(t);for(const i of e.elements)n=n.filter(s=>!Xt(s,i));return{arrayValue:{values:n}}}class da extends Lr{constructor(t,n){super(),this.wt=t,this._t=n}}function su(e){return ct(e.integerValue||e.doubleValue)}function gg(e){return ml(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function HC(e,t){return e.field.isEqual(t.field)&&function(n,i){return n instanceof Ys&&i instanceof Ys||n instanceof Xs&&i instanceof Xs?En(n.elements,i.elements,Xt):n instanceof da&&i instanceof da?Xt(n._t,i._t):n instanceof ua&&i instanceof ua}(e.transform,t.transform)}class je{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new je}static exists(t){return new je(void 0,t)}static updateTime(t){return new je(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function ws(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class _l{}function pg(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new KC(e.key,je.none()):new xl(e.key,e.data,je.none());{const n=e.data,i=qt.empty();let s=new ft(Rt.comparator);for(let r of t.fields)if(!s.has(r)){let o=n.field(r);o===null&&r.length>1&&(r=r.popLast(),o=n.field(r)),o===null?i.delete(r):i.set(r,o),s=s.add(r)}return new Nr(e.key,i,new $e(s.toArray()),je.none())}}function WC(e,t,n){e instanceof xl?function(i,s,r){const o=i.value.clone(),a=ou(i.fieldTransforms,s,r.transformResults);o.setAll(a),s.convertToFoundDocument(r.version,o).setHasCommittedMutations()}(e,t,n):e instanceof Nr?function(i,s,r){if(!ws(i.precondition,s))return void s.convertToUnknownDocument(r.version);const o=ou(i.fieldTransforms,s,r.transformResults),a=s.data;a.setAll(mg(i)),a.setAll(o),s.convertToFoundDocument(r.version,a).setHasCommittedMutations()}(e,t,n):function(i,s,r){s.convertToNoDocument(r.version).setHasCommittedMutations()}(0,t,n)}function hi(e,t,n,i){return e instanceof xl?function(s,r,o,a){if(!ws(s.precondition,r))return o;const l=s.value.clone(),c=au(s.fieldTransforms,a,r);return l.setAll(c),r.convertToFoundDocument(r.version,l).setHasLocalMutations(),null}(e,t,n,i):e instanceof Nr?function(s,r,o,a){if(!ws(s.precondition,r))return o;const l=au(s.fieldTransforms,a,r),c=r.data;return c.setAll(mg(s)),c.setAll(l),r.convertToFoundDocument(r.version,c).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(e,t,n,i):function(s,r,o){return ws(s.precondition,r)?(r.convertToNoDocument(r.version).setHasLocalMutations(),null):o}(e,t,n)}function ru(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&En(n,i,(s,r)=>HC(s,r))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class xl extends _l{constructor(t,n,i,s=[]){super(),this.key=t,this.value=n,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Nr extends _l{constructor(t,n,i,s,r=[]){super(),this.key=t,this.data=n,this.fieldMask=i,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function mg(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}}),t}function ou(e,t,n){const i=new Map;ht(e.length===n.length);for(let s=0;s<n.length;s++){const r=e[s],o=r.transform,a=t.data.field(r.field);i.set(r.field,zC(o,a,n[s]))}return i}function au(e,t,n){const i=new Map;for(const s of e){const r=s.transform,o=n.data.field(s.field);i.set(s.field,jC(r,o,t))}return i}class KC extends _l{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(t){this.count=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lt,z;function yg(e){if(e===void 0)return le("GRPC error has no .code"),T.UNKNOWN;switch(e){case lt.OK:return T.OK;case lt.CANCELLED:return T.CANCELLED;case lt.UNKNOWN:return T.UNKNOWN;case lt.DEADLINE_EXCEEDED:return T.DEADLINE_EXCEEDED;case lt.RESOURCE_EXHAUSTED:return T.RESOURCE_EXHAUSTED;case lt.INTERNAL:return T.INTERNAL;case lt.UNAVAILABLE:return T.UNAVAILABLE;case lt.UNAUTHENTICATED:return T.UNAUTHENTICATED;case lt.INVALID_ARGUMENT:return T.INVALID_ARGUMENT;case lt.NOT_FOUND:return T.NOT_FOUND;case lt.ALREADY_EXISTS:return T.ALREADY_EXISTS;case lt.PERMISSION_DENIED:return T.PERMISSION_DENIED;case lt.FAILED_PRECONDITION:return T.FAILED_PRECONDITION;case lt.ABORTED:return T.ABORTED;case lt.OUT_OF_RANGE:return T.OUT_OF_RANGE;case lt.UNIMPLEMENTED:return T.UNIMPLEMENTED;case lt.DATA_LOSS:return T.DATA_LOSS;default:return N()}}(z=lt||(lt={}))[z.OK=0]="OK",z[z.CANCELLED=1]="CANCELLED",z[z.UNKNOWN=2]="UNKNOWN",z[z.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",z[z.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",z[z.NOT_FOUND=5]="NOT_FOUND",z[z.ALREADY_EXISTS=6]="ALREADY_EXISTS",z[z.PERMISSION_DENIED=7]="PERMISSION_DENIED",z[z.UNAUTHENTICATED=16]="UNAUTHENTICATED",z[z.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",z[z.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",z[z.ABORTED=10]="ABORTED",z[z.OUT_OF_RANGE=11]="OUT_OF_RANGE",z[z.UNIMPLEMENTED=12]="UNIMPLEMENTED",z[z.INTERNAL=13]="INTERNAL",z[z.UNAVAILABLE=14]="UNAVAILABLE",z[z.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i!==void 0){for(const[s,r]of i)if(this.equalsFn(s,t))return r}}has(t){return this.get(t)!==void 0}set(t,n){const i=this.mapKeyFn(t),s=this.inner[i];if(s===void 0)return this.inner[i]=[[t,n]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],t))return void(s[r]=[t,n]);s.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return i.length===1?delete this.inner[n]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(t){kr(this.inner,(n,i)=>{for(const[s,r]of i)t(s,r)})}isEmpty(){return vC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GC=new yt(I.comparator);function xe(){return GC}const bg=new yt(I.comparator);function Zn(...e){let t=bg;for(const n of e)t=t.insert(n.key,n);return t}function YC(e){let t=bg;return e.forEach((n,i)=>t=t.insert(n,i.overlayedDocument)),t}function Ne(){return ui()}function vg(){return ui()}function ui(){return new Nn(e=>e.toString(),(e,t)=>e.isEqual(t))}new yt(I.comparator);const XC=new ft(I.comparator);function U(...e){let t=XC;for(const n of e)t=t.add(n);return t}const QC=new ft(G);function _g(){return QC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(t,n,i,s,r){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,n){const i=new Map;return i.set(t,Yi.createSynthesizedTargetChangeForCurrentChange(t,n)),new Fr(F.min(),i,_g(),xe(),U())}}class Yi{constructor(t,n,i,s,r){this.resumeToken=t,this.current=n,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,n){return new Yi(wt.EMPTY_BYTE_STRING,n,U(),U(),U())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(t,n,i,s){this.gt=t,this.removedTargetIds=n,this.key=i,this.yt=s}}class xg{constructor(t,n){this.targetId=t,this.It=n}}class wg{constructor(t,n,i=wt.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=n,this.resumeToken=i,this.cause=s}}class lu{constructor(){this.Tt=0,this.Et=hu(),this.At=wt.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return this.Tt!==0}get vt(){return this.bt}Vt(t){t.approximateByteSize()>0&&(this.bt=!0,this.At=t)}St(){let t=U(),n=U(),i=U();return this.Et.forEach((s,r)=>{switch(r){case 0:t=t.add(s);break;case 2:n=n.add(s);break;case 1:i=i.add(s);break;default:N()}}),new Yi(this.At,this.Rt,t,n,i)}Dt(){this.bt=!1,this.Et=hu()}Ct(t,n){this.bt=!0,this.Et=this.Et.insert(t,n)}xt(t){this.bt=!0,this.Et=this.Et.remove(t)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Mt(){this.bt=!0,this.Rt=!0}}class JC{constructor(t){this.Ot=t,this.Ft=new Map,this.$t=xe(),this.Bt=cu(),this.Lt=new ft(G)}Ut(t){for(const n of t.gt)t.yt&&t.yt.isFoundDocument()?this.qt(n,t.yt):this.Kt(n,t.key,t.yt);for(const n of t.removedTargetIds)this.Kt(n,t.key,t.yt)}Gt(t){this.forEachTarget(t,n=>{const i=this.Qt(n);switch(t.state){case 0:this.jt(n)&&i.Vt(t.resumeToken);break;case 1:i.kt(),i.Pt||i.Dt(),i.Vt(t.resumeToken);break;case 2:i.kt(),i.Pt||this.removeTarget(n);break;case 3:this.jt(n)&&(i.Mt(),i.Vt(t.resumeToken));break;case 4:this.jt(n)&&(this.Wt(n),i.Vt(t.resumeToken));break;default:N()}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.Ft.forEach((i,s)=>{this.jt(s)&&n(s)})}zt(t){const n=t.targetId,i=t.It.count,s=this.Ht(n);if(s){const r=s.target;if(la(r))if(i===0){const o=new I(r.path);this.Kt(n,o,vt.newNoDocument(o,F.min()))}else ht(i===1);else this.Jt(n)!==i&&(this.Wt(n),this.Lt=this.Lt.add(n))}}Yt(t){const n=new Map;this.Ft.forEach((r,o)=>{const a=this.Ht(o);if(a){if(r.current&&la(a.target)){const l=new I(a.target.path);this.$t.get(l)!==null||this.Xt(o,l)||this.Kt(o,l,vt.newNoDocument(l,t))}r.vt&&(n.set(o,r.St()),r.Dt())}});let i=U();this.Bt.forEach((r,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Ht(l);return!c||c.purpose===2||(a=!1,!1)}),a&&(i=i.add(r))}),this.$t.forEach((r,o)=>o.setReadTime(t));const s=new Fr(t,n,this.Lt,this.$t,i);return this.$t=xe(),this.Bt=cu(),this.Lt=new ft(G),s}qt(t,n){if(!this.jt(t))return;const i=this.Xt(t,n.key)?2:0;this.Qt(t).Ct(n.key,i),this.$t=this.$t.insert(n.key,n),this.Bt=this.Bt.insert(n.key,this.Zt(n.key).add(t))}Kt(t,n,i){if(!this.jt(t))return;const s=this.Qt(t);this.Xt(t,n)?s.Ct(n,1):s.xt(n),this.Bt=this.Bt.insert(n,this.Zt(n).delete(t)),i&&(this.$t=this.$t.insert(n,i))}removeTarget(t){this.Ft.delete(t)}Jt(t){const n=this.Qt(t).St();return this.Ot.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}Nt(t){this.Qt(t).Nt()}Qt(t){let n=this.Ft.get(t);return n||(n=new lu,this.Ft.set(t,n)),n}Zt(t){let n=this.Bt.get(t);return n||(n=new ft(G),this.Bt=this.Bt.insert(t,n)),n}jt(t){const n=this.Ht(t)!==null;return n||M("WatchChangeAggregator","Detected inactive target",t),n}Ht(t){const n=this.Ft.get(t);return n&&n.Pt?null:this.Ot.te(t)}Wt(t){this.Ft.set(t,new lu),this.Ot.getRemoteKeysForTarget(t).forEach(n=>{this.Kt(t,n,null)})}Xt(t,n){return this.Ot.getRemoteKeysForTarget(t).has(n)}}function cu(){return new yt(I.comparator)}function hu(){return new yt(I.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZC=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),t1=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class e1{constructor(t,n){this.databaseId=t,this.dt=n}}function n1(e,t){return e.dt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function i1(e,t){return e.dt?t.toBase64():t.toUint8Array()}function ki(e){return ht(!!e),F.fromTimestamp(function(t){const n=_e(t);return new Nt(n.seconds,n.nanos)}(e))}function s1(e,t){return function(n){return new nt(["projects",n.projectId,"databases",n.database])}(e).child("documents").child(t).canonicalString()}function Sg(e){const t=nt.fromString(e);return ht(Cg(t)),t}function wo(e,t){const n=Sg(t);if(n.get(1)!==e.databaseId.projectId)throw new k(T.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new k(T.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new I(Eg(n))}function fa(e,t){return s1(e.databaseId,t)}function r1(e){const t=Sg(e);return t.length===4?nt.emptyPath():Eg(t)}function uu(e){return new nt(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Eg(e){return ht(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function o1(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:N()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],r=function(l,c){return l.dt?(ht(c===void 0||typeof c=="string"),wt.fromBase64String(c||"")):(ht(c===void 0||c instanceof Uint8Array),wt.fromUint8Array(c||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(l){const c=l.code===void 0?T.UNKNOWN:yg(l.code);return new k(c,l.message||"")}(o);n=new wg(i,s,r,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const s=wo(e,i.document.name),r=ki(i.document.updateTime),o=new qt({mapValue:{fields:i.document.fields}}),a=vt.newFoundDocument(s,r,o),l=i.targetIds||[],c=i.removedTargetIds||[];n=new Ss(l,c,a.key,a)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const s=wo(e,i.document),r=i.readTime?ki(i.readTime):F.min(),o=vt.newNoDocument(s,r),a=i.removedTargetIds||[];n=new Ss([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const s=wo(e,i.document),r=i.removedTargetIds||[];n=new Ss([],r,s,null)}else{if(!("filter"in t))return N();{t.filter;const i=t.filter;i.targetId;const s=i.count||0,r=new qC(s),o=i.targetId;n=new xg(o,r)}}return n}function a1(e,t){return{documents:[fa(e,t.path)]}}function l1(e,t){const n={structuredQuery:{}},i=t.path;t.collectionGroup!==null?(n.parent=fa(e,i),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=fa(e,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const s=function(l){if(l.length===0)return;const c=l.map(h=>function(u){if(u.op==="=="){if(Zh(u.value))return{unaryFilter:{field:cn(u.field),op:"IS_NAN"}};if(Jh(u.value))return{unaryFilter:{field:cn(u.field),op:"IS_NULL"}}}else if(u.op==="!="){if(Zh(u.value))return{unaryFilter:{field:cn(u.field),op:"IS_NOT_NAN"}};if(Jh(u.value))return{unaryFilter:{field:cn(u.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cn(u.field),op:d1(u.op),value:u.value}}}(h));return c.length===1?c[0]:{compositeFilter:{op:"AND",filters:c}}}(t.filters);s&&(n.structuredQuery.where=s);const r=function(l){if(l.length!==0)return l.map(c=>function(h){return{field:cn(h.field),direction:u1(h.dir)}}(c))}(t.orderBy);r&&(n.structuredQuery.orderBy=r);const o=function(l,c){return l.dt||Or(c)?c:{value:c}}(e,t.limit);var a;return o!==null&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(a=t.startAt).inclusive,values:a.position}),t.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(t.endAt)),n}function c1(e){let t=r1(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){ht(i===1);const h=n.from[0];h.allDescendants?s=h.collectionId:t=t.child(h.collectionId)}let r=[];n.where&&(r=Tg(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(h=>function(u){return new ci(un(u.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(u.direction))}(h)));let a=null;n.limit&&(a=function(h){let u;return u=typeof h=="object"?h.value:h,Or(u)?null:u}(n.limit));let l=null;n.startAt&&(l=function(h){const u=!!h.before,d=h.values||[];return new Gs(d,u)}(n.startAt));let c=null;return n.endAt&&(c=function(h){const u=!h.before,d=h.values||[];return new Gs(d,u)}(n.endAt)),PC(t,s,o,r,a,"F",l,c)}function h1(e,t){const n=function(i,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return N()}}(0,t.purpose);return n==null?null:{"goog-listen-tags":n}}function Tg(e){return e?e.unaryFilter!==void 0?[g1(e)]:e.fieldFilter!==void 0?[f1(e)]:e.compositeFilter!==void 0?e.compositeFilter.filters.map(t=>Tg(t)).reduce((t,n)=>t.concat(n)):N():[]}function u1(e){return ZC[e]}function d1(e){return t1[e]}function cn(e){return{fieldPath:e.canonicalString()}}function un(e){return Rt.fromServerFormat(e.fieldPath)}function f1(e){return Lt.create(un(e.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return N()}}(e.fieldFilter.op),e.fieldFilter.value)}function g1(e){switch(e.unaryFilter.op){case"IS_NAN":const t=un(e.unaryFilter.field);return Lt.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=un(e.unaryFilter.field);return Lt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=un(e.unaryFilter.field);return Lt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=un(e.unaryFilter.field);return Lt.create(s,"!=",{nullValue:"NULL_VALUE"});default:return N()}}function Cg(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(t,n,i,s){this.batchId=t,this.localWriteTime=n,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(t,n){const i=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(t.key)&&WC(r,t,i[s])}}applyToLocalView(t,n){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(n=hi(i,t,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(n=hi(i,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const i=vg();return this.mutations.forEach(s=>{const r=t.get(s.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=n.has(s.key)?null:a;const l=pg(o,a);l!==null&&i.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(F.min())}),i}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),U())}isEqual(t){return this.batchId===t.batchId&&En(this.mutations,t.mutations,(n,i)=>ru(n,i))&&En(this.baseMutations,t.baseMutations,(n,i)=>ru(n,i))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(t,n,i,s,r=F.min(),o=F.min(),a=wt.EMPTY_BYTE_STRING){this.target=t,this.targetId=n,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(t){return new ze(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,n){return new ze(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new ze(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(t){this.ne=t}}function b1(e){const t=c1({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?ca(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(){this.ze=new _1}addToCollectionParentIndex(t,n){return this.ze.add(n),w.resolve()}getCollectionParents(t,n){return w.resolve(this.ze.getEntries(n))}addFieldIndex(t,n){return w.resolve()}deleteFieldIndex(t,n){return w.resolve()}getDocumentsMatchingTarget(t,n){return w.resolve(null)}getIndexType(t,n){return w.resolve(0)}getFieldIndexes(t,n){return w.resolve([])}getNextCollectionGroupToUpdate(t){return w.resolve(null)}getMinOffset(t,n){return w.resolve(ve.min())}getMinOffsetFromCollectionGroup(t,n){return w.resolve(ve.min())}updateCollectionGroup(t,n,i){return w.resolve()}updateIndexEntries(t,n){return w.resolve()}}class _1{constructor(){this.index={}}add(t){const n=t.lastSegment(),i=t.popLast(),s=this.index[n]||new ft(nt.comparator),r=!s.has(i);return this.index[n]=s.add(i),r}has(t){const n=t.lastSegment(),i=t.popLast(),s=this.index[n];return s&&s.has(i)}getEntries(t){return(this.index[t]||new ft(nt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(t){this.En=t}next(){return this.En+=2,this.En}static An(){return new Dn(0)}static Rn(){return new Dn(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(){this.changes=new Nn(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,vt.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?w.resolve(i):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(t,n,i,s){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=s}getDocument(t,n){let i=null;return this.documentOverlayCache.getOverlay(t,n).next(s=>(i=s,this.getBaseDocument(t,n,i))).next(s=>(i!==null&&hi(i.mutation,s,$e.empty(),Nt.now()),s))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.getLocalViewOfDocuments(t,i,U()).next(()=>i))}getLocalViewOfDocuments(t,n,i=U()){const s=Ne();return this.populateOverlays(t,s,n).next(()=>this.computeViews(t,n,s,i).next(r=>{let o=Zn();return r.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const i=Ne();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,U()))}populateOverlays(t,n,i){const s=[];return i.forEach(r=>{n.has(r)||s.push(r)}),this.documentOverlayCache.getOverlays(t,s).next(r=>{r.forEach((o,a)=>{n.set(o,a)})})}computeViews(t,n,i,s){let r=xe();const o=ui(),a=ui();return n.forEach((l,c)=>{const h=i.get(c.key);s.has(c.key)&&(h===void 0||h.mutation instanceof Nr)?r=r.insert(c.key,c):h!==void 0&&(o.set(c.key,h.mutation.getFieldMask()),hi(h.mutation,c,h.mutation.getFieldMask(),Nt.now()))}),this.recalculateAndSaveOverlays(t,r).next(l=>(l.forEach((c,h)=>o.set(c,h)),n.forEach((c,h)=>{var u;return a.set(c,new w1(h,(u=o.get(c))!==null&&u!==void 0?u:null))}),a))}recalculateAndSaveOverlays(t,n){const i=ui();let s=new yt((o,a)=>o-a),r=U();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let h=i.get(l)||$e.empty();h=a.applyToLocalView(c,h),i.set(l,h);const u=(s.get(a.batchId)||U()).add(l);s=s.insert(a.batchId,u)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,h=l.value,u=vg();h.forEach(d=>{if(!r.has(d)){const f=pg(n.get(d),i.get(d));f!==null&&u.set(d,f),r=r.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(t,c,u))}return w.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,n,i){return function(s){return I.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):NC(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,i):this.getDocumentsMatchingCollectionQuery(t,n,i)}getNextDocuments(t,n,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,i,s).next(r=>{const o=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,i.largestBatchId,s-r.size):w.resolve(Ne());let a=-1,l=r;return o.next(c=>w.forEach(c,(h,u)=>(a<u.largestBatchId&&(a=u.largestBatchId),r.get(h)?w.resolve():this.getBaseDocument(t,h,u).next(d=>{l=l.insert(h,d)}))).next(()=>this.populateOverlays(t,c,r)).next(()=>this.computeViews(t,l,c,U())).next(h=>({batchId:a,changes:YC(h)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new I(n)).next(i=>{let s=Zn();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s})}getDocumentsMatchingCollectionGroupQuery(t,n,i){const s=n.collectionGroup;let r=Zn();return this.indexManager.getCollectionParents(t,s).next(o=>w.forEach(o,a=>{const l=function(c,h){return new Pr(h,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,a.child(s));return this.getDocumentsMatchingCollectionQuery(t,l,i).next(c=>{c.forEach((h,u)=>{r=r.insert(h,u)})})}).next(()=>r))}getDocumentsMatchingCollectionQuery(t,n,i){let s;return this.remoteDocumentCache.getAllFromCollection(t,n.path,i).next(r=>(s=r,this.documentOverlayCache.getOverlaysForCollection(t,n.path,i.largestBatchId))).next(r=>{r.forEach((a,l)=>{const c=l.getKey();s.get(c)===null&&(s=s.insert(c,vt.newInvalidDocument(c)))});let o=Zn();return s.forEach((a,l)=>{const c=r.get(a);c!==void 0&&hi(c.mutation,l,$e.empty(),Nt.now()),vl(n,l)&&(o=o.insert(a,l))}),o})}getBaseDocument(t,n,i){return i===null||i.mutation.type===1?this.remoteDocumentCache.getEntry(t,n):w.resolve(vt.newInvalidDocument(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(t){this.wt=t,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(t,n){return w.resolve(this.Jn.get(n))}saveBundleMetadata(t,n){var i;return this.Jn.set(n.id,{id:(i=n).id,version:i.version,createTime:ki(i.createTime)}),w.resolve()}getNamedQuery(t,n){return w.resolve(this.Yn.get(n))}saveNamedQuery(t,n){return this.Yn.set(n.name,function(i){return{name:i.name,query:b1(i.bundledQuery),readTime:ki(i.readTime)}}(n)),w.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(){this.overlays=new yt(I.comparator),this.Xn=new Map}getOverlay(t,n){return w.resolve(this.overlays.get(n))}getOverlays(t,n){const i=Ne();return w.forEach(n,s=>this.getOverlay(t,s).next(r=>{r!==null&&i.set(s,r)})).next(()=>i)}saveOverlays(t,n,i){return i.forEach((s,r)=>{this.ie(t,n,r)}),w.resolve()}removeOverlaysForBatchId(t,n,i){const s=this.Xn.get(i);return s!==void 0&&(s.forEach(r=>this.overlays=this.overlays.remove(r)),this.Xn.delete(i)),w.resolve()}getOverlaysForCollection(t,n,i){const s=Ne(),r=n.length+1,o=new I(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===r&&l.largestBatchId>i&&s.set(l.getKey(),l)}return w.resolve(s)}getOverlaysForCollectionGroup(t,n,i,s){let r=new yt((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>i){let h=r.get(c.largestBatchId);h===null&&(h=Ne(),r=r.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=Ne(),l=r.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=s)););return w.resolve(a)}ie(t,n,i){const s=this.overlays.get(i.key);if(s!==null){const o=this.Xn.get(s.largestBatchId).delete(i.key);this.Xn.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new m1(n,i));let r=this.Xn.get(n);r===void 0&&(r=U(),this.Xn.set(n,r)),this.Xn.set(n,r.add(i.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(){this.Zn=new ft(gt.ts),this.es=new ft(gt.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(t,n){const i=new gt(t,n);this.Zn=this.Zn.add(i),this.es=this.es.add(i)}ss(t,n){t.forEach(i=>this.addReference(i,n))}removeReference(t,n){this.rs(new gt(t,n))}os(t,n){t.forEach(i=>this.removeReference(i,n))}us(t){const n=new I(new nt([])),i=new gt(n,t),s=new gt(n,t+1),r=[];return this.es.forEachInRange([i,s],o=>{this.rs(o),r.push(o.key)}),r}cs(){this.Zn.forEach(t=>this.rs(t))}rs(t){this.Zn=this.Zn.delete(t),this.es=this.es.delete(t)}hs(t){const n=new I(new nt([])),i=new gt(n,t),s=new gt(n,t+1);let r=U();return this.es.forEachInRange([i,s],o=>{r=r.add(o.key)}),r}containsKey(t){const n=new gt(t,0),i=this.Zn.firstAfterOrEqual(n);return i!==null&&t.isEqual(i.key)}}class gt{constructor(t,n){this.key=t,this.ls=n}static ts(t,n){return I.comparator(t.key,n.key)||G(t.ls,n.ls)}static ns(t,n){return G(t.ls,n.ls)||I.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new ft(gt.ts)}checkEmpty(t){return w.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,i,s){const r=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new p1(r,n,i,s);this.mutationQueue.push(o);for(const a of s)this.ds=this.ds.add(new gt(a.key,r)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return w.resolve(o)}lookupMutationBatch(t,n){return w.resolve(this._s(n))}getNextMutationBatchAfterBatchId(t,n){const i=n+1,s=this.ws(i),r=s<0?0:s;return w.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return w.resolve(this.mutationQueue.length===0?-1:this.fs-1)}getAllMutationBatches(t){return w.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const i=new gt(n,0),s=new gt(n,Number.POSITIVE_INFINITY),r=[];return this.ds.forEachInRange([i,s],o=>{const a=this._s(o.ls);r.push(a)}),w.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,n){let i=new ft(G);return n.forEach(s=>{const r=new gt(s,0),o=new gt(s,Number.POSITIVE_INFINITY);this.ds.forEachInRange([r,o],a=>{i=i.add(a.ls)})}),w.resolve(this.gs(i))}getAllMutationBatchesAffectingQuery(t,n){const i=n.path,s=i.length+1;let r=i;I.isDocumentKey(r)||(r=r.child(""));const o=new gt(new I(r),0);let a=new ft(G);return this.ds.forEachWhile(l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.ls)),!0)},o),w.resolve(this.gs(a))}gs(t){const n=[];return t.forEach(i=>{const s=this._s(i);s!==null&&n.push(s)}),n}removeMutationBatch(t,n){ht(this.ys(n.batchId,"removed")===0),this.mutationQueue.shift();let i=this.ds;return w.forEach(n.mutations,s=>{const r=new gt(s.key,n.batchId);return i=i.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.ds=i})}In(t){}containsKey(t,n){const i=new gt(n,0),s=this.ds.firstAfterOrEqual(i);return w.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,w.resolve()}ys(t,n){return this.ws(t)}ws(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}_s(t){const n=this.ws(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(t){this.ps=t,this.docs=new yt(I.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const i=n.key,s=this.docs.get(i),r=s?s.size:0,o=this.ps(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const i=this.docs.get(n);return w.resolve(i?i.document.mutableCopy():vt.newInvalidDocument(n))}getEntries(t,n){let i=xe();return n.forEach(s=>{const r=this.docs.get(s);i=i.insert(s,r?r.document.mutableCopy():vt.newInvalidDocument(s))}),w.resolve(i)}getAllFromCollection(t,n,i){let s=xe();const r=new I(n.child("")),o=this.docs.getIteratorFrom(r);for(;o.hasNext();){const{key:a,value:{document:l}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||mC(pC(l),i)<=0||(s=s.insert(l.key,l.mutableCopy()))}return w.resolve(s)}getAllFromCollectionGroup(t,n,i,s){N()}Is(t,n){return w.forEach(this.docs,i=>n(i))}newChangeBuffer(t){return new D1(this)}getSize(t){return w.resolve(this.size)}}class D1 extends x1{constructor(t){super(),this.zn=t}applyChanges(t){const n=[];return this.changes.forEach((i,s)=>{s.isValidDocument()?n.push(this.zn.addEntry(t,s)):this.zn.removeEntry(i)}),w.waitFor(n)}getFromCache(t,n){return this.zn.getEntry(t,n)}getAllFromCache(t,n){return this.zn.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(t){this.persistence=t,this.Ts=new Nn(n=>yl(n),bl),this.lastRemoteSnapshotVersion=F.min(),this.highestTargetId=0,this.Es=0,this.As=new wl,this.targetCount=0,this.Rs=Dn.An()}forEachTarget(t,n){return this.Ts.forEach((i,s)=>n(s)),w.resolve()}getLastRemoteSnapshotVersion(t){return w.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return w.resolve(this.Es)}allocateTargetId(t){return this.highestTargetId=this.Rs.next(),w.resolve(this.highestTargetId)}setTargetsMetadata(t,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.Es&&(this.Es=n),w.resolve()}vn(t){this.Ts.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.Rs=new Dn(n),this.highestTargetId=n),t.sequenceNumber>this.Es&&(this.Es=t.sequenceNumber)}addTargetData(t,n){return this.vn(n),this.targetCount+=1,w.resolve()}updateTargetData(t,n){return this.vn(n),w.resolve()}removeTargetData(t,n){return this.Ts.delete(n.target),this.As.us(n.targetId),this.targetCount-=1,w.resolve()}removeTargets(t,n,i){let s=0;const r=[];return this.Ts.forEach((o,a)=>{a.sequenceNumber<=n&&i.get(a.targetId)===null&&(this.Ts.delete(o),r.push(this.removeMatchingKeysForTargetId(t,a.targetId)),s++)}),w.waitFor(r).next(()=>s)}getTargetCount(t){return w.resolve(this.targetCount)}getTargetData(t,n){const i=this.Ts.get(n)||null;return w.resolve(i)}addMatchingKeys(t,n,i){return this.As.ss(n,i),w.resolve()}removeMatchingKeys(t,n,i){this.As.os(n,i);const s=this.persistence.referenceDelegate,r=[];return s&&n.forEach(o=>{r.push(s.markPotentiallyOrphaned(t,o))}),w.waitFor(r)}removeMatchingKeysForTargetId(t,n){return this.As.us(n),w.resolve()}getMatchingKeysForTargetId(t,n){const i=this.As.hs(n);return w.resolve(i)}containsKey(t,n){return w.resolve(this.As.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(t,n){this.bs={},this.overlays={},this.Ps=new pl(0),this.vs=!1,this.vs=!0,this.referenceDelegate=t(this),this.Vs=new M1(this),this.indexManager=new v1,this.remoteDocumentCache=function(i){return new A1(i)}(i=>this.referenceDelegate.Ss(i)),this.wt=new y1(n),this.Ds=new E1(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new T1,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let i=this.bs[t.toKey()];return i||(i=new C1(n,this.referenceDelegate),this.bs[t.toKey()]=i),i}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(t,n,i){M("MemoryPersistence","Starting transaction:",t);const s=new k1(this.Ps.next());return this.referenceDelegate.Cs(),i(s).next(r=>this.referenceDelegate.xs(s).next(()=>r)).toPromise().then(r=>(s.raiseOnCommittedEvent(),r))}Ns(t,n){return w.or(Object.values(this.bs).map(i=>()=>i.containsKey(t,n)))}}class k1 extends bC{constructor(t){super(),this.currentSequenceNumber=t}}class Sl{constructor(t){this.persistence=t,this.ks=new wl,this.Ms=null}static Os(t){return new Sl(t)}get Fs(){if(this.Ms)return this.Ms;throw N()}addReference(t,n,i){return this.ks.addReference(i,n),this.Fs.delete(i.toString()),w.resolve()}removeReference(t,n,i){return this.ks.removeReference(i,n),this.Fs.add(i.toString()),w.resolve()}markPotentiallyOrphaned(t,n){return this.Fs.add(n.toString()),w.resolve()}removeTarget(t,n){this.ks.us(n.targetId).forEach(s=>this.Fs.add(s.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,n.targetId).next(s=>{s.forEach(r=>this.Fs.add(r.toString()))}).next(()=>i.removeTargetData(t,n))}Cs(){this.Ms=new Set}xs(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return w.forEach(this.Fs,i=>{const s=I.fromPath(i);return this.$s(t,s).next(r=>{r||n.removeEntry(s,F.min())})}).next(()=>(this.Ms=null,n.apply(t)))}updateLimboDocument(t,n){return this.$s(t,n).next(i=>{i?this.Fs.delete(n.toString()):this.Fs.add(n.toString())})}Ss(t){return 0}$s(t,n){return w.or([()=>w.resolve(this.ks.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ns(t,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(t,n,i,s){this.targetId=t,this.fromCache=n,this.Pi=i,this.vi=s}static Vi(t,n){let i=U(),s=U();for(const r of n.docChanges)switch(r.type){case 0:i=i.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new El(t,n.fromCache,i,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(){this.Si=!1}initialize(t,n){this.Di=t,this.indexManager=n,this.Si=!0}getDocumentsMatchingQuery(t,n,i,s){return this.Ci(t,n).next(r=>r||this.xi(t,n,s,i)).next(r=>r||this.Ni(t,n))}Ci(t,n){if(iu(n))return w.resolve(null);let i=ce(n);return this.indexManager.getIndexType(t,i).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=ca(n,null,"F"),i=ce(n)),this.indexManager.getDocumentsMatchingTarget(t,i).next(r=>{const o=U(...r);return this.Di.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,i).next(l=>{const c=this.ki(n,a);return this.Mi(n,c,o,l.readTime)?this.Ci(t,ca(n,null,"F")):this.Oi(t,c,n,l)}))})))}xi(t,n,i,s){return iu(n)||s.isEqual(F.min())?this.Ni(t,n):this.Di.getDocuments(t,i).next(r=>{const o=this.ki(n,r);return this.Mi(n,o,i,s)?this.Ni(t,n):(qh()<=K.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ha(n)),this.Oi(t,o,n,gC(s,-1)))})}ki(t,n){let i=new ft(ug(t));return n.forEach((s,r)=>{vl(t,r)&&(i=i.add(r))}),i}Mi(t,n,i,s){if(t.limit===null)return!1;if(i.size!==n.size)return!0;const r=t.limitType==="F"?n.last():n.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}Ni(t,n){return qh()<=K.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",ha(n)),this.Di.getDocumentsMatchingQuery(t,n,ve.min())}Oi(t,n,i,s){return this.Di.getDocumentsMatchingQuery(t,i,s).next(r=>(n.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(t,n,i,s){this.persistence=t,this.Fi=n,this.wt=s,this.$i=new yt(G),this.Bi=new Nn(r=>yl(r),bl),this.Li=new Map,this.Ui=t.getRemoteDocumentCache(),this.Vs=t.getTargetCache(),this.Ds=t.getBundleCache(),this.qi(i)}qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new S1(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.$i))}}function R1(e,t,n,i){return new P1(e,t,n,i)}async function Ag(e,t){const n=W(e);return await n.persistence.runTransaction("Handle user change","readonly",i=>{let s;return n.mutationQueue.getAllMutationBatches(i).next(r=>(s=r,n.qi(t),n.mutationQueue.getAllMutationBatches(i))).next(r=>{const o=[],a=[];let l=U();for(const c of s){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of r){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(i,l).next(c=>({Ki:c,removedBatchIds:o,addedBatchIds:a}))})})}function Dg(e){const t=W(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.Vs.getLastRemoteSnapshotVersion(n))}function L1(e,t){const n=W(e),i=t.snapshotVersion;let s=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=n.Ui.newChangeBuffer({trackRemovals:!0});s=n.$i;const a=[];t.targetChanges.forEach((h,u)=>{const d=s.get(u);if(!d)return;a.push(n.Vs.removeMatchingKeys(r,h.removedDocuments,u).next(()=>n.Vs.addMatchingKeys(r,h.addedDocuments,u)));let f=d.withSequenceNumber(r.currentSequenceNumber);t.targetMismatches.has(u)?f=f.withResumeToken(wt.EMPTY_BYTE_STRING,F.min()).withLastLimboFreeSnapshotVersion(F.min()):h.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(h.resumeToken,i)),s=s.insert(u,f),function(g,p,m){return g.resumeToken.approximateByteSize()===0||p.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:m.addedDocuments.size+m.modifiedDocuments.size+m.removedDocuments.size>0}(d,f,h)&&a.push(n.Vs.updateTargetData(r,f))});let l=xe(),c=U();if(t.documentUpdates.forEach(h=>{t.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(r,h))}),a.push(N1(r,o,t.documentUpdates).next(h=>{l=h.Gi,c=h.Qi})),!i.isEqual(F.min())){const h=n.Vs.getLastRemoteSnapshotVersion(r).next(u=>n.Vs.setTargetsMetadata(r,r.currentSequenceNumber,i));a.push(h)}return w.waitFor(a).next(()=>o.apply(r)).next(()=>n.localDocuments.getLocalViewOfDocuments(r,l,c)).next(()=>l)}).then(r=>(n.$i=s,r))}function N1(e,t,n){let i=U(),s=U();return n.forEach(r=>i=i.add(r)),t.getEntries(e,i).next(r=>{let o=xe();return n.forEach((a,l)=>{const c=r.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(F.min())?(t.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),o=o.insert(a,l)):M("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Gi:o,Qi:s}})}function F1(e,t){const n=W(e);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let s;return n.Vs.getTargetData(i,t).next(r=>r?(s=r,w.resolve(s)):n.Vs.allocateTargetId(i).next(o=>(s=new ze(t,o,0,i.currentSequenceNumber),n.Vs.addTargetData(i,s).next(()=>s))))}).then(i=>{const s=n.$i.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.$i=n.$i.insert(i.targetId,i),n.Bi.set(t,i.targetId)),i})}async function ga(e,t,n){const i=W(e),s=i.$i.get(t),r=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",r,o=>i.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Gi(o))throw o;M("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}i.$i=i.$i.remove(t),i.Bi.delete(s.target)}function du(e,t,n){const i=W(e);let s=F.min(),r=U();return i.persistence.runTransaction("Execute query","readonly",o=>function(a,l,c){const h=W(a),u=h.Bi.get(c);return u!==void 0?w.resolve(h.$i.get(u)):h.Vs.getTargetData(l,c)}(i,o,ce(t)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,i.Vs.getMatchingKeysForTargetId(o,a.targetId).next(l=>{r=l})}).next(()=>i.Fi.getDocumentsMatchingQuery(o,t,n?s:F.min(),n?r:U())).next(a=>(B1(i,FC(t),a),{documents:a,ji:r})))}function B1(e,t,n){let i=F.min();n.forEach((s,r)=>{r.readTime.compareTo(i)>0&&(i=r.readTime)}),e.Li.set(t,i)}class fu{constructor(){this.activeTargetIds=_g()}Xi(t){this.activeTargetIds=this.activeTargetIds.add(t)}Zi(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Yi(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class V1{constructor(){this.Fr=new fu,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,i){}addLocalQueryTarget(t){return this.Fr.Xi(t),this.$r[t]||"not-current"}updateQueryState(t,n,i){this.$r[t]=n}removeLocalQueryTarget(t){this.Fr.Zi(t)}isLocalQueryTarget(t){return this.Fr.activeTargetIds.has(t)}clearQueryState(t){delete this.$r[t]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(t){return this.Fr.activeTargetIds.has(t)}start(){return this.Fr=new fu,Promise.resolve()}handleUserChange(t,n,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{Br(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(t){this.Gr.push(t)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){M("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Gr)t(0)}Kr(){M("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Gr)t(1)}static V(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(t){this.jr=t.jr,this.Wr=t.Wr}zr(t){this.Hr=t}Jr(t){this.Yr=t}onMessage(t){this.Xr=t}close(){this.Wr()}send(t){this.jr(t)}Zr(){this.Hr()}eo(t){this.Yr(t)}no(t){this.Xr(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1 extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http";this.so=n+"://"+t.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(t,n,i,s,r){const o=this.oo(t,n);M("RestConnection","Sending: ",o,i);const a={};return this.uo(a,s,r),this.co(t,o,a,i).then(l=>(M("RestConnection","Received: ",l),l),l=>{throw Gh("RestConnection",`${t} failed with error: `,l,"url: ",o,"request:",i),l})}ao(t,n,i,s,r,o){return this.ro(t,n,i,s,r)}uo(t,n,i){t["X-Goog-Api-Client"]="gl-js/ fire/"+Ln,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,r)=>t[r]=s),i&&i.headers.forEach((s,r)=>t[r]=s)}oo(t,n){const i=j1[t];return`${this.so}/v1/${n}:${i}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}co(t,n,i,s){return new Promise((r,o)=>{const a=new iC;a.listenOnce(tC.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case _o.NO_ERROR:const c=a.getResponseJson();M("Connection","XHR received:",JSON.stringify(c)),r(c);break;case _o.TIMEOUT:M("Connection",'RPC "'+t+'" timed out'),o(new k(T.DEADLINE_EXCEEDED,"Request time out"));break;case _o.HTTP_ERROR:const h=a.getStatus();if(M("Connection",'RPC "'+t+'" failed with status:',h,"response text:",a.getResponseText()),h>0){const u=a.getResponseJson().error;if(u&&u.status&&u.message){const d=function(f){const g=f.toLowerCase().replace(/_/g,"-");return Object.values(T).indexOf(g)>=0?g:T.UNKNOWN}(u.status);o(new k(d,u.message))}else o(new k(T.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new k(T.UNAVAILABLE,"Connection failed."));break;default:N()}}finally{M("Connection",'RPC "'+t+'" completed.')}});const l=JSON.stringify(s);a.send(n,"POST",l,i,15)})}ho(t,n,i){const s=[this.so,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=JT(),o=ZT(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new nC({})),this.uo(a.initMessageHeaders,n,i),kS()||PS()||RS()||LS()||NS()||OS()||(a.httpHeadersOverwriteParam="$httpHeaders");const l=s.join("");M("Connection","Creating WebChannel: "+l,a);const c=r.createWebChannel(l,a);let h=!1,u=!1;const d=new z1({jr:g=>{u?M("Connection","Not sending because WebChannel is closed:",g):(h||(M("Connection","Opening WebChannel transport."),c.open(),h=!0),M("Connection","WebChannel sending:",g),c.send(g))},Wr:()=>c.close()}),f=(g,p,m)=>{g.listen(p,y=>{try{m(y)}catch(b){setTimeout(()=>{throw b},0)}})};return f(c,ps.EventType.OPEN,()=>{u||M("Connection","WebChannel transport opened.")}),f(c,ps.EventType.CLOSE,()=>{u||(u=!0,M("Connection","WebChannel transport closed"),d.eo())}),f(c,ps.EventType.ERROR,g=>{u||(u=!0,Gh("Connection","WebChannel transport errored:",g),d.eo(new k(T.UNAVAILABLE,"The operation could not be completed")))}),f(c,ps.EventType.MESSAGE,g=>{var p;if(!u){const m=g.data[0];ht(!!m);const y=m,b=y.error||((p=y[0])===null||p===void 0?void 0:p.error);if(b){M("Connection","WebChannel received error:",b);const _=b.status;let x=function(E){const S=lt[E];if(S!==void 0)return yg(S)}(_),v=b.message;x===void 0&&(x=T.INTERNAL,v="Unknown error status: "+_+" with message "+b.message),u=!0,d.eo(new k(x,v)),c.close()}else M("Connection","WebChannel received:",m),d.no(m)}}),f(o,eC.STAT_EVENT,g=>{g.stat===Wh.PROXY?M("Connection","Detected buffering proxy"):g.stat===Wh.NOPROXY&&M("Connection","Detected no buffering proxy")}),setTimeout(()=>{d.Zr()},0),d}}function So(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mg(e){return new e1(e,!0)}class Ig{constructor(t,n,i=1e3,s=1.5,r=6e4){this.js=t,this.timerId=n,this.lo=i,this.fo=s,this._o=r,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(t){this.cancel();const n=Math.floor(this.wo+this.To()),i=Math.max(0,Date.now()-this.yo),s=Math.max(0,n-i);s>0&&M("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.wo} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,s,()=>(this.yo=Date.now(),t())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){this.mo!==null&&(this.mo.skipDelay(),this.mo=null)}cancel(){this.mo!==null&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1{constructor(t,n,i,s,r,o,a,l){this.js=t,this.Ao=i,this.Ro=s,this.bo=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new Ig(t,n)}Do(){return this.state===1||this.state===5||this.Co()}Co(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&this.vo===null&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Mo()))}Oo(t){this.Fo(),this.stream.send(t)}async Mo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(t,n){this.Fo(),this.$o(),this.So.cancel(),this.Po++,t!==4?this.So.reset():n&&n.code===T.RESOURCE_EXHAUSTED?(le(n.toString()),le("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===T.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Bo(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Jr(n)}Bo(){}auth(){this.state=1;const t=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,s])=>{this.Po===n&&this.Uo(i,s)},i=>{t(()=>{const s=new k(T.UNKNOWN,"Fetching auth token failed: "+i.message);return this.qo(s)})})}Uo(t,n){const i=this.Lo(this.Po);this.stream=this.Ko(t,n),this.stream.zr(()=>{i(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(s=>{i(()=>this.qo(s))}),this.stream.onMessage(s=>{i(()=>this.onMessage(s))})}xo(){this.state=5,this.So.Io(async()=>{this.state=0,this.start()})}qo(t){return M("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Lo(t){return n=>{this.js.enqueueAndForget(()=>this.Po===t?n():(M("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class W1 extends H1{constructor(t,n,i,s,r,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,s,o),this.wt=r}Ko(t,n){return this.bo.ho("Listen",t,n)}onMessage(t){this.So.reset();const n=o1(this.wt,t),i=function(s){if(!("targetChange"in s))return F.min();const r=s.targetChange;return r.targetIds&&r.targetIds.length?F.min():r.readTime?ki(r.readTime):F.min()}(t);return this.listener.Go(n,i)}Qo(t){const n={};n.database=uu(this.wt),n.addTarget=function(s,r){let o;const a=r.target;return o=la(a)?{documents:a1(s,a)}:{query:l1(s,a)},o.targetId=r.targetId,r.resumeToken.approximateByteSize()>0?o.resumeToken=i1(s,r.resumeToken):r.snapshotVersion.compareTo(F.min())>0&&(o.readTime=n1(s,r.snapshotVersion.toTimestamp())),o}(this.wt,t);const i=h1(this.wt,t);i&&(n.labels=i),this.Oo(n)}jo(t){const n={};n.database=uu(this.wt),n.removeTarget=t,this.Oo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1 extends class{}{constructor(t,n,i,s){super(),this.authCredentials=t,this.appCheckCredentials=n,this.bo=i,this.wt=s,this.Zo=!1}tu(){if(this.Zo)throw new k(T.FAILED_PRECONDITION,"The client has already been terminated.")}ro(t,n,i){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,r])=>this.bo.ro(t,n,i,s,r)).catch(s=>{throw s.name==="FirebaseError"?(s.code===T.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new k(T.UNKNOWN,s.toString())})}ao(t,n,i,s){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.bo.ao(t,n,i,r,o,s)).catch(r=>{throw r.name==="FirebaseError"?(r.code===T.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new k(T.UNKNOWN,r.toString())})}terminate(){this.Zo=!0}}class q1{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){this.eu===0&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(t){this.state==="Online"?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ru("Offline")))}set(t){this.cu(),this.eu=0,t==="Online"&&(this.su=!1),this.ru(t)}ru(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ou(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(le(n),this.su=!1):M("OnlineStateTracker",n)}cu(){this.nu!==null&&(this.nu.cancel(),this.nu=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(t,n,i,s,r){this.localStore=t,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=r,this.du.Br(o=>{i.enqueueAndForget(async()=>{Qi(this)&&(M("RemoteStore","Restarting streams for network reachability change."),await async function(a){const l=W(a);l.lu.add(4),await Xi(l),l._u.set("Unknown"),l.lu.delete(4),await Br(l)}(this))})}),this._u=new q1(i,s)}}async function Br(e){if(Qi(e))for(const t of e.fu)await t(!0)}async function Xi(e){for(const t of e.fu)await t(!1)}function kg(e,t){const n=W(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),Al(n)?Cl(n):Fn(n).Co()&&Tl(n,t))}function Og(e,t){const n=W(e),i=Fn(n);n.hu.delete(t),i.Co()&&Pg(n,t),n.hu.size===0&&(i.Co()?i.ko():Qi(n)&&n._u.set("Unknown"))}function Tl(e,t){e.wu.Nt(t.targetId),Fn(e).Qo(t)}function Pg(e,t){e.wu.Nt(t),Fn(e).jo(t)}function Cl(e){e.wu=new JC({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),te:t=>e.hu.get(t)||null}),Fn(e).start(),e._u.iu()}function Al(e){return Qi(e)&&!Fn(e).Do()&&e.hu.size>0}function Qi(e){return W(e).lu.size===0}function Rg(e){e.wu=void 0}async function Y1(e){e.hu.forEach((t,n)=>{Tl(e,t)})}async function X1(e,t){Rg(e),Al(e)?(e._u.uu(t),Cl(e)):e._u.set("Unknown")}async function Q1(e,t,n){if(e._u.set("Online"),t instanceof wg&&t.state===2&&t.cause)try{await async function(i,s){const r=s.cause;for(const o of s.targetIds)i.hu.has(o)&&(await i.remoteSyncer.rejectListen(o,r),i.hu.delete(o),i.wu.removeTarget(o))}(e,t)}catch(i){M("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),i),await pu(e,i)}else if(t instanceof Ss?e.wu.Ut(t):t instanceof xg?e.wu.zt(t):e.wu.Gt(t),!n.isEqual(F.min()))try{const i=await Dg(e.localStore);n.compareTo(i)>=0&&await function(s,r){const o=s.wu.Yt(r);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const c=s.hu.get(l);c&&s.hu.set(l,c.withResumeToken(a.resumeToken,r))}}),o.targetMismatches.forEach(a=>{const l=s.hu.get(a);if(!l)return;s.hu.set(a,l.withResumeToken(wt.EMPTY_BYTE_STRING,l.snapshotVersion)),Pg(s,a);const c=new ze(l.target,a,1,l.sequenceNumber);Tl(s,c)}),s.remoteSyncer.applyRemoteEvent(o)}(e,n)}catch(i){M("RemoteStore","Failed to raise snapshot:",i),await pu(e,i)}}async function pu(e,t,n){if(!Gi(t))throw t;e.lu.add(1),await Xi(e),e._u.set("Offline"),n||(n=()=>Dg(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{M("RemoteStore","Retrying IndexedDB access"),await n(),e.lu.delete(1),await Br(e)})}async function mu(e,t){const n=W(e);n.asyncQueue.verifyOperationInProgress(),M("RemoteStore","RemoteStore received new credentials");const i=Qi(n);n.lu.add(3),await Xi(n),i&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.lu.delete(3),await Br(n)}async function J1(e,t){const n=W(e);t?(n.lu.delete(2),await Br(n)):t||(n.lu.add(2),await Xi(n),n._u.set("Unknown"))}function Fn(e){return e.mu||(e.mu=function(t,n,i){const s=W(t);return s.tu(),new W1(n,s.bo,s.authCredentials,s.appCheckCredentials,s.wt,i)}(e.datastore,e.asyncQueue,{zr:Y1.bind(null,e),Jr:X1.bind(null,e),Go:Q1.bind(null,e)}),e.fu.push(async t=>{t?(e.mu.No(),Al(e)?Cl(e):e._u.set("Unknown")):(await e.mu.stop(),Rg(e))})),e.mu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(t,n,i,s,r){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=i,this.op=s,this.removalCallback=r,this.deferred=new Ve,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(t,n,i,s,r){const o=Date.now()+i,a=new Dl(t,n,o,s,r);return a.start(i),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(T.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Lg(e,t){if(le("AsyncQueue",`${t}: ${e}`),Gi(e))return new k(T.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(t){this.comparator=t?(n,i)=>t(n,i)||I.comparator(n.key,i.key):(n,i)=>I.comparator(n.key,i.key),this.keyedMap=Zn(),this.sortedSet=new yt(this.comparator)}static emptySet(t){return new pn(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,i)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof pn)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,r=i.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const i=new pn;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(){this.yu=new yt(I.comparator)}track(t){const n=t.doc.key,i=this.yu.get(n);i?t.type!==0&&i.type===3?this.yu=this.yu.insert(n,t):t.type===3&&i.type!==1?this.yu=this.yu.insert(n,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.yu=this.yu.insert(n,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.yu=this.yu.insert(n,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.yu=this.yu.remove(n):t.type===1&&i.type===2?this.yu=this.yu.insert(n,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.yu=this.yu.insert(n,{type:2,doc:t.doc}):N():this.yu=this.yu.insert(n,t)}pu(){const t=[];return this.yu.inorderTraversal((n,i)=>{t.push(i)}),t}}class Mn{constructor(t,n,i,s,r,o,a,l){this.query=t,this.docs=n,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l}static fromInitialDocuments(t,n,i,s){const r=[];return n.forEach(o=>{r.push({type:0,doc:o})}),new Mn(t,n,pn.emptySet(n),r,i,s,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Rr(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,i=t.docChanges;if(n.length!==i.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==i[s].type||!n[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(){this.Iu=void 0,this.listeners=[]}}class tA{constructor(){this.queries=new Nn(t=>hg(t),Rr),this.onlineState="Unknown",this.Tu=new Set}}async function eA(e,t){const n=W(e),i=t.query;let s=!1,r=n.queries.get(i);if(r||(s=!0,r=new Z1),s)try{r.Iu=await n.onListen(i)}catch(o){const a=Lg(o,`Initialization of query '${ha(t.query)}' failed`);return void t.onError(a)}n.queries.set(i,r),r.listeners.push(t),t.Eu(n.onlineState),r.Iu&&t.Au(r.Iu)&&Ml(n)}async function nA(e,t){const n=W(e),i=t.query;let s=!1;const r=n.queries.get(i);if(r){const o=r.listeners.indexOf(t);o>=0&&(r.listeners.splice(o,1),s=r.listeners.length===0)}if(s)return n.queries.delete(i),n.onUnlisten(i)}function iA(e,t){const n=W(e);let i=!1;for(const s of t){const r=s.query,o=n.queries.get(r);if(o){for(const a of o.listeners)a.Au(s)&&(i=!0);o.Iu=s}}i&&Ml(n)}function sA(e,t,n){const i=W(e),s=i.queries.get(t);if(s)for(const r of s.listeners)r.onError(n);i.queries.delete(t)}function Ml(e){e.Tu.forEach(t=>{t.next()})}class rA{constructor(t,n,i){this.query=t,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=i||{}}Au(t){if(!this.options.includeMetadataChanges){const i=[];for(const s of t.docChanges)s.type!==3&&i.push(s);t=new Mn(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}let n=!1;return this.bu?this.vu(t)&&(this.Ru.next(t),n=!0):this.Vu(t,this.onlineState)&&(this.Su(t),n=!0),this.Pu=t,n}onError(t){this.Ru.error(t)}Eu(t){this.onlineState=t;let n=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,t)&&(this.Su(this.Pu),n=!0),n}Vu(t,n){if(!t.fromCache)return!0;const i=n!=="Offline";return(!this.options.Du||!i)&&(!t.docs.isEmpty()||n==="Offline")}vu(t){if(t.docChanges.length>0)return!0;const n=this.Pu&&this.Pu.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Su(t){t=Mn.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.bu=!0,this.Ru.next(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{constructor(t){this.key=t}}class Fg{constructor(t){this.key=t}}class oA{constructor(t,n){this.query=t,this.Fu=n,this.$u=null,this.current=!1,this.Bu=U(),this.mutatedKeys=U(),this.Lu=ug(t),this.Uu=new pn(this.Lu)}get qu(){return this.Fu}Ku(t,n){const i=n?n.Gu:new yu,s=n?n.Uu:this.Uu;let r=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((h,u)=>{const d=s.get(h),f=vl(this.query,u)?u:null,g=!!d&&this.mutatedKeys.has(d.key),p=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let m=!1;d&&f?d.data.isEqual(f.data)?g!==p&&(i.track({type:3,doc:f}),m=!0):this.Qu(d,f)||(i.track({type:2,doc:f}),m=!0,(l&&this.Lu(f,l)>0||c&&this.Lu(f,c)<0)&&(a=!0)):!d&&f?(i.track({type:0,doc:f}),m=!0):d&&!f&&(i.track({type:1,doc:d}),m=!0,(l||c)&&(a=!0)),m&&(f?(o=o.add(f),r=p?r.add(h):r.delete(h)):(o=o.delete(h),r=r.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),r=r.delete(h.key),i.track({type:1,doc:h})}return{Uu:o,Gu:i,Mi:a,mutatedKeys:r}}Qu(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,i){const s=this.Uu;this.Uu=t.Uu,this.mutatedKeys=t.mutatedKeys;const r=t.Gu.pu();r.sort((c,h)=>function(u,d){const f=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return N()}};return f(u)-f(d)}(c.type,h.type)||this.Lu(c.doc,h.doc)),this.ju(i);const o=n?this.Wu():[],a=this.Bu.size===0&&this.current?1:0,l=a!==this.$u;return this.$u=a,r.length!==0||l?{snapshot:new Mn(this.query,t.Uu,s,r,t.mutatedKeys,a===0,l,!1),zu:o}:{zu:o}}Eu(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new yu,mutatedKeys:this.mutatedKeys,Mi:!1},!1)):{zu:[]}}Hu(t){return!this.Fu.has(t)&&!!this.Uu.has(t)&&!this.Uu.get(t).hasLocalMutations}ju(t){t&&(t.addedDocuments.forEach(n=>this.Fu=this.Fu.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.Fu=this.Fu.delete(n)),this.current=t.current)}Wu(){if(!this.current)return[];const t=this.Bu;this.Bu=U(),this.Uu.forEach(i=>{this.Hu(i.key)&&(this.Bu=this.Bu.add(i.key))});const n=[];return t.forEach(i=>{this.Bu.has(i)||n.push(new Fg(i))}),this.Bu.forEach(i=>{t.has(i)||n.push(new Ng(i))}),n}Ju(t){this.Fu=t.ji,this.Bu=U();const n=this.Ku(t.documents);return this.applyChanges(n,!0)}Yu(){return Mn.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,this.$u===0)}}class aA{constructor(t,n,i){this.query=t,this.targetId=n,this.view=i}}class lA{constructor(t){this.key=t,this.Xu=!1}}class cA{constructor(t,n,i,s,r,o){this.localStore=t,this.remoteStore=n,this.eventManager=i,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new Nn(a=>hg(a),Rr),this.ec=new Map,this.nc=new Set,this.sc=new yt(I.comparator),this.ic=new Map,this.rc=new wl,this.oc={},this.uc=new Map,this.cc=Dn.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return this.ac===!0}}async function hA(e,t){const n=yA(e);let i,s;const r=n.tc.get(t);if(r)i=r.targetId,n.sharedClientState.addLocalQueryTarget(i),s=r.view.Yu();else{const o=await F1(n.localStore,ce(t));n.isPrimaryClient&&kg(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);i=o.targetId,s=await uA(n,t,i,a==="current")}return s}async function uA(e,t,n,i){e.hc=(h,u,d)=>async function(f,g,p,m){let y=g.view.Ku(p);y.Mi&&(y=await du(f.localStore,g.query,!1).then(({documents:x})=>g.view.Ku(x,y)));const b=m&&m.targetChanges.get(g.targetId),_=g.view.applyChanges(y,f.isPrimaryClient,b);return vu(f,g.targetId,_.zu),_.snapshot}(e,h,u,d);const s=await du(e.localStore,t,!0),r=new oA(t,s.ji),o=r.Ku(s.documents),a=Yi.createSynthesizedTargetChangeForCurrentChange(n,i&&e.onlineState!=="Offline"),l=r.applyChanges(o,e.isPrimaryClient,a);vu(e,n,l.zu);const c=new aA(t,n,r);return e.tc.set(t,c),e.ec.has(n)?e.ec.get(n).push(t):e.ec.set(n,[t]),l.snapshot}async function dA(e,t){const n=W(e),i=n.tc.get(t),s=n.ec.get(i.targetId);if(s.length>1)return n.ec.set(i.targetId,s.filter(r=>!Rr(r,t))),void n.tc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await ga(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),Og(n.remoteStore,i.targetId),pa(n,i.targetId)}).catch(gl)):(pa(n,i.targetId),await ga(n.localStore,i.targetId,!0))}async function Bg(e,t){const n=W(e);try{const i=await L1(n.localStore,t);t.targetChanges.forEach((s,r)=>{const o=n.ic.get(r);o&&(ht(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Xu=!0:s.modifiedDocuments.size>0?ht(o.Xu):s.removedDocuments.size>0&&(ht(o.Xu),o.Xu=!1))}),await $g(n,i,t)}catch(i){await gl(i)}}function bu(e,t,n){const i=W(e);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const s=[];i.tc.forEach((r,o)=>{const a=o.view.Eu(t);a.snapshot&&s.push(a.snapshot)}),function(r,o){const a=W(r);a.onlineState=o;let l=!1;a.queries.forEach((c,h)=>{for(const u of h.listeners)u.Eu(o)&&(l=!0)}),l&&Ml(a)}(i.eventManager,t),s.length&&i.Zu.Go(s),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function fA(e,t,n){const i=W(e);i.sharedClientState.updateQueryState(t,"rejected",n);const s=i.ic.get(t),r=s&&s.key;if(r){let o=new yt(I.comparator);o=o.insert(r,vt.newNoDocument(r,F.min()));const a=U().add(r),l=new Fr(F.min(),new Map,new ft(G),o,a);await Bg(i,l),i.sc=i.sc.remove(r),i.ic.delete(t),Il(i)}else await ga(i.localStore,t,!1).then(()=>pa(i,t,n)).catch(gl)}function pa(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.ec.get(t))e.tc.delete(i),n&&e.Zu.lc(i,n);e.ec.delete(t),e.isPrimaryClient&&e.rc.us(t).forEach(i=>{e.rc.containsKey(i)||Vg(e,i)})}function Vg(e,t){e.nc.delete(t.path.canonicalString());const n=e.sc.get(t);n!==null&&(Og(e.remoteStore,n),e.sc=e.sc.remove(t),e.ic.delete(n),Il(e))}function vu(e,t,n){for(const i of n)i instanceof Ng?(e.rc.addReference(i.key,t),gA(e,i)):i instanceof Fg?(M("SyncEngine","Document no longer in limbo: "+i.key),e.rc.removeReference(i.key,t),e.rc.containsKey(i.key)||Vg(e,i.key)):N()}function gA(e,t){const n=t.key,i=n.path.canonicalString();e.sc.get(n)||e.nc.has(i)||(M("SyncEngine","New document in limbo: "+n),e.nc.add(i),Il(e))}function Il(e){for(;e.nc.size>0&&e.sc.size<e.maxConcurrentLimboResolutions;){const t=e.nc.values().next().value;e.nc.delete(t);const n=new I(nt.fromString(t)),i=e.cc.next();e.ic.set(i,new lA(n)),e.sc=e.sc.insert(n,i),kg(e.remoteStore,new ze(ce(cg(n.path)),i,2,pl.ot))}}async function $g(e,t,n){const i=W(e),s=[],r=[],o=[];i.tc.isEmpty()||(i.tc.forEach((a,l)=>{o.push(i.hc(l,t,n).then(c=>{if(c){i.isPrimaryClient&&i.sharedClientState.updateQueryState(l.targetId,c.fromCache?"not-current":"current"),s.push(c);const h=El.Vi(l.targetId,c);r.push(h)}}))}),await Promise.all(o),i.Zu.Go(s),await async function(a,l){const c=W(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>w.forEach(l,u=>w.forEach(u.Pi,d=>c.persistence.referenceDelegate.addReference(h,u.targetId,d)).next(()=>w.forEach(u.vi,d=>c.persistence.referenceDelegate.removeReference(h,u.targetId,d)))))}catch(h){if(!Gi(h))throw h;M("LocalStore","Failed to update sequence numbers: "+h)}for(const h of l){const u=h.targetId;if(!h.fromCache){const d=c.$i.get(u),f=d.snapshotVersion,g=d.withLastLimboFreeSnapshotVersion(f);c.$i=c.$i.insert(u,g)}}}(i.localStore,r))}async function pA(e,t){const n=W(e);if(!n.currentUser.isEqual(t)){M("SyncEngine","User change. New user:",t.toKey());const i=await Ag(n.localStore,t);n.currentUser=t,function(s,r){s.uc.forEach(o=>{o.forEach(a=>{a.reject(new k(T.CANCELLED,r))})}),s.uc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await $g(n,i.Ki)}}function mA(e,t){const n=W(e),i=n.ic.get(t);if(i&&i.Xu)return U().add(i.key);{let s=U();const r=n.ec.get(t);if(!r)return s;for(const o of r){const a=n.tc.get(o);s=s.unionWith(a.view.qu)}return s}}function yA(e){const t=W(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Bg.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=mA.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=fA.bind(null,t),t.Zu.Go=iA.bind(null,t.eventManager),t.Zu.lc=sA.bind(null,t.eventManager),t}class bA{constructor(){this.synchronizeTabs=!1}async initialize(t){this.wt=Mg(t.databaseInfo.databaseId),this.sharedClientState=this.dc(t),this.persistence=this._c(t),await this.persistence.start(),this.localStore=this.wc(t),this.gcScheduler=this.mc(t,this.localStore),this.indexBackfillerScheduler=this.gc(t,this.localStore)}mc(t,n){return null}gc(t,n){return null}wc(t){return R1(this.persistence,new O1,t.initialUser,this.wt)}_c(t){return new I1(Sl.Os,this.wt)}dc(t){return new V1}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class vA{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>bu(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=pA.bind(null,this.syncEngine),await J1(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new tA}createDatastore(t){const n=Mg(t.databaseInfo.databaseId),i=(s=t.databaseInfo,new U1(s));var s;return function(r,o,a,l){return new K1(r,o,a,l)}(t.authCredentials,t.appCheckCredentials,i,n)}createRemoteStore(t){return n=this.localStore,i=this.datastore,s=t.asyncQueue,r=a=>bu(this.syncEngine,a,0),o=gu.V()?new gu:new $1,new G1(n,i,s,r,o);var n,i,s,r,o}createSyncEngine(t,n){return function(i,s,r,o,a,l,c){const h=new cA(i,s,r,o,a,l);return c&&(h.ac=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}terminate(){return async function(t){const n=W(t);M("RemoteStore","RemoteStore shutting down."),n.lu.add(5),await Xi(n),n.du.shutdown(),n._u.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ic(this.observer.next,t)}error(t){this.observer.error?this.Ic(this.observer.error,t):le("Uncaught Error in snapshot listener:",t)}Tc(){this.muted=!0}Ic(t,n){this.muted||setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(t,n,i,s){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=s,this.user=Ot.UNAUTHENTICATED,this.clientId=dC.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,async r=>{M("FirestoreClient","Received user=",r.uid),await this.authCredentialListener(r),this.user=r}),this.appCheckCredentials.start(i,r=>(M("FirestoreClient","Received new app check token=",r),this.appCheckCredentialListener(r,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new k(T.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ve;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=Lg(n,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function wA(e,t){e.asyncQueue.verifyOperationInProgress(),M("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(async s=>{i.isEqual(s)||(await Ag(t.localStore,s),i=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e.offlineComponents=t}async function SA(e,t){e.asyncQueue.verifyOperationInProgress();const n=await EA(e);M("FirestoreClient","Initializing OnlineComponentProvider");const i=await e.getConfiguration();await t.initialize(n,i),e.setCredentialChangeListener(s=>mu(t.remoteStore,s)),e.setAppCheckTokenChangeListener((s,r)=>mu(t.remoteStore,r)),e.onlineComponents=t}async function EA(e){return e.offlineComponents||(M("FirestoreClient","Using default OfflineComponentProvider"),await wA(e,new bA)),e.offlineComponents}async function TA(e){return e.onlineComponents||(M("FirestoreClient","Using default OnlineComponentProvider"),await SA(e,new vA)),e.onlineComponents}async function CA(e){const t=await TA(e),n=t.eventManager;return n.onListen=hA.bind(null,t.syncEngine),n.onUnlisten=dA.bind(null,t.syncEngine),n}function AA(e,t,n={}){const i=new Ve;return e.asyncQueue.enqueueAndForget(async()=>function(s,r,o,a,l){const c=new _A({next:u=>{r.enqueueAndForget(()=>nA(s,h)),u.fromCache&&a.source==="server"?l.reject(new k(T.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(u)},error:u=>l.reject(u)}),h=new rA(o,c,{includeMetadataChanges:!0,Du:!0});return eA(s,h)}(await CA(e),e.asyncQueue,t,n,i)),i.promise}const _u=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DA(e,t,n){if(!n)throw new k(T.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function MA(e,t,n,i){if(t===!0&&i===!0)throw new k(T.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function xu(e){if(I.isDocumentKey(e))throw new k(T.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function IA(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":N()}function wu(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new k(T.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=IA(e);throw new k(T.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(t){var n;if(t.host===void 0){if(t.ssl!==void 0)throw new k(T.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(n=t.ssl)===null||n===void 0||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new k(T.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,MA("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg{constructor(t,n,i){this._authCredentials=n,this._appCheckCredentials=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Su({}),this._settingsFrozen=!1,t instanceof Cn?this._databaseId=t:(this._app=t,this._databaseId=function(s){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new k(T.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Cn(s.options.projectId)}(t))}get app(){if(!this._app)throw new k(T.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new k(T.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Su(t),t.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new rC;switch(n.type){case"gapi":const i=n.client;return ht(!(typeof i!="object"||i===null||!i.auth||!i.auth.getAuthHeaderValueForFirstParty)),new lC(i,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new k(T.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=_u.get(t);n&&(M("ComponentProvider","Removing Datastore"),_u.delete(t),n.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(t,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Bn(this.firestore,t,this._key)}}class Vr{constructor(t,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new Vr(this.firestore,t,this._query)}}class mn extends Vr{constructor(t,n,i){super(t,n,cg(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Bn(this.firestore,null,new I(t))}withConverter(t){return new mn(this.firestore,t,this._path)}}function kA(e,t,...n){if(e=zS(e),DA("collection","path",t),e instanceof jg){const i=nt.fromString(t,...n);return xu(i),new mn(e,null,i)}{if(!(e instanceof Bn||e instanceof mn))throw new k(T.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(nt.fromString(t,...n));return xu(i),new mn(e.firestore,null,i)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OA{constructor(){this.Mc=Promise.resolve(),this.Oc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new Ig(this,"async_queue_retry"),this.Kc=()=>{const n=So();n&&M("AsyncQueue","Visibility state changed to "+n.visibilityState),this.So.Eo()};const t=So();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Gc(),this.Qc(t)}enterRestrictedMode(t){if(!this.Fc){this.Fc=!0,this.Uc=t||!1;const n=So();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Kc)}}enqueue(t){if(this.Gc(),this.Fc)return new Promise(()=>{});const n=new Ve;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Oc.push(t),this.jc()))}async jc(){if(this.Oc.length!==0){try{await this.Oc[0](),this.Oc.shift(),this.So.reset()}catch(t){if(!Gi(t))throw t;M("AsyncQueue","Operation failed with retryable error: "+t)}this.Oc.length>0&&this.So.Io(()=>this.jc())}}Qc(t){const n=this.Mc.then(()=>(this.Lc=!0,t().catch(i=>{this.Bc=i,this.Lc=!1;const s=function(r){let o=r.message||"";return r.stack&&(o=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),o}(i);throw le("INTERNAL UNHANDLED ERROR: ",s),i}).then(i=>(this.Lc=!1,i))));return this.Mc=n,n}enqueueAfterDelay(t,n,i){this.Gc(),this.qc.indexOf(t)>-1&&(n=0);const s=Dl.createAndSchedule(this,t,n,i,r=>this.Wc(r));return this.$c.push(s),s}Gc(){this.Bc&&N()}verifyOperationInProgress(){}async zc(){let t;do t=this.Mc,await t;while(t!==this.Mc)}Hc(t){for(const n of this.$c)if(n.timerId===t)return!0;return!1}Jc(t){return this.zc().then(()=>{this.$c.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.$c)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.zc()})}Yc(t){this.qc.push(t)}Wc(t){const n=this.$c.indexOf(t);this.$c.splice(n,1)}}class zg extends jg{constructor(t,n,i){super(t,n,i),this.type="firestore",this._queue=new OA,this._persistenceKey="name"in t?t.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Ug(this),this._firestoreClient.terminate()}}function PA(e=zE()){return FE(e,"firestore").getImmediate()}function RA(e){return e._firestoreClient||Ug(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Ug(e){var t;const n=e._freezeSettings(),i=function(s,r,o,a){return new xC(s,r,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new xA(e._authCredentials,e._appCheckCredentials,e._queue,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new k(T.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Rt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Qs(wt.fromBase64String(t))}catch(n){throw new k(T.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new Qs(wt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new k(T.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new k(T.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return G(this._lat,t._lat)||G(this._long,t._long)}}const NA=new RegExp("[~\\*/\\[\\]]");function FA(e,t,n){if(t.search(NA)>=0)throw Eu(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Hg(...t.split("."))._internalPath}catch{throw Eu(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Eu(e,t,n,i,s){const r=i&&!i.isEmpty(),o=s!==void 0;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(r||o)&&(l+=" (found",r&&(l+=` in field ${i}`),o&&(l+=` in document ${s}`),l+=")"),new k(T.INVALID_ARGUMENT,a+e+l)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(t,n,i,s,r){this._firestore=t,this._userDataWriter=n,this._key=i,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Bn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new BA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(Kg("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class BA extends Wg{data(){return super.data()}}function Kg(e,t){return typeof t=="string"?FA(e,t):t instanceof Hg?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class VA extends Wg{constructor(t,n,i,s,r,o){super(t,n,i,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new Es(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const i=this._document.data.field(Kg("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}}class Es extends VA{data(t={}){return super.data(t)}}class $A{constructor(t,n,i,s){this._firestore=t,this._userDataWriter=n,this._snapshot=s,this.metadata=new bs(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(i=>{t.call(n,new Es(this._firestore,this._userDataWriter,i.key,i,new bs(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new k(T.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let r=0;return i._snapshot.docChanges.map(o=>({type:"added",doc:new Es(i._firestore,i._userDataWriter,o.doc.key,o.doc,new bs(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:r++}))}{let r=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const a=new Es(i._firestore,i._userDataWriter,o.doc.key,o.doc,new bs(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,c=-1;return o.type!==0&&(l=r.indexOf(o.doc.key),r=r.delete(o.doc.key)),o.type!==1&&(r=r.add(o.doc),c=r.indexOf(o.doc.key)),{type:jA(o.type),doc:a,oldIndex:l,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function jA(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return N()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zA(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new k(T.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{convertValue(t,n="none"){switch(Je(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ct(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(Tn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 10:return this.convertObject(t.mapValue,n);default:throw N()}}convertObject(t,n){const i={};return kr(t.fields,(s,r)=>{i[s]=this.convertValue(r,n)}),i}convertGeoPoint(t){return new LA(ct(t.latitude),ct(t.longitude))}convertArray(t,n){return(t.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(t,n){switch(n){case"previous":const i=ag(t);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Di(t));default:return null}}convertTimestamp(t){const n=_e(t);return new Nt(n.seconds,n.nanos)}convertDocumentKey(t,n){const i=nt.fromString(t);ht(Cg(i));const s=new Cn(i.get(1),i.get(3)),r=new I(i.popFirst(5));return s.isEqual(n)||le(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),r}}class HA extends UA{constructor(t){super(),this.firestore=t}convertBytes(t){return new Qs(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Bn(this.firestore,null,n)}}function WA(e){e=wu(e,Vr);const t=wu(e.firestore,zg),n=RA(t),i=new HA(t);return zA(e._query),AA(n,e._query).then(s=>new $A(t,i,e,s))}(function(e,t=!0){(function(n){Ln=n})($E),Bs(new _i("firestore",(n,{options:i})=>{const s=n.getProvider("app").getImmediate(),r=new zg(s,new oC(n.getProvider("auth-internal")),new hC(n.getProvider("app-check-internal")));return i=Object.assign({useFetchStreams:t},i),r._setSettings(i),r},"PUBLIC")),fn(Kh,"3.4.14",e),fn(Kh,"3.4.14","esm2017")})();var KA="firebase",qA="9.9.3";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fn(KA,qA,"app");const GA={apiKey:{}.VITE_FB_APIKEY,authDomain:{}.VITE_FB_AUTHDOMAIN,databaseURL:"/",projectId:{}.VITE_FB_PROJECTID,storageBucket:{}.VITE_FB_STORAGEBUCKET,messagingSenderId:{}.VITE_FB_MESSAGINGSENDERID,appId:{}.VITE_FB_APPID,measurementId:{}.VITE_FB_MEASUREMENT_ID},YA=jE(GA),XA=PA(YA);lr.register(...zv);const QA=Tu({name:"App",components:{BarChart:TS},setup(){const e=ee(),t=ee();ee(!0);const n=ee(null),i=ee(!1),s=ee(),r=async()=>{console.log("getUsers"),i.value=!0;try{const h=kA(XA,"statistic"),d=(await WA(h)).docs.map(f=>f.data());e.value=d.map(f=>f.value),t.value=d.map(f=>f.name),console.log("asdf - ",[e.value,t.value])}catch(h){s.value=h}finally{i.value=!1}};Cu(()=>{r()});const o=Eo(()=>({scales:{y:{beginAtZero:!0}},plugins:{}})),a=Eo(()=>({labels:t.value,datasets:[{data:e.value,backgroundColor:["#77CEFF","#0079AF","#123E6B","#97B0C4","#A5C8ED"]}]})),{barChartProps:l,barChartRef:c}=CS({chartData:a,options:o});return ee(20),{testData:a,options:o,barChartProps:l,barChartRef:c,imgData:n,isLoading:i}}}),JA=Zg("h3",null,"My tests",-1),ZA={key:0};function tD(e,t,n,i,s,r){const o=tp("BarChart");return Hr(),Rl("div",null,[JA,e.isLoading?(Hr(),Rl("div",ZA,"Loading...")):(Hr(),Xg(o,Qg(Jg({key:1},e.barChartProps)),null,16))])}var nD=Yg(QA,[["render",tD]]);export{nD as default};
